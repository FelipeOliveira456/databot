[
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.dataPedido) AS nomeDiaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.dataPedido),      WEEKDAY(pv.dataPedido) ORDER BY      WEEKDAY(pv.dataPedido);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      Vendedor.nomeVendedor,      COUNT(PedidoVenda.idPedido) AS quantidade_vendas FROM      PedidoVenda JOIN      Vendedor ON PedidoVenda.idVendedor = Vendedor.idVendedor GROUP BY      Vendedor.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.numParcelas,     COUNT(*) AS numeroVendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.numParcelas ORDER BY ano, mes, numParcelas;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.idCategoria,         YEAR(pv.dataPedido) AS ano,         SUM(ip.qtdePedida * ip.precoVendido) AS totalVendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     GROUP BY p.idCategoria, YEAR(pv.dataPedido) ), VariacaoAnual AS (     SELECT          va1.idCategoria,         va1.ano AS anoAtual,         va1.totalVendas AS vendasAtual,         va2.totalVendas AS vendasAnterior,         CASE              WHEN va2.totalVendas IS NOT NULL AND va2.totalVendas <> 0              THEN ((va1.totalVendas - va2.totalVendas) / va2.totalVendas) * 100             ELSE NULL          END AS variacaoPercentual     FROM VendasAno va1     LEFT JOIN VendasAno va2          ON va1.idCategoria = va2.idCategoria          AND va1.ano = va2.ano + 1 ) SELECT      c.nomeCategoria,     va.anoAtual,     va.vendasAtual,     va.vendasAnterior,     va.variacaoPercentual FROM VariacaoAnual va JOIN CategoriaProduto c ON va.idCategoria = c.idCategoria ORDER BY c.nomeCategoria, va.anoAtual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         SUM(CASE WHEN ano = 2021 THEN qtdePedidos ELSE 0 END) AS pedidos_2021,         SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END) AS pedidos_2020,         CASE              WHEN SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END) = 0 THEN NULL             ELSE                  ROUND(                     (SUM(CASE WHEN ano = 2021 THEN qtdePedidos ELSE 0 END) -                       SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END)) * 100.0 /                      SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END), 2                 )         END AS variacao_percentual     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      pedidos_2021 > 0 AND pedidos_2020 > 0 ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING AVG(ip.precoVendido * ip.qtdePedida) > (     SELECT AVG(ip2.precoVendido * ip2.qtdePedida)     FROM ItensPedidoVenda ip2 );"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.dataPedido) AS nomeDiaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.dataPedido),      WEEKDAY(pv.dataPedido) ORDER BY      WEEKDAY(pv.dataPedido);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      Vendedor.nomeVendedor,      COUNT(PedidoVenda.idPedido) AS quantidade_vendas FROM      PedidoVenda JOIN      Vendedor ON PedidoVenda.idVendedor = Vendedor.idVendedor GROUP BY      Vendedor.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.numParcelas,     COUNT(*) AS numeroVendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.numParcelas ORDER BY ano, mes, numParcelas;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.idCategoria,         YEAR(pv.dataPedido) AS ano,         SUM(ip.qtdePedida * ip.precoVendido) AS totalVendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     GROUP BY p.idCategoria, YEAR(pv.dataPedido) ), VariacaoAnual AS (     SELECT          va1.idCategoria,         va1.ano AS anoAtual,         va1.totalVendas AS vendasAtual,         va2.totalVendas AS vendasAnterior,         CASE              WHEN va2.totalVendas IS NOT NULL AND va2.totalVendas <> 0              THEN ((va1.totalVendas - va2.totalVendas) / va2.totalVendas) * 100             ELSE NULL          END AS variacaoPercentual     FROM VendasAno va1     LEFT JOIN VendasAno va2          ON va1.idCategoria = va2.idCategoria          AND va1.ano = va2.ano + 1 ) SELECT      c.nomeCategoria,     va.anoAtual,     va.vendasAtual,     va.vendasAnterior,     va.variacaoPercentual FROM VariacaoAnual va JOIN CategoriaProduto c ON va.idCategoria = c.idCategoria ORDER BY c.nomeCategoria, va.anoAtual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         SUM(CASE WHEN ano = 2021 THEN qtdePedidos ELSE 0 END) AS pedidos_2021,         SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END) AS pedidos_2020,         CASE              WHEN SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END) = 0 THEN NULL             ELSE                  ROUND(                     (SUM(CASE WHEN ano = 2021 THEN qtdePedidos ELSE 0 END) -                       SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END)) * 100.0 /                      SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END), 2                 )         END AS variacao_percentual     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      pedidos_2021 > 0 AND pedidos_2020 > 0 ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING AVG(ip.precoVendido * ip.qtdePedida) > (     SELECT AVG(ip2.precoVendido * ip2.qtdePedida)     FROM ItensPedidoVenda ip2 );"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.dataPedido) AS nomeDiaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.dataPedido),      WEEKDAY(pv.dataPedido) ORDER BY      WEEKDAY(pv.dataPedido);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      Vendedor.nomeVendedor,      COUNT(PedidoVenda.idPedido) AS quantidade_vendas FROM      PedidoVenda JOIN      Vendedor ON PedidoVenda.idVendedor = Vendedor.idVendedor GROUP BY      Vendedor.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.numParcelas,     COUNT(*) AS numeroVendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.numParcelas ORDER BY ano, mes, numParcelas;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.idCategoria,         YEAR(pv.dataPedido) AS ano,         SUM(ip.qtdePedida * ip.precoVendido) AS totalVendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     GROUP BY p.idCategoria, YEAR(pv.dataPedido) ), VariacaoAnual AS (     SELECT          va1.idCategoria,         va1.ano AS anoAtual,         va1.totalVendas AS vendasAtual,         va2.totalVendas AS vendasAnterior,         CASE              WHEN va2.totalVendas IS NOT NULL AND va2.totalVendas <> 0              THEN ((va1.totalVendas - va2.totalVendas) / va2.totalVendas) * 100             ELSE NULL          END AS variacaoPercentual     FROM VendasAno va1     LEFT JOIN VendasAno va2          ON va1.idCategoria = va2.idCategoria          AND va1.ano = va2.ano + 1 ) SELECT      c.nomeCategoria,     va.anoAtual,     va.vendasAtual,     va.vendasAnterior,     va.variacaoPercentual FROM VariacaoAnual va JOIN CategoriaProduto c ON va.idCategoria = c.idCategoria ORDER BY c.nomeCategoria, va.anoAtual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         SUM(CASE WHEN ano = 2021 THEN qtdePedidos ELSE 0 END) AS pedidos_2021,         SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END) AS pedidos_2020,         CASE              WHEN SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END) = 0 THEN NULL             ELSE                  ROUND(                     (SUM(CASE WHEN ano = 2021 THEN qtdePedidos ELSE 0 END) -                       SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END)) * 100.0 /                      SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END), 2                 )         END AS variacao_percentual     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      pedidos_2021 > 0 AND pedidos_2020 > 0 ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING AVG(ip.precoVendido * ip.qtdePedida) > (     SELECT AVG(ip2.precoVendido * ip2.qtdePedida)     FROM ItensPedidoVenda ip2 );"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.dataPedido) AS nomeDiaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.dataPedido),      WEEKDAY(pv.dataPedido) ORDER BY      WEEKDAY(pv.dataPedido);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      Vendedor.nomeVendedor,      COUNT(PedidoVenda.idPedido) AS quantidade_vendas FROM      PedidoVenda JOIN      Vendedor ON PedidoVenda.idVendedor = Vendedor.idVendedor GROUP BY      Vendedor.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.numParcelas,     COUNT(*) AS numeroVendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.numParcelas ORDER BY ano, mes, numParcelas;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.idCategoria,         YEAR(pv.dataPedido) AS ano,         SUM(ip.qtdePedida * ip.precoVendido) AS totalVendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     GROUP BY p.idCategoria, YEAR(pv.dataPedido) ), VariacaoAnual AS (     SELECT          va1.idCategoria,         va1.ano AS anoAtual,         va1.totalVendas AS vendasAtual,         va2.totalVendas AS vendasAnterior,         CASE              WHEN va2.totalVendas IS NOT NULL AND va2.totalVendas <> 0              THEN ((va1.totalVendas - va2.totalVendas) / va2.totalVendas) * 100             ELSE NULL          END AS variacaoPercentual     FROM VendasAno va1     LEFT JOIN VendasAno va2          ON va1.idCategoria = va2.idCategoria          AND va1.ano = va2.ano + 1 ) SELECT      c.nomeCategoria,     va.anoAtual,     va.vendasAtual,     va.vendasAnterior,     va.variacaoPercentual FROM VariacaoAnual va JOIN CategoriaProduto c ON va.idCategoria = c.idCategoria ORDER BY c.nomeCategoria, va.anoAtual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         SUM(CASE WHEN ano = 2021 THEN qtdePedidos ELSE 0 END) AS pedidos_2021,         SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END) AS pedidos_2020,         CASE              WHEN SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END) = 0 THEN NULL             ELSE                  ROUND(                     (SUM(CASE WHEN ano = 2021 THEN qtdePedidos ELSE 0 END) -                       SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END)) * 100.0 /                      SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END), 2                 )         END AS variacao_percentual     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      pedidos_2021 > 0 AND pedidos_2020 > 0 ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING AVG(ip.precoVendido * ip.qtdePedida) > (     SELECT AVG(ip2.precoVendido * ip2.qtdePedida)     FROM ItensPedidoVenda ip2 );"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.dataPedido) AS nomeDiaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.dataPedido),      WEEKDAY(pv.dataPedido) ORDER BY      WEEKDAY(pv.dataPedido);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      Vendedor.nomeVendedor,      COUNT(PedidoVenda.idPedido) AS quantidade_vendas FROM      PedidoVenda JOIN      Vendedor ON PedidoVenda.idVendedor = Vendedor.idVendedor GROUP BY      Vendedor.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.numParcelas,     COUNT(*) AS numeroVendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.numParcelas ORDER BY ano, mes, numParcelas;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.idCategoria,         YEAR(pv.dataPedido) AS ano,         SUM(ip.qtdePedida * ip.precoVendido) AS totalVendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     GROUP BY p.idCategoria, YEAR(pv.dataPedido) ), VariacaoAnual AS (     SELECT          va1.idCategoria,         va1.ano AS anoAtual,         va1.totalVendas AS vendasAtual,         va2.totalVendas AS vendasAnterior,         CASE              WHEN va2.totalVendas IS NOT NULL AND va2.totalVendas <> 0              THEN ((va1.totalVendas - va2.totalVendas) / va2.totalVendas) * 100             ELSE NULL          END AS variacaoPercentual     FROM VendasAno va1     LEFT JOIN VendasAno va2          ON va1.idCategoria = va2.idCategoria          AND va1.ano = va2.ano + 1 ) SELECT      c.nomeCategoria,     va.anoAtual,     va.vendasAtual,     va.vendasAnterior,     va.variacaoPercentual FROM VariacaoAnual va JOIN CategoriaProduto c ON va.idCategoria = c.idCategoria ORDER BY c.nomeCategoria, va.anoAtual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         SUM(CASE WHEN ano = 2021 THEN qtdePedidos ELSE 0 END) AS pedidos_2021,         SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END) AS pedidos_2020,         CASE              WHEN SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END) = 0 THEN NULL             ELSE                  ROUND(                     (SUM(CASE WHEN ano = 2021 THEN qtdePedidos ELSE 0 END) -                       SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END)) * 100.0 /                      SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END), 2                 )         END AS variacao_percentual     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      pedidos_2021 > 0 AND pedidos_2020 > 0 ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING AVG(ip.precoVendido * ip.qtdePedida) > (     SELECT AVG(ip2.precoVendido * ip2.qtdePedida)     FROM ItensPedidoVenda ip2 );"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.dataPedido) AS nomeDiaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.dataPedido),      WEEKDAY(pv.dataPedido) ORDER BY      WEEKDAY(pv.dataPedido);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      Vendedor.nomeVendedor,      COUNT(PedidoVenda.idPedido) AS quantidade_vendas FROM      PedidoVenda JOIN      Vendedor ON PedidoVenda.idVendedor = Vendedor.idVendedor GROUP BY      Vendedor.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.numParcelas,     COUNT(*) AS numeroVendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.numParcelas ORDER BY ano, mes, numParcelas;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.idCategoria,         YEAR(pv.dataPedido) AS ano,         SUM(ip.qtdePedida * ip.precoVendido) AS totalVendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     GROUP BY p.idCategoria, YEAR(pv.dataPedido) ), VariacaoAnual AS (     SELECT          va1.idCategoria,         va1.ano AS anoAtual,         va1.totalVendas AS vendasAtual,         va2.totalVendas AS vendasAnterior,         CASE              WHEN va2.totalVendas IS NOT NULL AND va2.totalVendas <> 0              THEN ((va1.totalVendas - va2.totalVendas) / va2.totalVendas) * 100             ELSE NULL          END AS variacaoPercentual     FROM VendasAno va1     LEFT JOIN VendasAno va2          ON va1.idCategoria = va2.idCategoria          AND va1.ano = va2.ano + 1 ) SELECT      c.nomeCategoria,     va.anoAtual,     va.vendasAtual,     va.vendasAnterior,     va.variacaoPercentual FROM VariacaoAnual va JOIN CategoriaProduto c ON va.idCategoria = c.idCategoria ORDER BY c.nomeCategoria, va.anoAtual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         SUM(CASE WHEN ano = 2021 THEN qtdePedidos ELSE 0 END) AS pedidos_2021,         SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END) AS pedidos_2020,         CASE              WHEN SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END) = 0 THEN NULL             ELSE                  ROUND(                     (SUM(CASE WHEN ano = 2021 THEN qtdePedidos ELSE 0 END) -                       SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END)) * 100.0 /                      SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END), 2                 )         END AS variacao_percentual     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      pedidos_2021 > 0 AND pedidos_2020 > 0 ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING AVG(ip.precoVendido * ip.qtdePedida) > (     SELECT AVG(ip2.precoVendido * ip2.qtdePedida)     FROM ItensPedidoVenda ip2 );"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.dataPedido) AS nomeDiaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.dataPedido),      WEEKDAY(pv.dataPedido) ORDER BY      WEEKDAY(pv.dataPedido);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      Vendedor.nomeVendedor,      COUNT(PedidoVenda.idPedido) AS quantidade_vendas FROM      PedidoVenda JOIN      Vendedor ON PedidoVenda.idVendedor = Vendedor.idVendedor GROUP BY      Vendedor.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.numParcelas,     COUNT(*) AS numeroVendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.numParcelas ORDER BY ano, mes, numParcelas;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.idCategoria,         YEAR(pv.dataPedido) AS ano,         SUM(ip.qtdePedida * ip.precoVendido) AS totalVendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     GROUP BY p.idCategoria, YEAR(pv.dataPedido) ), VariacaoAnual AS (     SELECT          va1.idCategoria,         va1.ano AS anoAtual,         va1.totalVendas AS vendasAtual,         va2.totalVendas AS vendasAnterior,         CASE              WHEN va2.totalVendas IS NOT NULL AND va2.totalVendas <> 0              THEN ((va1.totalVendas - va2.totalVendas) / va2.totalVendas) * 100             ELSE NULL          END AS variacaoPercentual     FROM VendasAno va1     LEFT JOIN VendasAno va2          ON va1.idCategoria = va2.idCategoria          AND va1.ano = va2.ano + 1 ) SELECT      c.nomeCategoria,     va.anoAtual,     va.vendasAtual,     va.vendasAnterior,     va.variacaoPercentual FROM VariacaoAnual va JOIN CategoriaProduto c ON va.idCategoria = c.idCategoria ORDER BY c.nomeCategoria, va.anoAtual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         SUM(CASE WHEN ano = 2021 THEN qtdePedidos ELSE 0 END) AS pedidos_2021,         SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END) AS pedidos_2020,         CASE              WHEN SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END) = 0 THEN NULL             ELSE                  ROUND(                     (SUM(CASE WHEN ano = 2021 THEN qtdePedidos ELSE 0 END) -                       SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END)) * 100.0 /                      SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END), 2                 )         END AS variacao_percentual     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      pedidos_2021 > 0 AND pedidos_2020 > 0 ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING AVG(ip.precoVendido * ip.qtdePedida) > (     SELECT AVG(ip2.precoVendido * ip2.qtdePedida)     FROM ItensPedidoVenda ip2 );"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.dataPedido) AS nomeDiaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.dataPedido),      WEEKDAY(pv.dataPedido) ORDER BY      WEEKDAY(pv.dataPedido);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      Vendedor.nomeVendedor,      COUNT(PedidoVenda.idPedido) AS quantidade_vendas FROM      PedidoVenda JOIN      Vendedor ON PedidoVenda.idVendedor = Vendedor.idVendedor GROUP BY      Vendedor.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.numParcelas,     COUNT(*) AS numeroVendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.numParcelas ORDER BY ano, mes, numParcelas;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.idCategoria,         YEAR(pv.dataPedido) AS ano,         SUM(ip.qtdePedida * ip.precoVendido) AS totalVendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     GROUP BY p.idCategoria, YEAR(pv.dataPedido) ), VariacaoAnual AS (     SELECT          va1.idCategoria,         va1.ano AS anoAtual,         va1.totalVendas AS vendasAtual,         va2.totalVendas AS vendasAnterior,         CASE              WHEN va2.totalVendas IS NOT NULL AND va2.totalVendas <> 0              THEN ((va1.totalVendas - va2.totalVendas) / va2.totalVendas) * 100             ELSE NULL          END AS variacaoPercentual     FROM VendasAno va1     LEFT JOIN VendasAno va2          ON va1.idCategoria = va2.idCategoria          AND va1.ano = va2.ano + 1 ) SELECT      c.nomeCategoria,     va.anoAtual,     va.vendasAtual,     va.vendasAnterior,     va.variacaoPercentual FROM VariacaoAnual va JOIN CategoriaProduto c ON va.idCategoria = c.idCategoria ORDER BY c.nomeCategoria, va.anoAtual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         SUM(CASE WHEN ano = 2021 THEN qtdePedidos ELSE 0 END) AS pedidos_2021,         SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END) AS pedidos_2020,         CASE              WHEN SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END) = 0 THEN NULL             ELSE                  ROUND(                     (SUM(CASE WHEN ano = 2021 THEN qtdePedidos ELSE 0 END) -                       SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END)) * 100.0 /                      SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END), 2                 )         END AS variacao_percentual     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      pedidos_2021 > 0 AND pedidos_2020 > 0 ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING AVG(ip.precoVendido * ip.qtdePedida) > (     SELECT AVG(ip2.precoVendido * ip2.qtdePedida)     FROM ItensPedidoVenda ip2 );"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.dataPedido) AS nomeDiaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.dataPedido),      WEEKDAY(pv.dataPedido) ORDER BY      WEEKDAY(pv.dataPedido);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      Vendedor.nomeVendedor,      COUNT(PedidoVenda.idPedido) AS quantidade_vendas FROM      PedidoVenda JOIN      Vendedor ON PedidoVenda.idVendedor = Vendedor.idVendedor GROUP BY      Vendedor.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.numParcelas,     COUNT(*) AS numeroVendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.numParcelas ORDER BY ano, mes, numParcelas;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.idCategoria,         YEAR(pv.dataPedido) AS ano,         SUM(ip.qtdePedida * ip.precoVendido) AS totalVendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     GROUP BY p.idCategoria, YEAR(pv.dataPedido) ), VariacaoAnual AS (     SELECT          va1.idCategoria,         va1.ano AS anoAtual,         va1.totalVendas AS vendasAtual,         va2.totalVendas AS vendasAnterior,         CASE              WHEN va2.totalVendas IS NOT NULL AND va2.totalVendas <> 0              THEN ((va1.totalVendas - va2.totalVendas) / va2.totalVendas) * 100             ELSE NULL          END AS variacaoPercentual     FROM VendasAno va1     LEFT JOIN VendasAno va2          ON va1.idCategoria = va2.idCategoria          AND va1.ano = va2.ano + 1 ) SELECT      c.nomeCategoria,     va.anoAtual,     va.vendasAtual,     va.vendasAnterior,     va.variacaoPercentual FROM VariacaoAnual va JOIN CategoriaProduto c ON va.idCategoria = c.idCategoria ORDER BY c.nomeCategoria, va.anoAtual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         SUM(CASE WHEN ano = 2021 THEN qtdePedidos ELSE 0 END) AS pedidos_2021,         SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END) AS pedidos_2020,         CASE              WHEN SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END) = 0 THEN NULL             ELSE                  ROUND(                     (SUM(CASE WHEN ano = 2021 THEN qtdePedidos ELSE 0 END) -                       SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END)) * 100.0 /                      SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END), 2                 )         END AS variacao_percentual     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      pedidos_2021 > 0 AND pedidos_2020 > 0 ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING AVG(ip.precoVendido * ip.qtdePedida) > (     SELECT AVG(ip2.precoVendido * ip2.qtdePedida)     FROM ItensPedidoVenda ip2 );"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.dataPedido) AS nomeDiaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.dataPedido),      WEEKDAY(pv.dataPedido) ORDER BY      WEEKDAY(pv.dataPedido);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      Vendedor.nomeVendedor,      COUNT(PedidoVenda.idPedido) AS quantidade_vendas FROM      PedidoVenda JOIN      Vendedor ON PedidoVenda.idVendedor = Vendedor.idVendedor GROUP BY      Vendedor.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.numParcelas,     COUNT(*) AS numeroVendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.numParcelas ORDER BY ano, mes, numParcelas;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.idCategoria,         YEAR(pv.dataPedido) AS ano,         SUM(ip.qtdePedida * ip.precoVendido) AS totalVendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     GROUP BY p.idCategoria, YEAR(pv.dataPedido) ), VariacaoAnual AS (     SELECT          va1.idCategoria,         va1.ano AS anoAtual,         va1.totalVendas AS vendasAtual,         va2.totalVendas AS vendasAnterior,         CASE              WHEN va2.totalVendas IS NOT NULL AND va2.totalVendas <> 0              THEN ((va1.totalVendas - va2.totalVendas) / va2.totalVendas) * 100             ELSE NULL          END AS variacaoPercentual     FROM VendasAno va1     LEFT JOIN VendasAno va2          ON va1.idCategoria = va2.idCategoria          AND va1.ano = va2.ano + 1 ) SELECT      c.nomeCategoria,     va.anoAtual,     va.vendasAtual,     va.vendasAnterior,     va.variacaoPercentual FROM VariacaoAnual va JOIN CategoriaProduto c ON va.idCategoria = c.idCategoria ORDER BY c.nomeCategoria, va.anoAtual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         SUM(CASE WHEN ano = 2021 THEN qtdePedidos ELSE 0 END) AS pedidos_2021,         SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END) AS pedidos_2020,         CASE              WHEN SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END) = 0 THEN NULL             ELSE                  ROUND(                     (SUM(CASE WHEN ano = 2021 THEN qtdePedidos ELSE 0 END) -                       SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END)) * 100.0 /                      SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END), 2                 )         END AS variacao_percentual     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      pedidos_2021 > 0 AND pedidos_2020 > 0 ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING AVG(ip.precoVendido * ip.qtdePedida) > (     SELECT AVG(ip2.precoVendido * ip2.qtdePedida)     FROM ItensPedidoVenda ip2 );"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.dataPedido) AS nomeDiaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.dataPedido),      WEEKDAY(pv.dataPedido) ORDER BY      WEEKDAY(pv.dataPedido);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      Vendedor.nomeVendedor,      COUNT(PedidoVenda.idPedido) AS quantidade_vendas FROM      PedidoVenda JOIN      Vendedor ON PedidoVenda.idVendedor = Vendedor.idVendedor GROUP BY      Vendedor.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.numParcelas,     COUNT(*) AS numeroVendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.numParcelas ORDER BY ano, mes, numParcelas;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.idCategoria,         YEAR(pv.dataPedido) AS ano,         SUM(ip.qtdePedida * ip.precoVendido) AS totalVendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     GROUP BY p.idCategoria, YEAR(pv.dataPedido) ), VariacaoAnual AS (     SELECT          va1.idCategoria,         va1.ano AS anoAtual,         va1.totalVendas AS vendasAtual,         va2.totalVendas AS vendasAnterior,         CASE              WHEN va2.totalVendas IS NOT NULL AND va2.totalVendas <> 0              THEN ((va1.totalVendas - va2.totalVendas) / va2.totalVendas) * 100             ELSE NULL          END AS variacaoPercentual     FROM VendasAno va1     LEFT JOIN VendasAno va2          ON va1.idCategoria = va2.idCategoria          AND va1.ano = va2.ano + 1 ) SELECT      c.nomeCategoria,     va.anoAtual,     va.vendasAtual,     va.vendasAnterior,     va.variacaoPercentual FROM VariacaoAnual va JOIN CategoriaProduto c ON va.idCategoria = c.idCategoria ORDER BY c.nomeCategoria, va.anoAtual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         SUM(CASE WHEN ano = 2021 THEN qtdePedidos ELSE 0 END) AS pedidos_2021,         SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END) AS pedidos_2020,         CASE              WHEN SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END) = 0 THEN NULL             ELSE                  ROUND(                     (SUM(CASE WHEN ano = 2021 THEN qtdePedidos ELSE 0 END) -                       SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END)) * 100.0 /                      SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END), 2                 )         END AS variacao_percentual     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      pedidos_2021 > 0 AND pedidos_2020 > 0 ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING AVG(ip.precoVendido * ip.qtdePedida) > (     SELECT AVG(ip2.precoVendido * ip2.qtdePedida)     FROM ItensPedidoVenda ip2 );"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.dataPedido) AS nomeDiaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.dataPedido),      WEEKDAY(pv.dataPedido) ORDER BY      WEEKDAY(pv.dataPedido);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      Vendedor.nomeVendedor,      COUNT(PedidoVenda.idPedido) AS quantidade_vendas FROM      PedidoVenda JOIN      Vendedor ON PedidoVenda.idVendedor = Vendedor.idVendedor GROUP BY      Vendedor.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.numParcelas,     COUNT(*) AS numeroVendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.numParcelas ORDER BY ano, mes, numParcelas;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.idCategoria,         YEAR(pv.dataPedido) AS ano,         SUM(ip.qtdePedida * ip.precoVendido) AS totalVendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     GROUP BY p.idCategoria, YEAR(pv.dataPedido) ), VariacaoAnual AS (     SELECT          va1.idCategoria,         va1.ano AS anoAtual,         va1.totalVendas AS vendasAtual,         va2.totalVendas AS vendasAnterior,         CASE              WHEN va2.totalVendas IS NOT NULL AND va2.totalVendas <> 0              THEN ((va1.totalVendas - va2.totalVendas) / va2.totalVendas) * 100             ELSE NULL          END AS variacaoPercentual     FROM VendasAno va1     LEFT JOIN VendasAno va2          ON va1.idCategoria = va2.idCategoria          AND va1.ano = va2.ano + 1 ) SELECT      c.nomeCategoria,     va.anoAtual,     va.vendasAtual,     va.vendasAnterior,     va.variacaoPercentual FROM VariacaoAnual va JOIN CategoriaProduto c ON va.idCategoria = c.idCategoria ORDER BY c.nomeCategoria, va.anoAtual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         SUM(CASE WHEN ano = 2021 THEN qtdePedidos ELSE 0 END) AS pedidos_2021,         SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END) AS pedidos_2020,         CASE              WHEN SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END) = 0 THEN NULL             ELSE                  ROUND(                     (SUM(CASE WHEN ano = 2021 THEN qtdePedidos ELSE 0 END) -                       SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END)) * 100.0 /                      SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END), 2                 )         END AS variacao_percentual     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      pedidos_2021 > 0 AND pedidos_2020 > 0 ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING AVG(ip.precoVendido * ip.qtdePedida) > (     SELECT AVG(ip2.precoVendido * ip2.qtdePedida)     FROM ItensPedidoVenda ip2 );"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.dataPedido) AS nomeDiaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.dataPedido),      WEEKDAY(pv.dataPedido) ORDER BY      WEEKDAY(pv.dataPedido);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      Vendedor.nomeVendedor,      COUNT(PedidoVenda.idPedido) AS quantidade_vendas FROM      PedidoVenda JOIN      Vendedor ON PedidoVenda.idVendedor = Vendedor.idVendedor GROUP BY      Vendedor.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.numParcelas,     COUNT(*) AS numeroVendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.numParcelas ORDER BY ano, mes, numParcelas;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.idCategoria,         YEAR(pv.dataPedido) AS ano,         SUM(ip.qtdePedida * ip.precoVendido) AS totalVendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     GROUP BY p.idCategoria, YEAR(pv.dataPedido) ), VariacaoAnual AS (     SELECT          va1.idCategoria,         va1.ano AS anoAtual,         va1.totalVendas AS vendasAtual,         va2.totalVendas AS vendasAnterior,         CASE              WHEN va2.totalVendas IS NOT NULL AND va2.totalVendas <> 0              THEN ((va1.totalVendas - va2.totalVendas) / va2.totalVendas) * 100             ELSE NULL          END AS variacaoPercentual     FROM VendasAno va1     LEFT JOIN VendasAno va2          ON va1.idCategoria = va2.idCategoria          AND va1.ano = va2.ano + 1 ) SELECT      c.nomeCategoria,     va.anoAtual,     va.vendasAtual,     va.vendasAnterior,     va.variacaoPercentual FROM VariacaoAnual va JOIN CategoriaProduto c ON va.idCategoria = c.idCategoria ORDER BY c.nomeCategoria, va.anoAtual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         SUM(CASE WHEN ano = 2021 THEN qtdePedidos ELSE 0 END) AS pedidos_2021,         SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END) AS pedidos_2020,         CASE              WHEN SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END) = 0 THEN NULL             ELSE                  ROUND(                     (SUM(CASE WHEN ano = 2021 THEN qtdePedidos ELSE 0 END) -                       SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END)) * 100.0 /                      SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END), 2                 )         END AS variacao_percentual     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      pedidos_2021 > 0 AND pedidos_2020 > 0 ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING AVG(ip.precoVendido * ip.qtdePedida) > (     SELECT AVG(ip2.precoVendido * ip2.qtdePedida)     FROM ItensPedidoVenda ip2 );"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.dataPedido) AS nomeDiaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.dataPedido),      WEEKDAY(pv.dataPedido) ORDER BY      WEEKDAY(pv.dataPedido);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      Vendedor.nomeVendedor,      COUNT(PedidoVenda.idPedido) AS quantidade_vendas FROM      PedidoVenda JOIN      Vendedor ON PedidoVenda.idVendedor = Vendedor.idVendedor GROUP BY      Vendedor.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.numParcelas,     COUNT(*) AS numeroVendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.numParcelas ORDER BY ano, mes, numParcelas;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.idCategoria,         YEAR(pv.dataPedido) AS ano,         SUM(ip.qtdePedida * ip.precoVendido) AS totalVendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     GROUP BY p.idCategoria, YEAR(pv.dataPedido) ), VariacaoAnual AS (     SELECT          va1.idCategoria,         va1.ano AS anoAtual,         va1.totalVendas AS vendasAtual,         va2.totalVendas AS vendasAnterior,         CASE              WHEN va2.totalVendas IS NOT NULL AND va2.totalVendas <> 0              THEN ((va1.totalVendas - va2.totalVendas) / va2.totalVendas) * 100             ELSE NULL          END AS variacaoPercentual     FROM VendasAno va1     LEFT JOIN VendasAno va2          ON va1.idCategoria = va2.idCategoria          AND va1.ano = va2.ano + 1 ) SELECT      c.nomeCategoria,     va.anoAtual,     va.vendasAtual,     va.vendasAnterior,     va.variacaoPercentual FROM VariacaoAnual va JOIN CategoriaProduto c ON va.idCategoria = c.idCategoria ORDER BY c.nomeCategoria, va.anoAtual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         SUM(CASE WHEN ano = 2021 THEN qtdePedidos ELSE 0 END) AS pedidos_2021,         SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END) AS pedidos_2020,         CASE              WHEN SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END) = 0 THEN NULL             ELSE                  ROUND(                     (SUM(CASE WHEN ano = 2021 THEN qtdePedidos ELSE 0 END) -                       SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END)) * 100.0 /                      SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END), 2                 )         END AS variacao_percentual     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      pedidos_2021 > 0 AND pedidos_2020 > 0 ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING AVG(ip.precoVendido * ip.qtdePedida) > (     SELECT AVG(ip2.precoVendido * ip2.qtdePedida)     FROM ItensPedidoVenda ip2 );"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.dataPedido) AS nomeDiaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.dataPedido),      WEEKDAY(pv.dataPedido) ORDER BY      WEEKDAY(pv.dataPedido);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      Vendedor.nomeVendedor,      COUNT(PedidoVenda.idPedido) AS quantidade_vendas FROM      PedidoVenda JOIN      Vendedor ON PedidoVenda.idVendedor = Vendedor.idVendedor GROUP BY      Vendedor.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.numParcelas,     COUNT(*) AS numeroVendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.numParcelas ORDER BY ano, mes, numParcelas;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.idCategoria,         YEAR(pv.dataPedido) AS ano,         SUM(ip.qtdePedida * ip.precoVendido) AS totalVendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     GROUP BY p.idCategoria, YEAR(pv.dataPedido) ), VariacaoAnual AS (     SELECT          va1.idCategoria,         va1.ano AS anoAtual,         va1.totalVendas AS vendasAtual,         va2.totalVendas AS vendasAnterior,         CASE              WHEN va2.totalVendas IS NOT NULL AND va2.totalVendas <> 0              THEN ((va1.totalVendas - va2.totalVendas) / va2.totalVendas) * 100             ELSE NULL          END AS variacaoPercentual     FROM VendasAno va1     LEFT JOIN VendasAno va2          ON va1.idCategoria = va2.idCategoria          AND va1.ano = va2.ano + 1 ) SELECT      c.nomeCategoria,     va.anoAtual,     va.vendasAtual,     va.vendasAnterior,     va.variacaoPercentual FROM VariacaoAnual va JOIN CategoriaProduto c ON va.idCategoria = c.idCategoria ORDER BY c.nomeCategoria, va.anoAtual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         SUM(CASE WHEN ano = 2021 THEN qtdePedidos ELSE 0 END) AS pedidos_2021,         SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END) AS pedidos_2020,         CASE              WHEN SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END) = 0 THEN NULL             ELSE                  ROUND(                     (SUM(CASE WHEN ano = 2021 THEN qtdePedidos ELSE 0 END) -                       SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END)) * 100.0 /                      SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END), 2                 )         END AS variacao_percentual     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      pedidos_2021 > 0 AND pedidos_2020 > 0 ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING AVG(ip.precoVendido * ip.qtdePedida) > (     SELECT AVG(ip2.precoVendido * ip2.qtdePedida)     FROM ItensPedidoVenda ip2 );"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.dataPedido) AS nomeDiaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.dataPedido),      WEEKDAY(pv.dataPedido) ORDER BY      WEEKDAY(pv.dataPedido);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      Vendedor.nomeVendedor,      COUNT(PedidoVenda.idPedido) AS quantidade_vendas FROM      PedidoVenda JOIN      Vendedor ON PedidoVenda.idVendedor = Vendedor.idVendedor GROUP BY      Vendedor.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.numParcelas,     COUNT(*) AS numeroVendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.numParcelas ORDER BY ano, mes, numParcelas;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.idCategoria,         YEAR(pv.dataPedido) AS ano,         SUM(ip.qtdePedida * ip.precoVendido) AS totalVendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     GROUP BY p.idCategoria, YEAR(pv.dataPedido) ), VariacaoAnual AS (     SELECT          va1.idCategoria,         va1.ano AS anoAtual,         va1.totalVendas AS vendasAtual,         va2.totalVendas AS vendasAnterior,         CASE              WHEN va2.totalVendas IS NOT NULL AND va2.totalVendas <> 0              THEN ((va1.totalVendas - va2.totalVendas) / va2.totalVendas) * 100             ELSE NULL          END AS variacaoPercentual     FROM VendasAno va1     LEFT JOIN VendasAno va2          ON va1.idCategoria = va2.idCategoria          AND va1.ano = va2.ano + 1 ) SELECT      c.nomeCategoria,     va.anoAtual,     va.vendasAtual,     va.vendasAnterior,     va.variacaoPercentual FROM VariacaoAnual va JOIN CategoriaProduto c ON va.idCategoria = c.idCategoria ORDER BY c.nomeCategoria, va.anoAtual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         SUM(CASE WHEN ano = 2021 THEN qtdePedidos ELSE 0 END) AS pedidos_2021,         SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END) AS pedidos_2020,         CASE              WHEN SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END) = 0 THEN NULL             ELSE                  ROUND(                     (SUM(CASE WHEN ano = 2021 THEN qtdePedidos ELSE 0 END) -                       SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END)) * 100.0 /                      SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END), 2                 )         END AS variacao_percentual     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      pedidos_2021 > 0 AND pedidos_2020 > 0 ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING AVG(ip.precoVendido * ip.qtdePedida) > (     SELECT AVG(ip2.precoVendido * ip2.qtdePedida)     FROM ItensPedidoVenda ip2 );"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.dataPedido) AS nomeDiaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.dataPedido),      WEEKDAY(pv.dataPedido) ORDER BY      WEEKDAY(pv.dataPedido);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      Vendedor.nomeVendedor,      COUNT(PedidoVenda.idPedido) AS quantidade_vendas FROM      PedidoVenda JOIN      Vendedor ON PedidoVenda.idVendedor = Vendedor.idVendedor GROUP BY      Vendedor.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.numParcelas,     COUNT(*) AS numeroVendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.numParcelas ORDER BY ano, mes, numParcelas;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.idCategoria,         YEAR(pv.dataPedido) AS ano,         SUM(ip.qtdePedida * ip.precoVendido) AS totalVendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     GROUP BY p.idCategoria, YEAR(pv.dataPedido) ), VariacaoAnual AS (     SELECT          va1.idCategoria,         va1.ano AS anoAtual,         va1.totalVendas AS vendasAtual,         va2.totalVendas AS vendasAnterior,         CASE              WHEN va2.totalVendas IS NOT NULL AND va2.totalVendas <> 0              THEN ((va1.totalVendas - va2.totalVendas) / va2.totalVendas) * 100             ELSE NULL          END AS variacaoPercentual     FROM VendasAno va1     LEFT JOIN VendasAno va2          ON va1.idCategoria = va2.idCategoria          AND va1.ano = va2.ano + 1 ) SELECT      c.nomeCategoria,     va.anoAtual,     va.vendasAtual,     va.vendasAnterior,     va.variacaoPercentual FROM VariacaoAnual va JOIN CategoriaProduto c ON va.idCategoria = c.idCategoria ORDER BY c.nomeCategoria, va.anoAtual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         SUM(CASE WHEN ano = 2021 THEN qtdePedidos ELSE 0 END) AS pedidos_2021,         SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END) AS pedidos_2020,         CASE              WHEN SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END) = 0 THEN NULL             ELSE                  ROUND(                     (SUM(CASE WHEN ano = 2021 THEN qtdePedidos ELSE 0 END) -                       SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END)) * 100.0 /                      SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END), 2                 )         END AS variacao_percentual     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      pedidos_2021 > 0 AND pedidos_2020 > 0 ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING AVG(ip.precoVendido * ip.qtdePedida) > (     SELECT AVG(ip2.precoVendido * ip2.qtdePedida)     FROM ItensPedidoVenda ip2 );"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.dataPedido) AS nomeDiaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.dataPedido),      WEEKDAY(pv.dataPedido) ORDER BY      WEEKDAY(pv.dataPedido);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      Vendedor.nomeVendedor,      COUNT(PedidoVenda.idPedido) AS quantidade_vendas FROM      PedidoVenda JOIN      Vendedor ON PedidoVenda.idVendedor = Vendedor.idVendedor GROUP BY      Vendedor.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.numParcelas,     COUNT(*) AS numeroVendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.numParcelas ORDER BY ano, mes, numParcelas;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.idCategoria,         YEAR(pv.dataPedido) AS ano,         SUM(ip.qtdePedida * ip.precoVendido) AS totalVendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     GROUP BY p.idCategoria, YEAR(pv.dataPedido) ), VariacaoAnual AS (     SELECT          va1.idCategoria,         va1.ano AS anoAtual,         va1.totalVendas AS vendasAtual,         va2.totalVendas AS vendasAnterior,         CASE              WHEN va2.totalVendas IS NOT NULL AND va2.totalVendas <> 0              THEN ((va1.totalVendas - va2.totalVendas) / va2.totalVendas) * 100             ELSE NULL          END AS variacaoPercentual     FROM VendasAno va1     LEFT JOIN VendasAno va2          ON va1.idCategoria = va2.idCategoria          AND va1.ano = va2.ano + 1 ) SELECT      c.nomeCategoria,     va.anoAtual,     va.vendasAtual,     va.vendasAnterior,     va.variacaoPercentual FROM VariacaoAnual va JOIN CategoriaProduto c ON va.idCategoria = c.idCategoria ORDER BY c.nomeCategoria, va.anoAtual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         SUM(CASE WHEN ano = 2021 THEN qtdePedidos ELSE 0 END) AS pedidos_2021,         SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END) AS pedidos_2020,         CASE              WHEN SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END) = 0 THEN NULL             ELSE                  ROUND(                     (SUM(CASE WHEN ano = 2021 THEN qtdePedidos ELSE 0 END) -                       SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END)) * 100.0 /                      SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END), 2                 )         END AS variacao_percentual     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      pedidos_2021 > 0 AND pedidos_2020 > 0 ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING AVG(ip.precoVendido * ip.qtdePedida) > (     SELECT AVG(ip2.precoVendido * ip2.qtdePedida)     FROM ItensPedidoVenda ip2 );"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.dataPedido) AS nomeDiaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.dataPedido),      WEEKDAY(pv.dataPedido) ORDER BY      WEEKDAY(pv.dataPedido);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      Vendedor.nomeVendedor,      COUNT(PedidoVenda.idPedido) AS quantidade_vendas FROM      PedidoVenda JOIN      Vendedor ON PedidoVenda.idVendedor = Vendedor.idVendedor GROUP BY      Vendedor.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.numParcelas,     COUNT(*) AS numeroVendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.numParcelas ORDER BY ano, mes, numParcelas;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.idCategoria,         YEAR(pv.dataPedido) AS ano,         SUM(ip.qtdePedida * ip.precoVendido) AS totalVendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     GROUP BY p.idCategoria, YEAR(pv.dataPedido) ), VariacaoAnual AS (     SELECT          va1.idCategoria,         va1.ano AS anoAtual,         va1.totalVendas AS vendasAtual,         va2.totalVendas AS vendasAnterior,         CASE              WHEN va2.totalVendas IS NOT NULL AND va2.totalVendas <> 0              THEN ((va1.totalVendas - va2.totalVendas) / va2.totalVendas) * 100             ELSE NULL          END AS variacaoPercentual     FROM VendasAno va1     LEFT JOIN VendasAno va2          ON va1.idCategoria = va2.idCategoria          AND va1.ano = va2.ano + 1 ) SELECT      c.nomeCategoria,     va.anoAtual,     va.vendasAtual,     va.vendasAnterior,     va.variacaoPercentual FROM VariacaoAnual va JOIN CategoriaProduto c ON va.idCategoria = c.idCategoria ORDER BY c.nomeCategoria, va.anoAtual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         SUM(CASE WHEN ano = 2021 THEN qtdePedidos ELSE 0 END) AS pedidos_2021,         SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END) AS pedidos_2020,         CASE              WHEN SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END) = 0 THEN NULL             ELSE                  ROUND(                     (SUM(CASE WHEN ano = 2021 THEN qtdePedidos ELSE 0 END) -                       SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END)) * 100.0 /                      SUM(CASE WHEN ano = 2020 THEN qtdePedidos ELSE 0 END), 2                 )         END AS variacao_percentual     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      pedidos_2021 > 0 AND pedidos_2020 > 0 ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING AVG(ip.precoVendido * ip.qtdePedida) > (     SELECT AVG(ip2.precoVendido * ip2.qtdePedida)     FROM ItensPedidoVenda ip2 );"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS quantidade_vendida FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      quantidade_vendida DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS posicao     FROM VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.posicao <= 10 ORDER BY rv.ano, rv.posicao;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ip.`qtdePedida` * ip.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     JOIN `Produto` p ON ip.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), VendasAnoAnterior AS (     SELECT          va1.`idCategoria`,         va1.ano,         va1.total_vendas AS vendas_ano_atual,         LAG(va1.total_vendas) OVER (PARTITION BY va1.`idCategoria` ORDER BY va1.ano) AS vendas_ano_anterior     FROM VendasAno va1 ) SELECT      c.`nomeCategoria`,     vaa.ano,     CASE          WHEN vaa.vendas_ano_anterior IS NOT NULL AND vaa.vendas_ano_anterior <> 0 THEN             ROUND(((vaa.vendas_ano_atual - vaa.vendas_ano_anterior) / vaa.vendas_ano_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasAnoAnterior vaa JOIN `CategoriaProduto` c ON vaa.`idCategoria` = c.`idCategoria` WHERE vaa.vendas_ano_anterior IS NOT NULL ORDER BY c.`nomeCategoria`, vaa.ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacao_percentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacao_percentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH VendasAno AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtde_vendas     FROM `PedidoVenda` pv     JOIN `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VendasComparadas AS (     SELECT          v2021.`idMarketPlace`,         v2021.`nomeMarketPlace`,         v2021.qtde_vendas AS vendas_2021,         v2020.qtde_vendas AS vendas_2020,         CASE              WHEN v2020.qtde_vendas = 0 THEN NULL             ELSE ((v2021.qtde_vendas - v2020.qtde_vendas) * 100.0 / v2020.qtde_vendas)         END AS variacao_percentual     FROM VendasAno v2021     JOIN VendasAno v2020          ON v2021.`idMarketPlace` = v2020.`idMarketPlace`     WHERE v2021.ano = 2021 AND v2020.ano = 2020 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM VendasComparadas WHERE variacao_percentual = (SELECT MAX(variacao_percentual) FROM VendasComparadas);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida)      FROM ItensPedidoVenda iv2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_pedido_cliente > media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS quantidade_vendida FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      quantidade_vendida DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS posicao     FROM VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.posicao <= 10 ORDER BY rv.ano, rv.posicao;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ip.`qtdePedida` * ip.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     JOIN `Produto` p ON ip.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), VendasAnoAnterior AS (     SELECT          va1.`idCategoria`,         va1.ano,         va1.total_vendas AS vendas_ano_atual,         LAG(va1.total_vendas) OVER (PARTITION BY va1.`idCategoria` ORDER BY va1.ano) AS vendas_ano_anterior     FROM VendasAno va1 ) SELECT      c.`nomeCategoria`,     vaa.ano,     CASE          WHEN vaa.vendas_ano_anterior IS NOT NULL AND vaa.vendas_ano_anterior <> 0 THEN             ROUND(((vaa.vendas_ano_atual - vaa.vendas_ano_anterior) / vaa.vendas_ano_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasAnoAnterior vaa JOIN `CategoriaProduto` c ON vaa.`idCategoria` = c.`idCategoria` WHERE vaa.vendas_ano_anterior IS NOT NULL ORDER BY c.`nomeCategoria`, vaa.ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacao_percentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacao_percentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH VendasAno AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtde_vendas     FROM `PedidoVenda` pv     JOIN `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VendasComparadas AS (     SELECT          v2021.`idMarketPlace`,         v2021.`nomeMarketPlace`,         v2021.qtde_vendas AS vendas_2021,         v2020.qtde_vendas AS vendas_2020,         CASE              WHEN v2020.qtde_vendas = 0 THEN NULL             ELSE ((v2021.qtde_vendas - v2020.qtde_vendas) * 100.0 / v2020.qtde_vendas)         END AS variacao_percentual     FROM VendasAno v2021     JOIN VendasAno v2020          ON v2021.`idMarketPlace` = v2020.`idMarketPlace`     WHERE v2021.ano = 2021 AND v2020.ano = 2020 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM VendasComparadas WHERE variacao_percentual = (SELECT MAX(variacao_percentual) FROM VendasComparadas);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida)      FROM ItensPedidoVenda iv2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_pedido_cliente > media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS quantidade_vendida FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      quantidade_vendida DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS posicao     FROM VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.posicao <= 10 ORDER BY rv.ano, rv.posicao;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ip.`qtdePedida` * ip.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     JOIN `Produto` p ON ip.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), VendasAnoAnterior AS (     SELECT          va1.`idCategoria`,         va1.ano,         va1.total_vendas AS vendas_ano_atual,         LAG(va1.total_vendas) OVER (PARTITION BY va1.`idCategoria` ORDER BY va1.ano) AS vendas_ano_anterior     FROM VendasAno va1 ) SELECT      c.`nomeCategoria`,     vaa.ano,     CASE          WHEN vaa.vendas_ano_anterior IS NOT NULL AND vaa.vendas_ano_anterior <> 0 THEN             ROUND(((vaa.vendas_ano_atual - vaa.vendas_ano_anterior) / vaa.vendas_ano_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasAnoAnterior vaa JOIN `CategoriaProduto` c ON vaa.`idCategoria` = c.`idCategoria` WHERE vaa.vendas_ano_anterior IS NOT NULL ORDER BY c.`nomeCategoria`, vaa.ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacao_percentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacao_percentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH VendasAno AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtde_vendas     FROM `PedidoVenda` pv     JOIN `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VendasComparadas AS (     SELECT          v2021.`idMarketPlace`,         v2021.`nomeMarketPlace`,         v2021.qtde_vendas AS vendas_2021,         v2020.qtde_vendas AS vendas_2020,         CASE              WHEN v2020.qtde_vendas = 0 THEN NULL             ELSE ((v2021.qtde_vendas - v2020.qtde_vendas) * 100.0 / v2020.qtde_vendas)         END AS variacao_percentual     FROM VendasAno v2021     JOIN VendasAno v2020          ON v2021.`idMarketPlace` = v2020.`idMarketPlace`     WHERE v2021.ano = 2021 AND v2020.ano = 2020 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM VendasComparadas WHERE variacao_percentual = (SELECT MAX(variacao_percentual) FROM VendasComparadas);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida)      FROM ItensPedidoVenda iv2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_pedido_cliente > media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS quantidade_vendida FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      quantidade_vendida DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS posicao     FROM VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.posicao <= 10 ORDER BY rv.ano, rv.posicao;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ip.`qtdePedida` * ip.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     JOIN `Produto` p ON ip.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), VendasAnoAnterior AS (     SELECT          va1.`idCategoria`,         va1.ano,         va1.total_vendas AS vendas_ano_atual,         LAG(va1.total_vendas) OVER (PARTITION BY va1.`idCategoria` ORDER BY va1.ano) AS vendas_ano_anterior     FROM VendasAno va1 ) SELECT      c.`nomeCategoria`,     vaa.ano,     CASE          WHEN vaa.vendas_ano_anterior IS NOT NULL AND vaa.vendas_ano_anterior <> 0 THEN             ROUND(((vaa.vendas_ano_atual - vaa.vendas_ano_anterior) / vaa.vendas_ano_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasAnoAnterior vaa JOIN `CategoriaProduto` c ON vaa.`idCategoria` = c.`idCategoria` WHERE vaa.vendas_ano_anterior IS NOT NULL ORDER BY c.`nomeCategoria`, vaa.ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacao_percentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacao_percentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH VendasAno AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtde_vendas     FROM `PedidoVenda` pv     JOIN `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VendasComparadas AS (     SELECT          v2021.`idMarketPlace`,         v2021.`nomeMarketPlace`,         v2021.qtde_vendas AS vendas_2021,         v2020.qtde_vendas AS vendas_2020,         CASE              WHEN v2020.qtde_vendas = 0 THEN NULL             ELSE ((v2021.qtde_vendas - v2020.qtde_vendas) * 100.0 / v2020.qtde_vendas)         END AS variacao_percentual     FROM VendasAno v2021     JOIN VendasAno v2020          ON v2021.`idMarketPlace` = v2020.`idMarketPlace`     WHERE v2021.ano = 2021 AND v2020.ano = 2020 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM VendasComparadas WHERE variacao_percentual = (SELECT MAX(variacao_percentual) FROM VendasComparadas);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida)      FROM ItensPedidoVenda iv2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_pedido_cliente > media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS quantidade_vendida FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      quantidade_vendida DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS posicao     FROM VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.posicao <= 10 ORDER BY rv.ano, rv.posicao;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ip.`qtdePedida` * ip.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     JOIN `Produto` p ON ip.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), VendasAnoAnterior AS (     SELECT          va1.`idCategoria`,         va1.ano,         va1.total_vendas AS vendas_ano_atual,         LAG(va1.total_vendas) OVER (PARTITION BY va1.`idCategoria` ORDER BY va1.ano) AS vendas_ano_anterior     FROM VendasAno va1 ) SELECT      c.`nomeCategoria`,     vaa.ano,     CASE          WHEN vaa.vendas_ano_anterior IS NOT NULL AND vaa.vendas_ano_anterior <> 0 THEN             ROUND(((vaa.vendas_ano_atual - vaa.vendas_ano_anterior) / vaa.vendas_ano_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasAnoAnterior vaa JOIN `CategoriaProduto` c ON vaa.`idCategoria` = c.`idCategoria` WHERE vaa.vendas_ano_anterior IS NOT NULL ORDER BY c.`nomeCategoria`, vaa.ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacao_percentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacao_percentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH VendasAno AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtde_vendas     FROM `PedidoVenda` pv     JOIN `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VendasComparadas AS (     SELECT          v2021.`idMarketPlace`,         v2021.`nomeMarketPlace`,         v2021.qtde_vendas AS vendas_2021,         v2020.qtde_vendas AS vendas_2020,         CASE              WHEN v2020.qtde_vendas = 0 THEN NULL             ELSE ((v2021.qtde_vendas - v2020.qtde_vendas) * 100.0 / v2020.qtde_vendas)         END AS variacao_percentual     FROM VendasAno v2021     JOIN VendasAno v2020          ON v2021.`idMarketPlace` = v2020.`idMarketPlace`     WHERE v2021.ano = 2021 AND v2020.ano = 2020 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM VendasComparadas WHERE variacao_percentual = (SELECT MAX(variacao_percentual) FROM VendasComparadas);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida)      FROM ItensPedidoVenda iv2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_pedido_cliente > media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS quantidade_vendida FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      quantidade_vendida DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS posicao     FROM VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.posicao <= 10 ORDER BY rv.ano, rv.posicao;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ip.`qtdePedida` * ip.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     JOIN `Produto` p ON ip.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), VendasAnoAnterior AS (     SELECT          va1.`idCategoria`,         va1.ano,         va1.total_vendas AS vendas_ano_atual,         LAG(va1.total_vendas) OVER (PARTITION BY va1.`idCategoria` ORDER BY va1.ano) AS vendas_ano_anterior     FROM VendasAno va1 ) SELECT      c.`nomeCategoria`,     vaa.ano,     CASE          WHEN vaa.vendas_ano_anterior IS NOT NULL AND vaa.vendas_ano_anterior <> 0 THEN             ROUND(((vaa.vendas_ano_atual - vaa.vendas_ano_anterior) / vaa.vendas_ano_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasAnoAnterior vaa JOIN `CategoriaProduto` c ON vaa.`idCategoria` = c.`idCategoria` WHERE vaa.vendas_ano_anterior IS NOT NULL ORDER BY c.`nomeCategoria`, vaa.ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacao_percentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacao_percentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH VendasAno AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtde_vendas     FROM `PedidoVenda` pv     JOIN `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VendasComparadas AS (     SELECT          v2021.`idMarketPlace`,         v2021.`nomeMarketPlace`,         v2021.qtde_vendas AS vendas_2021,         v2020.qtde_vendas AS vendas_2020,         CASE              WHEN v2020.qtde_vendas = 0 THEN NULL             ELSE ((v2021.qtde_vendas - v2020.qtde_vendas) * 100.0 / v2020.qtde_vendas)         END AS variacao_percentual     FROM VendasAno v2021     JOIN VendasAno v2020          ON v2021.`idMarketPlace` = v2020.`idMarketPlace`     WHERE v2021.ano = 2021 AND v2020.ano = 2020 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM VendasComparadas WHERE variacao_percentual = (SELECT MAX(variacao_percentual) FROM VendasComparadas);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida)      FROM ItensPedidoVenda iv2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_pedido_cliente > media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS quantidade_vendida FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      quantidade_vendida DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS posicao     FROM VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.posicao <= 10 ORDER BY rv.ano, rv.posicao;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ip.`qtdePedida` * ip.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     JOIN `Produto` p ON ip.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), VendasAnoAnterior AS (     SELECT          va1.`idCategoria`,         va1.ano,         va1.total_vendas AS vendas_ano_atual,         LAG(va1.total_vendas) OVER (PARTITION BY va1.`idCategoria` ORDER BY va1.ano) AS vendas_ano_anterior     FROM VendasAno va1 ) SELECT      c.`nomeCategoria`,     vaa.ano,     CASE          WHEN vaa.vendas_ano_anterior IS NOT NULL AND vaa.vendas_ano_anterior <> 0 THEN             ROUND(((vaa.vendas_ano_atual - vaa.vendas_ano_anterior) / vaa.vendas_ano_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasAnoAnterior vaa JOIN `CategoriaProduto` c ON vaa.`idCategoria` = c.`idCategoria` WHERE vaa.vendas_ano_anterior IS NOT NULL ORDER BY c.`nomeCategoria`, vaa.ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacao_percentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacao_percentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH VendasAno AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtde_vendas     FROM `PedidoVenda` pv     JOIN `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VendasComparadas AS (     SELECT          v2021.`idMarketPlace`,         v2021.`nomeMarketPlace`,         v2021.qtde_vendas AS vendas_2021,         v2020.qtde_vendas AS vendas_2020,         CASE              WHEN v2020.qtde_vendas = 0 THEN NULL             ELSE ((v2021.qtde_vendas - v2020.qtde_vendas) * 100.0 / v2020.qtde_vendas)         END AS variacao_percentual     FROM VendasAno v2021     JOIN VendasAno v2020          ON v2021.`idMarketPlace` = v2020.`idMarketPlace`     WHERE v2021.ano = 2021 AND v2020.ano = 2020 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM VendasComparadas WHERE variacao_percentual = (SELECT MAX(variacao_percentual) FROM VendasComparadas);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida)      FROM ItensPedidoVenda iv2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_pedido_cliente > media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS quantidade_vendida FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      quantidade_vendida DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS posicao     FROM VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.posicao <= 10 ORDER BY rv.ano, rv.posicao;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ip.`qtdePedida` * ip.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     JOIN `Produto` p ON ip.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), VendasAnoAnterior AS (     SELECT          va1.`idCategoria`,         va1.ano,         va1.total_vendas AS vendas_ano_atual,         LAG(va1.total_vendas) OVER (PARTITION BY va1.`idCategoria` ORDER BY va1.ano) AS vendas_ano_anterior     FROM VendasAno va1 ) SELECT      c.`nomeCategoria`,     vaa.ano,     CASE          WHEN vaa.vendas_ano_anterior IS NOT NULL AND vaa.vendas_ano_anterior <> 0 THEN             ROUND(((vaa.vendas_ano_atual - vaa.vendas_ano_anterior) / vaa.vendas_ano_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasAnoAnterior vaa JOIN `CategoriaProduto` c ON vaa.`idCategoria` = c.`idCategoria` WHERE vaa.vendas_ano_anterior IS NOT NULL ORDER BY c.`nomeCategoria`, vaa.ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacao_percentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacao_percentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH VendasAno AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtde_vendas     FROM `PedidoVenda` pv     JOIN `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VendasComparadas AS (     SELECT          v2021.`idMarketPlace`,         v2021.`nomeMarketPlace`,         v2021.qtde_vendas AS vendas_2021,         v2020.qtde_vendas AS vendas_2020,         CASE              WHEN v2020.qtde_vendas = 0 THEN NULL             ELSE ((v2021.qtde_vendas - v2020.qtde_vendas) * 100.0 / v2020.qtde_vendas)         END AS variacao_percentual     FROM VendasAno v2021     JOIN VendasAno v2020          ON v2021.`idMarketPlace` = v2020.`idMarketPlace`     WHERE v2021.ano = 2021 AND v2020.ano = 2020 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM VendasComparadas WHERE variacao_percentual = (SELECT MAX(variacao_percentual) FROM VendasComparadas);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida)      FROM ItensPedidoVenda iv2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_pedido_cliente > media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS quantidade_vendida FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      quantidade_vendida DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS posicao     FROM VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.posicao <= 10 ORDER BY rv.ano, rv.posicao;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ip.`qtdePedida` * ip.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     JOIN `Produto` p ON ip.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), VendasAnoAnterior AS (     SELECT          va1.`idCategoria`,         va1.ano,         va1.total_vendas AS vendas_ano_atual,         LAG(va1.total_vendas) OVER (PARTITION BY va1.`idCategoria` ORDER BY va1.ano) AS vendas_ano_anterior     FROM VendasAno va1 ) SELECT      c.`nomeCategoria`,     vaa.ano,     CASE          WHEN vaa.vendas_ano_anterior IS NOT NULL AND vaa.vendas_ano_anterior <> 0 THEN             ROUND(((vaa.vendas_ano_atual - vaa.vendas_ano_anterior) / vaa.vendas_ano_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasAnoAnterior vaa JOIN `CategoriaProduto` c ON vaa.`idCategoria` = c.`idCategoria` WHERE vaa.vendas_ano_anterior IS NOT NULL ORDER BY c.`nomeCategoria`, vaa.ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacao_percentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacao_percentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH VendasAno AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtde_vendas     FROM `PedidoVenda` pv     JOIN `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VendasComparadas AS (     SELECT          v2021.`idMarketPlace`,         v2021.`nomeMarketPlace`,         v2021.qtde_vendas AS vendas_2021,         v2020.qtde_vendas AS vendas_2020,         CASE              WHEN v2020.qtde_vendas = 0 THEN NULL             ELSE ((v2021.qtde_vendas - v2020.qtde_vendas) * 100.0 / v2020.qtde_vendas)         END AS variacao_percentual     FROM VendasAno v2021     JOIN VendasAno v2020          ON v2021.`idMarketPlace` = v2020.`idMarketPlace`     WHERE v2021.ano = 2021 AND v2020.ano = 2020 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM VendasComparadas WHERE variacao_percentual = (SELECT MAX(variacao_percentual) FROM VendasComparadas);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida)      FROM ItensPedidoVenda iv2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_pedido_cliente > media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS quantidade_vendida FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      quantidade_vendida DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS posicao     FROM VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.posicao <= 10 ORDER BY rv.ano, rv.posicao;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ip.`qtdePedida` * ip.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     JOIN `Produto` p ON ip.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), VendasAnoAnterior AS (     SELECT          va1.`idCategoria`,         va1.ano,         va1.total_vendas AS vendas_ano_atual,         LAG(va1.total_vendas) OVER (PARTITION BY va1.`idCategoria` ORDER BY va1.ano) AS vendas_ano_anterior     FROM VendasAno va1 ) SELECT      c.`nomeCategoria`,     vaa.ano,     CASE          WHEN vaa.vendas_ano_anterior IS NOT NULL AND vaa.vendas_ano_anterior <> 0 THEN             ROUND(((vaa.vendas_ano_atual - vaa.vendas_ano_anterior) / vaa.vendas_ano_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasAnoAnterior vaa JOIN `CategoriaProduto` c ON vaa.`idCategoria` = c.`idCategoria` WHERE vaa.vendas_ano_anterior IS NOT NULL ORDER BY c.`nomeCategoria`, vaa.ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacao_percentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacao_percentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH VendasAno AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtde_vendas     FROM `PedidoVenda` pv     JOIN `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VendasComparadas AS (     SELECT          v2021.`idMarketPlace`,         v2021.`nomeMarketPlace`,         v2021.qtde_vendas AS vendas_2021,         v2020.qtde_vendas AS vendas_2020,         CASE              WHEN v2020.qtde_vendas = 0 THEN NULL             ELSE ((v2021.qtde_vendas - v2020.qtde_vendas) * 100.0 / v2020.qtde_vendas)         END AS variacao_percentual     FROM VendasAno v2021     JOIN VendasAno v2020          ON v2021.`idMarketPlace` = v2020.`idMarketPlace`     WHERE v2021.ano = 2021 AND v2020.ano = 2020 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM VendasComparadas WHERE variacao_percentual = (SELECT MAX(variacao_percentual) FROM VendasComparadas);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida)      FROM ItensPedidoVenda iv2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_pedido_cliente > media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS quantidade_vendida FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      quantidade_vendida DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS posicao     FROM VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.posicao <= 10 ORDER BY rv.ano, rv.posicao;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ip.`qtdePedida` * ip.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     JOIN `Produto` p ON ip.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), VendasAnoAnterior AS (     SELECT          va1.`idCategoria`,         va1.ano,         va1.total_vendas AS vendas_ano_atual,         LAG(va1.total_vendas) OVER (PARTITION BY va1.`idCategoria` ORDER BY va1.ano) AS vendas_ano_anterior     FROM VendasAno va1 ) SELECT      c.`nomeCategoria`,     vaa.ano,     CASE          WHEN vaa.vendas_ano_anterior IS NOT NULL AND vaa.vendas_ano_anterior <> 0 THEN             ROUND(((vaa.vendas_ano_atual - vaa.vendas_ano_anterior) / vaa.vendas_ano_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasAnoAnterior vaa JOIN `CategoriaProduto` c ON vaa.`idCategoria` = c.`idCategoria` WHERE vaa.vendas_ano_anterior IS NOT NULL ORDER BY c.`nomeCategoria`, vaa.ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacao_percentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacao_percentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH VendasAno AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtde_vendas     FROM `PedidoVenda` pv     JOIN `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VendasComparadas AS (     SELECT          v2021.`idMarketPlace`,         v2021.`nomeMarketPlace`,         v2021.qtde_vendas AS vendas_2021,         v2020.qtde_vendas AS vendas_2020,         CASE              WHEN v2020.qtde_vendas = 0 THEN NULL             ELSE ((v2021.qtde_vendas - v2020.qtde_vendas) * 100.0 / v2020.qtde_vendas)         END AS variacao_percentual     FROM VendasAno v2021     JOIN VendasAno v2020          ON v2021.`idMarketPlace` = v2020.`idMarketPlace`     WHERE v2021.ano = 2021 AND v2020.ano = 2020 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM VendasComparadas WHERE variacao_percentual = (SELECT MAX(variacao_percentual) FROM VendasComparadas);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida)      FROM ItensPedidoVenda iv2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_pedido_cliente > media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS quantidade_vendida FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      quantidade_vendida DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS posicao     FROM VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.posicao <= 10 ORDER BY rv.ano, rv.posicao;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ip.`qtdePedida` * ip.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     JOIN `Produto` p ON ip.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), VendasAnoAnterior AS (     SELECT          va1.`idCategoria`,         va1.ano,         va1.total_vendas AS vendas_ano_atual,         LAG(va1.total_vendas) OVER (PARTITION BY va1.`idCategoria` ORDER BY va1.ano) AS vendas_ano_anterior     FROM VendasAno va1 ) SELECT      c.`nomeCategoria`,     vaa.ano,     CASE          WHEN vaa.vendas_ano_anterior IS NOT NULL AND vaa.vendas_ano_anterior <> 0 THEN             ROUND(((vaa.vendas_ano_atual - vaa.vendas_ano_anterior) / vaa.vendas_ano_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasAnoAnterior vaa JOIN `CategoriaProduto` c ON vaa.`idCategoria` = c.`idCategoria` WHERE vaa.vendas_ano_anterior IS NOT NULL ORDER BY c.`nomeCategoria`, vaa.ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacao_percentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacao_percentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH VendasAno AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtde_vendas     FROM `PedidoVenda` pv     JOIN `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VendasComparadas AS (     SELECT          v2021.`idMarketPlace`,         v2021.`nomeMarketPlace`,         v2021.qtde_vendas AS vendas_2021,         v2020.qtde_vendas AS vendas_2020,         CASE              WHEN v2020.qtde_vendas = 0 THEN NULL             ELSE ((v2021.qtde_vendas - v2020.qtde_vendas) * 100.0 / v2020.qtde_vendas)         END AS variacao_percentual     FROM VendasAno v2021     JOIN VendasAno v2020          ON v2021.`idMarketPlace` = v2020.`idMarketPlace`     WHERE v2021.ano = 2021 AND v2020.ano = 2020 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM VendasComparadas WHERE variacao_percentual = (SELECT MAX(variacao_percentual) FROM VendasComparadas);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida)      FROM ItensPedidoVenda iv2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_pedido_cliente > media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS quantidade_vendida FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      quantidade_vendida DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS posicao     FROM VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.posicao <= 10 ORDER BY rv.ano, rv.posicao;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ip.`qtdePedida` * ip.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     JOIN `Produto` p ON ip.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), VendasAnoAnterior AS (     SELECT          va1.`idCategoria`,         va1.ano,         va1.total_vendas AS vendas_ano_atual,         LAG(va1.total_vendas) OVER (PARTITION BY va1.`idCategoria` ORDER BY va1.ano) AS vendas_ano_anterior     FROM VendasAno va1 ) SELECT      c.`nomeCategoria`,     vaa.ano,     CASE          WHEN vaa.vendas_ano_anterior IS NOT NULL AND vaa.vendas_ano_anterior <> 0 THEN             ROUND(((vaa.vendas_ano_atual - vaa.vendas_ano_anterior) / vaa.vendas_ano_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasAnoAnterior vaa JOIN `CategoriaProduto` c ON vaa.`idCategoria` = c.`idCategoria` WHERE vaa.vendas_ano_anterior IS NOT NULL ORDER BY c.`nomeCategoria`, vaa.ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacao_percentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacao_percentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH VendasAno AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtde_vendas     FROM `PedidoVenda` pv     JOIN `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VendasComparadas AS (     SELECT          v2021.`idMarketPlace`,         v2021.`nomeMarketPlace`,         v2021.qtde_vendas AS vendas_2021,         v2020.qtde_vendas AS vendas_2020,         CASE              WHEN v2020.qtde_vendas = 0 THEN NULL             ELSE ((v2021.qtde_vendas - v2020.qtde_vendas) * 100.0 / v2020.qtde_vendas)         END AS variacao_percentual     FROM VendasAno v2021     JOIN VendasAno v2020          ON v2021.`idMarketPlace` = v2020.`idMarketPlace`     WHERE v2021.ano = 2021 AND v2020.ano = 2020 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM VendasComparadas WHERE variacao_percentual = (SELECT MAX(variacao_percentual) FROM VendasComparadas);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida)      FROM ItensPedidoVenda iv2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_pedido_cliente > media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS quantidade_vendida FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      quantidade_vendida DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS posicao     FROM VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.posicao <= 10 ORDER BY rv.ano, rv.posicao;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ip.`qtdePedida` * ip.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     JOIN `Produto` p ON ip.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), VendasAnoAnterior AS (     SELECT          va1.`idCategoria`,         va1.ano,         va1.total_vendas AS vendas_ano_atual,         LAG(va1.total_vendas) OVER (PARTITION BY va1.`idCategoria` ORDER BY va1.ano) AS vendas_ano_anterior     FROM VendasAno va1 ) SELECT      c.`nomeCategoria`,     vaa.ano,     CASE          WHEN vaa.vendas_ano_anterior IS NOT NULL AND vaa.vendas_ano_anterior <> 0 THEN             ROUND(((vaa.vendas_ano_atual - vaa.vendas_ano_anterior) / vaa.vendas_ano_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasAnoAnterior vaa JOIN `CategoriaProduto` c ON vaa.`idCategoria` = c.`idCategoria` WHERE vaa.vendas_ano_anterior IS NOT NULL ORDER BY c.`nomeCategoria`, vaa.ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacao_percentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacao_percentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH VendasAno AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtde_vendas     FROM `PedidoVenda` pv     JOIN `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VendasComparadas AS (     SELECT          v2021.`idMarketPlace`,         v2021.`nomeMarketPlace`,         v2021.qtde_vendas AS vendas_2021,         v2020.qtde_vendas AS vendas_2020,         CASE              WHEN v2020.qtde_vendas = 0 THEN NULL             ELSE ((v2021.qtde_vendas - v2020.qtde_vendas) * 100.0 / v2020.qtde_vendas)         END AS variacao_percentual     FROM VendasAno v2021     JOIN VendasAno v2020          ON v2021.`idMarketPlace` = v2020.`idMarketPlace`     WHERE v2021.ano = 2021 AND v2020.ano = 2020 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM VendasComparadas WHERE variacao_percentual = (SELECT MAX(variacao_percentual) FROM VendasComparadas);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida)      FROM ItensPedidoVenda iv2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_pedido_cliente > media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS quantidade_vendida FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      quantidade_vendida DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS posicao     FROM VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.posicao <= 10 ORDER BY rv.ano, rv.posicao;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ip.`qtdePedida` * ip.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     JOIN `Produto` p ON ip.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), VendasAnoAnterior AS (     SELECT          va1.`idCategoria`,         va1.ano,         va1.total_vendas AS vendas_ano_atual,         LAG(va1.total_vendas) OVER (PARTITION BY va1.`idCategoria` ORDER BY va1.ano) AS vendas_ano_anterior     FROM VendasAno va1 ) SELECT      c.`nomeCategoria`,     vaa.ano,     CASE          WHEN vaa.vendas_ano_anterior IS NOT NULL AND vaa.vendas_ano_anterior <> 0 THEN             ROUND(((vaa.vendas_ano_atual - vaa.vendas_ano_anterior) / vaa.vendas_ano_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasAnoAnterior vaa JOIN `CategoriaProduto` c ON vaa.`idCategoria` = c.`idCategoria` WHERE vaa.vendas_ano_anterior IS NOT NULL ORDER BY c.`nomeCategoria`, vaa.ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacao_percentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacao_percentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH VendasAno AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtde_vendas     FROM `PedidoVenda` pv     JOIN `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VendasComparadas AS (     SELECT          v2021.`idMarketPlace`,         v2021.`nomeMarketPlace`,         v2021.qtde_vendas AS vendas_2021,         v2020.qtde_vendas AS vendas_2020,         CASE              WHEN v2020.qtde_vendas = 0 THEN NULL             ELSE ((v2021.qtde_vendas - v2020.qtde_vendas) * 100.0 / v2020.qtde_vendas)         END AS variacao_percentual     FROM VendasAno v2021     JOIN VendasAno v2020          ON v2021.`idMarketPlace` = v2020.`idMarketPlace`     WHERE v2021.ano = 2021 AND v2020.ano = 2020 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM VendasComparadas WHERE variacao_percentual = (SELECT MAX(variacao_percentual) FROM VendasComparadas);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida)      FROM ItensPedidoVenda iv2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_pedido_cliente > media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS quantidade_vendida FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      quantidade_vendida DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS posicao     FROM VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.posicao <= 10 ORDER BY rv.ano, rv.posicao;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ip.`qtdePedida` * ip.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     JOIN `Produto` p ON ip.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), VendasAnoAnterior AS (     SELECT          va1.`idCategoria`,         va1.ano,         va1.total_vendas AS vendas_ano_atual,         LAG(va1.total_vendas) OVER (PARTITION BY va1.`idCategoria` ORDER BY va1.ano) AS vendas_ano_anterior     FROM VendasAno va1 ) SELECT      c.`nomeCategoria`,     vaa.ano,     CASE          WHEN vaa.vendas_ano_anterior IS NOT NULL AND vaa.vendas_ano_anterior <> 0 THEN             ROUND(((vaa.vendas_ano_atual - vaa.vendas_ano_anterior) / vaa.vendas_ano_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasAnoAnterior vaa JOIN `CategoriaProduto` c ON vaa.`idCategoria` = c.`idCategoria` WHERE vaa.vendas_ano_anterior IS NOT NULL ORDER BY c.`nomeCategoria`, vaa.ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacao_percentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacao_percentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH VendasAno AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtde_vendas     FROM `PedidoVenda` pv     JOIN `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VendasComparadas AS (     SELECT          v2021.`idMarketPlace`,         v2021.`nomeMarketPlace`,         v2021.qtde_vendas AS vendas_2021,         v2020.qtde_vendas AS vendas_2020,         CASE              WHEN v2020.qtde_vendas = 0 THEN NULL             ELSE ((v2021.qtde_vendas - v2020.qtde_vendas) * 100.0 / v2020.qtde_vendas)         END AS variacao_percentual     FROM VendasAno v2021     JOIN VendasAno v2020          ON v2021.`idMarketPlace` = v2020.`idMarketPlace`     WHERE v2021.ano = 2021 AND v2020.ano = 2020 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM VendasComparadas WHERE variacao_percentual = (SELECT MAX(variacao_percentual) FROM VendasComparadas);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida)      FROM ItensPedidoVenda iv2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_pedido_cliente > media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS quantidade_vendida FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      quantidade_vendida DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS posicao     FROM VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.posicao <= 10 ORDER BY rv.ano, rv.posicao;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ip.`qtdePedida` * ip.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     JOIN `Produto` p ON ip.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), VendasAnoAnterior AS (     SELECT          va1.`idCategoria`,         va1.ano,         va1.total_vendas AS vendas_ano_atual,         LAG(va1.total_vendas) OVER (PARTITION BY va1.`idCategoria` ORDER BY va1.ano) AS vendas_ano_anterior     FROM VendasAno va1 ) SELECT      c.`nomeCategoria`,     vaa.ano,     CASE          WHEN vaa.vendas_ano_anterior IS NOT NULL AND vaa.vendas_ano_anterior <> 0 THEN             ROUND(((vaa.vendas_ano_atual - vaa.vendas_ano_anterior) / vaa.vendas_ano_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasAnoAnterior vaa JOIN `CategoriaProduto` c ON vaa.`idCategoria` = c.`idCategoria` WHERE vaa.vendas_ano_anterior IS NOT NULL ORDER BY c.`nomeCategoria`, vaa.ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacao_percentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacao_percentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH VendasAno AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtde_vendas     FROM `PedidoVenda` pv     JOIN `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VendasComparadas AS (     SELECT          v2021.`idMarketPlace`,         v2021.`nomeMarketPlace`,         v2021.qtde_vendas AS vendas_2021,         v2020.qtde_vendas AS vendas_2020,         CASE              WHEN v2020.qtde_vendas = 0 THEN NULL             ELSE ((v2021.qtde_vendas - v2020.qtde_vendas) * 100.0 / v2020.qtde_vendas)         END AS variacao_percentual     FROM VendasAno v2021     JOIN VendasAno v2020          ON v2021.`idMarketPlace` = v2020.`idMarketPlace`     WHERE v2021.ano = 2021 AND v2020.ano = 2020 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM VendasComparadas WHERE variacao_percentual = (SELECT MAX(variacao_percentual) FROM VendasComparadas);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida)      FROM ItensPedidoVenda iv2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_pedido_cliente > media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS quantidade_vendida FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      quantidade_vendida DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS posicao     FROM VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.posicao <= 10 ORDER BY rv.ano, rv.posicao;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ip.`qtdePedida` * ip.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     JOIN `Produto` p ON ip.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), VendasAnoAnterior AS (     SELECT          va1.`idCategoria`,         va1.ano,         va1.total_vendas AS vendas_ano_atual,         LAG(va1.total_vendas) OVER (PARTITION BY va1.`idCategoria` ORDER BY va1.ano) AS vendas_ano_anterior     FROM VendasAno va1 ) SELECT      c.`nomeCategoria`,     vaa.ano,     CASE          WHEN vaa.vendas_ano_anterior IS NOT NULL AND vaa.vendas_ano_anterior <> 0 THEN             ROUND(((vaa.vendas_ano_atual - vaa.vendas_ano_anterior) / vaa.vendas_ano_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasAnoAnterior vaa JOIN `CategoriaProduto` c ON vaa.`idCategoria` = c.`idCategoria` WHERE vaa.vendas_ano_anterior IS NOT NULL ORDER BY c.`nomeCategoria`, vaa.ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacao_percentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacao_percentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH VendasAno AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtde_vendas     FROM `PedidoVenda` pv     JOIN `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VendasComparadas AS (     SELECT          v2021.`idMarketPlace`,         v2021.`nomeMarketPlace`,         v2021.qtde_vendas AS vendas_2021,         v2020.qtde_vendas AS vendas_2020,         CASE              WHEN v2020.qtde_vendas = 0 THEN NULL             ELSE ((v2021.qtde_vendas - v2020.qtde_vendas) * 100.0 / v2020.qtde_vendas)         END AS variacao_percentual     FROM VendasAno v2021     JOIN VendasAno v2020          ON v2021.`idMarketPlace` = v2020.`idMarketPlace`     WHERE v2021.ano = 2021 AND v2020.ano = 2020 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM VendasComparadas WHERE variacao_percentual = (SELECT MAX(variacao_percentual) FROM VendasComparadas);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida)      FROM ItensPedidoVenda iv2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_pedido_cliente > media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS quantidade_vendida FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      quantidade_vendida DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS posicao     FROM VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.posicao <= 10 ORDER BY rv.ano, rv.posicao;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ip.`qtdePedida` * ip.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     JOIN `Produto` p ON ip.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), VendasAnoAnterior AS (     SELECT          va1.`idCategoria`,         va1.ano,         va1.total_vendas AS vendas_ano_atual,         LAG(va1.total_vendas) OVER (PARTITION BY va1.`idCategoria` ORDER BY va1.ano) AS vendas_ano_anterior     FROM VendasAno va1 ) SELECT      c.`nomeCategoria`,     vaa.ano,     CASE          WHEN vaa.vendas_ano_anterior IS NOT NULL AND vaa.vendas_ano_anterior <> 0 THEN             ROUND(((vaa.vendas_ano_atual - vaa.vendas_ano_anterior) / vaa.vendas_ano_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasAnoAnterior vaa JOIN `CategoriaProduto` c ON vaa.`idCategoria` = c.`idCategoria` WHERE vaa.vendas_ano_anterior IS NOT NULL ORDER BY c.`nomeCategoria`, vaa.ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacao_percentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacao_percentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH VendasAno AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtde_vendas     FROM `PedidoVenda` pv     JOIN `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VendasComparadas AS (     SELECT          v2021.`idMarketPlace`,         v2021.`nomeMarketPlace`,         v2021.qtde_vendas AS vendas_2021,         v2020.qtde_vendas AS vendas_2020,         CASE              WHEN v2020.qtde_vendas = 0 THEN NULL             ELSE ((v2021.qtde_vendas - v2020.qtde_vendas) * 100.0 / v2020.qtde_vendas)         END AS variacao_percentual     FROM VendasAno v2021     JOIN VendasAno v2020          ON v2021.`idMarketPlace` = v2020.`idMarketPlace`     WHERE v2021.ano = 2021 AND v2020.ano = 2020 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM VendasComparadas WHERE variacao_percentual = (SELECT MAX(variacao_percentual) FROM VendasComparadas);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida)      FROM ItensPedidoVenda iv2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_pedido_cliente > media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`), DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankClientes AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS posicao     FROM          VendasAnuais ) SELECT      idCliente,     ano,     valorTotalVendas FROM      RankClientes WHERE      posicao <= 10 ORDER BY      ano, valorTotalVendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasAnoAnterior AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS valor_vendas_anterior     FROM VendasAno ) SELECT      grupo_produto,     ano,     ROUND(         ((valor_vendas - valor_vendas_anterior) / valor_vendas_anterior) * 100,          2     ) AS variacao_percentual FROM VendasAnoAnterior WHERE valor_vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          cm1.`idMarketPlace`,         cm1.`nomeMarketPlace`,         cm1.qtdePedidos AS pedidos_2020,         cm2.qtdePedidos AS pedidos_2021,         CASE              WHEN cm1.qtdePedidos = 0 THEN NULL             ELSE ((cm2.qtdePedidos - cm1.qtdePedidos) * 100.0 / cm1.qtdePedidos)         END AS variacao_percentual     FROM          CrescimentoMarketPlace cm1     JOIN          CrescimentoMarketPlace cm2          ON cm1.`idMarketPlace` = cm2.`idMarketPlace`     WHERE          cm1.ano = 2020 AND cm2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaPorCliente AS (     SELECT          pv.`idCliente`,         AVG(ip.`precoVendido` * ip.`qtdePedida`) AS media_cliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(ip.`precoVendido` * ip.`qtdePedida`) AS media_geral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido` ) SELECT      mc.`idCliente`,     mc.media_cliente FROM      MediaPorCliente mc CROSS JOIN      MediaGeral mg WHERE      mc.media_cliente > mg.media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`), DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankClientes AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS posicao     FROM          VendasAnuais ) SELECT      idCliente,     ano,     valorTotalVendas FROM      RankClientes WHERE      posicao <= 10 ORDER BY      ano, valorTotalVendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasAnoAnterior AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS valor_vendas_anterior     FROM VendasAno ) SELECT      grupo_produto,     ano,     ROUND(         ((valor_vendas - valor_vendas_anterior) / valor_vendas_anterior) * 100,          2     ) AS variacao_percentual FROM VendasAnoAnterior WHERE valor_vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          cm1.`idMarketPlace`,         cm1.`nomeMarketPlace`,         cm1.qtdePedidos AS pedidos_2020,         cm2.qtdePedidos AS pedidos_2021,         CASE              WHEN cm1.qtdePedidos = 0 THEN NULL             ELSE ((cm2.qtdePedidos - cm1.qtdePedidos) * 100.0 / cm1.qtdePedidos)         END AS variacao_percentual     FROM          CrescimentoMarketPlace cm1     JOIN          CrescimentoMarketPlace cm2          ON cm1.`idMarketPlace` = cm2.`idMarketPlace`     WHERE          cm1.ano = 2020 AND cm2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaPorCliente AS (     SELECT          pv.`idCliente`,         AVG(ip.`precoVendido` * ip.`qtdePedida`) AS media_cliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(ip.`precoVendido` * ip.`qtdePedida`) AS media_geral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido` ) SELECT      mc.`idCliente`,     mc.media_cliente FROM      MediaPorCliente mc CROSS JOIN      MediaGeral mg WHERE      mc.media_cliente > mg.media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`), DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankClientes AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS posicao     FROM          VendasAnuais ) SELECT      idCliente,     ano,     valorTotalVendas FROM      RankClientes WHERE      posicao <= 10 ORDER BY      ano, valorTotalVendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasAnoAnterior AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS valor_vendas_anterior     FROM VendasAno ) SELECT      grupo_produto,     ano,     ROUND(         ((valor_vendas - valor_vendas_anterior) / valor_vendas_anterior) * 100,          2     ) AS variacao_percentual FROM VendasAnoAnterior WHERE valor_vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          cm1.`idMarketPlace`,         cm1.`nomeMarketPlace`,         cm1.qtdePedidos AS pedidos_2020,         cm2.qtdePedidos AS pedidos_2021,         CASE              WHEN cm1.qtdePedidos = 0 THEN NULL             ELSE ((cm2.qtdePedidos - cm1.qtdePedidos) * 100.0 / cm1.qtdePedidos)         END AS variacao_percentual     FROM          CrescimentoMarketPlace cm1     JOIN          CrescimentoMarketPlace cm2          ON cm1.`idMarketPlace` = cm2.`idMarketPlace`     WHERE          cm1.ano = 2020 AND cm2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaPorCliente AS (     SELECT          pv.`idCliente`,         AVG(ip.`precoVendido` * ip.`qtdePedida`) AS media_cliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(ip.`precoVendido` * ip.`qtdePedida`) AS media_geral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido` ) SELECT      mc.`idCliente`,     mc.media_cliente FROM      MediaPorCliente mc CROSS JOIN      MediaGeral mg WHERE      mc.media_cliente > mg.media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`), DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankClientes AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS posicao     FROM          VendasAnuais ) SELECT      idCliente,     ano,     valorTotalVendas FROM      RankClientes WHERE      posicao <= 10 ORDER BY      ano, valorTotalVendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasAnoAnterior AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS valor_vendas_anterior     FROM VendasAno ) SELECT      grupo_produto,     ano,     ROUND(         ((valor_vendas - valor_vendas_anterior) / valor_vendas_anterior) * 100,          2     ) AS variacao_percentual FROM VendasAnoAnterior WHERE valor_vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          cm1.`idMarketPlace`,         cm1.`nomeMarketPlace`,         cm1.qtdePedidos AS pedidos_2020,         cm2.qtdePedidos AS pedidos_2021,         CASE              WHEN cm1.qtdePedidos = 0 THEN NULL             ELSE ((cm2.qtdePedidos - cm1.qtdePedidos) * 100.0 / cm1.qtdePedidos)         END AS variacao_percentual     FROM          CrescimentoMarketPlace cm1     JOIN          CrescimentoMarketPlace cm2          ON cm1.`idMarketPlace` = cm2.`idMarketPlace`     WHERE          cm1.ano = 2020 AND cm2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaPorCliente AS (     SELECT          pv.`idCliente`,         AVG(ip.`precoVendido` * ip.`qtdePedida`) AS media_cliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(ip.`precoVendido` * ip.`qtdePedida`) AS media_geral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido` ) SELECT      mc.`idCliente`,     mc.media_cliente FROM      MediaPorCliente mc CROSS JOIN      MediaGeral mg WHERE      mc.media_cliente > mg.media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`), DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankClientes AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS posicao     FROM          VendasAnuais ) SELECT      idCliente,     ano,     valorTotalVendas FROM      RankClientes WHERE      posicao <= 10 ORDER BY      ano, valorTotalVendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasAnoAnterior AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS valor_vendas_anterior     FROM VendasAno ) SELECT      grupo_produto,     ano,     ROUND(         ((valor_vendas - valor_vendas_anterior) / valor_vendas_anterior) * 100,          2     ) AS variacao_percentual FROM VendasAnoAnterior WHERE valor_vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          cm1.`idMarketPlace`,         cm1.`nomeMarketPlace`,         cm1.qtdePedidos AS pedidos_2020,         cm2.qtdePedidos AS pedidos_2021,         CASE              WHEN cm1.qtdePedidos = 0 THEN NULL             ELSE ((cm2.qtdePedidos - cm1.qtdePedidos) * 100.0 / cm1.qtdePedidos)         END AS variacao_percentual     FROM          CrescimentoMarketPlace cm1     JOIN          CrescimentoMarketPlace cm2          ON cm1.`idMarketPlace` = cm2.`idMarketPlace`     WHERE          cm1.ano = 2020 AND cm2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaPorCliente AS (     SELECT          pv.`idCliente`,         AVG(ip.`precoVendido` * ip.`qtdePedida`) AS media_cliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(ip.`precoVendido` * ip.`qtdePedida`) AS media_geral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido` ) SELECT      mc.`idCliente`,     mc.media_cliente FROM      MediaPorCliente mc CROSS JOIN      MediaGeral mg WHERE      mc.media_cliente > mg.media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`), DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankClientes AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS posicao     FROM          VendasAnuais ) SELECT      idCliente,     ano,     valorTotalVendas FROM      RankClientes WHERE      posicao <= 10 ORDER BY      ano, valorTotalVendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasAnoAnterior AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS valor_vendas_anterior     FROM VendasAno ) SELECT      grupo_produto,     ano,     ROUND(         ((valor_vendas - valor_vendas_anterior) / valor_vendas_anterior) * 100,          2     ) AS variacao_percentual FROM VendasAnoAnterior WHERE valor_vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          cm1.`idMarketPlace`,         cm1.`nomeMarketPlace`,         cm1.qtdePedidos AS pedidos_2020,         cm2.qtdePedidos AS pedidos_2021,         CASE              WHEN cm1.qtdePedidos = 0 THEN NULL             ELSE ((cm2.qtdePedidos - cm1.qtdePedidos) * 100.0 / cm1.qtdePedidos)         END AS variacao_percentual     FROM          CrescimentoMarketPlace cm1     JOIN          CrescimentoMarketPlace cm2          ON cm1.`idMarketPlace` = cm2.`idMarketPlace`     WHERE          cm1.ano = 2020 AND cm2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaPorCliente AS (     SELECT          pv.`idCliente`,         AVG(ip.`precoVendido` * ip.`qtdePedida`) AS media_cliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(ip.`precoVendido` * ip.`qtdePedida`) AS media_geral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido` ) SELECT      mc.`idCliente`,     mc.media_cliente FROM      MediaPorCliente mc CROSS JOIN      MediaGeral mg WHERE      mc.media_cliente > mg.media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`), DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankClientes AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS posicao     FROM          VendasAnuais ) SELECT      idCliente,     ano,     valorTotalVendas FROM      RankClientes WHERE      posicao <= 10 ORDER BY      ano, valorTotalVendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasAnoAnterior AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS valor_vendas_anterior     FROM VendasAno ) SELECT      grupo_produto,     ano,     ROUND(         ((valor_vendas - valor_vendas_anterior) / valor_vendas_anterior) * 100,          2     ) AS variacao_percentual FROM VendasAnoAnterior WHERE valor_vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          cm1.`idMarketPlace`,         cm1.`nomeMarketPlace`,         cm1.qtdePedidos AS pedidos_2020,         cm2.qtdePedidos AS pedidos_2021,         CASE              WHEN cm1.qtdePedidos = 0 THEN NULL             ELSE ((cm2.qtdePedidos - cm1.qtdePedidos) * 100.0 / cm1.qtdePedidos)         END AS variacao_percentual     FROM          CrescimentoMarketPlace cm1     JOIN          CrescimentoMarketPlace cm2          ON cm1.`idMarketPlace` = cm2.`idMarketPlace`     WHERE          cm1.ano = 2020 AND cm2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaPorCliente AS (     SELECT          pv.`idCliente`,         AVG(ip.`precoVendido` * ip.`qtdePedida`) AS media_cliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(ip.`precoVendido` * ip.`qtdePedida`) AS media_geral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido` ) SELECT      mc.`idCliente`,     mc.media_cliente FROM      MediaPorCliente mc CROSS JOIN      MediaGeral mg WHERE      mc.media_cliente > mg.media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`), DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankClientes AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS posicao     FROM          VendasAnuais ) SELECT      idCliente,     ano,     valorTotalVendas FROM      RankClientes WHERE      posicao <= 10 ORDER BY      ano, valorTotalVendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasAnoAnterior AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS valor_vendas_anterior     FROM VendasAno ) SELECT      grupo_produto,     ano,     ROUND(         ((valor_vendas - valor_vendas_anterior) / valor_vendas_anterior) * 100,          2     ) AS variacao_percentual FROM VendasAnoAnterior WHERE valor_vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          cm1.`idMarketPlace`,         cm1.`nomeMarketPlace`,         cm1.qtdePedidos AS pedidos_2020,         cm2.qtdePedidos AS pedidos_2021,         CASE              WHEN cm1.qtdePedidos = 0 THEN NULL             ELSE ((cm2.qtdePedidos - cm1.qtdePedidos) * 100.0 / cm1.qtdePedidos)         END AS variacao_percentual     FROM          CrescimentoMarketPlace cm1     JOIN          CrescimentoMarketPlace cm2          ON cm1.`idMarketPlace` = cm2.`idMarketPlace`     WHERE          cm1.ano = 2020 AND cm2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaPorCliente AS (     SELECT          pv.`idCliente`,         AVG(ip.`precoVendido` * ip.`qtdePedida`) AS media_cliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(ip.`precoVendido` * ip.`qtdePedida`) AS media_geral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido` ) SELECT      mc.`idCliente`,     mc.media_cliente FROM      MediaPorCliente mc CROSS JOIN      MediaGeral mg WHERE      mc.media_cliente > mg.media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`), DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankClientes AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS posicao     FROM          VendasAnuais ) SELECT      idCliente,     ano,     valorTotalVendas FROM      RankClientes WHERE      posicao <= 10 ORDER BY      ano, valorTotalVendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasAnoAnterior AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS valor_vendas_anterior     FROM VendasAno ) SELECT      grupo_produto,     ano,     ROUND(         ((valor_vendas - valor_vendas_anterior) / valor_vendas_anterior) * 100,          2     ) AS variacao_percentual FROM VendasAnoAnterior WHERE valor_vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          cm1.`idMarketPlace`,         cm1.`nomeMarketPlace`,         cm1.qtdePedidos AS pedidos_2020,         cm2.qtdePedidos AS pedidos_2021,         CASE              WHEN cm1.qtdePedidos = 0 THEN NULL             ELSE ((cm2.qtdePedidos - cm1.qtdePedidos) * 100.0 / cm1.qtdePedidos)         END AS variacao_percentual     FROM          CrescimentoMarketPlace cm1     JOIN          CrescimentoMarketPlace cm2          ON cm1.`idMarketPlace` = cm2.`idMarketPlace`     WHERE          cm1.ano = 2020 AND cm2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaPorCliente AS (     SELECT          pv.`idCliente`,         AVG(ip.`precoVendido` * ip.`qtdePedida`) AS media_cliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(ip.`precoVendido` * ip.`qtdePedida`) AS media_geral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido` ) SELECT      mc.`idCliente`,     mc.media_cliente FROM      MediaPorCliente mc CROSS JOIN      MediaGeral mg WHERE      mc.media_cliente > mg.media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`), DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankClientes AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS posicao     FROM          VendasAnuais ) SELECT      idCliente,     ano,     valorTotalVendas FROM      RankClientes WHERE      posicao <= 10 ORDER BY      ano, valorTotalVendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasAnoAnterior AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS valor_vendas_anterior     FROM VendasAno ) SELECT      grupo_produto,     ano,     ROUND(         ((valor_vendas - valor_vendas_anterior) / valor_vendas_anterior) * 100,          2     ) AS variacao_percentual FROM VendasAnoAnterior WHERE valor_vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          cm1.`idMarketPlace`,         cm1.`nomeMarketPlace`,         cm1.qtdePedidos AS pedidos_2020,         cm2.qtdePedidos AS pedidos_2021,         CASE              WHEN cm1.qtdePedidos = 0 THEN NULL             ELSE ((cm2.qtdePedidos - cm1.qtdePedidos) * 100.0 / cm1.qtdePedidos)         END AS variacao_percentual     FROM          CrescimentoMarketPlace cm1     JOIN          CrescimentoMarketPlace cm2          ON cm1.`idMarketPlace` = cm2.`idMarketPlace`     WHERE          cm1.ano = 2020 AND cm2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaPorCliente AS (     SELECT          pv.`idCliente`,         AVG(ip.`precoVendido` * ip.`qtdePedida`) AS media_cliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(ip.`precoVendido` * ip.`qtdePedida`) AS media_geral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido` ) SELECT      mc.`idCliente`,     mc.media_cliente FROM      MediaPorCliente mc CROSS JOIN      MediaGeral mg WHERE      mc.media_cliente > mg.media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`), DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankClientes AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS posicao     FROM          VendasAnuais ) SELECT      idCliente,     ano,     valorTotalVendas FROM      RankClientes WHERE      posicao <= 10 ORDER BY      ano, valorTotalVendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasAnoAnterior AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS valor_vendas_anterior     FROM VendasAno ) SELECT      grupo_produto,     ano,     ROUND(         ((valor_vendas - valor_vendas_anterior) / valor_vendas_anterior) * 100,          2     ) AS variacao_percentual FROM VendasAnoAnterior WHERE valor_vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          cm1.`idMarketPlace`,         cm1.`nomeMarketPlace`,         cm1.qtdePedidos AS pedidos_2020,         cm2.qtdePedidos AS pedidos_2021,         CASE              WHEN cm1.qtdePedidos = 0 THEN NULL             ELSE ((cm2.qtdePedidos - cm1.qtdePedidos) * 100.0 / cm1.qtdePedidos)         END AS variacao_percentual     FROM          CrescimentoMarketPlace cm1     JOIN          CrescimentoMarketPlace cm2          ON cm1.`idMarketPlace` = cm2.`idMarketPlace`     WHERE          cm1.ano = 2020 AND cm2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaPorCliente AS (     SELECT          pv.`idCliente`,         AVG(ip.`precoVendido` * ip.`qtdePedida`) AS media_cliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(ip.`precoVendido` * ip.`qtdePedida`) AS media_geral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido` ) SELECT      mc.`idCliente`,     mc.media_cliente FROM      MediaPorCliente mc CROSS JOIN      MediaGeral mg WHERE      mc.media_cliente > mg.media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`), DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankClientes AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS posicao     FROM          VendasAnuais ) SELECT      idCliente,     ano,     valorTotalVendas FROM      RankClientes WHERE      posicao <= 10 ORDER BY      ano, valorTotalVendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasAnoAnterior AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS valor_vendas_anterior     FROM VendasAno ) SELECT      grupo_produto,     ano,     ROUND(         ((valor_vendas - valor_vendas_anterior) / valor_vendas_anterior) * 100,          2     ) AS variacao_percentual FROM VendasAnoAnterior WHERE valor_vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          cm1.`idMarketPlace`,         cm1.`nomeMarketPlace`,         cm1.qtdePedidos AS pedidos_2020,         cm2.qtdePedidos AS pedidos_2021,         CASE              WHEN cm1.qtdePedidos = 0 THEN NULL             ELSE ((cm2.qtdePedidos - cm1.qtdePedidos) * 100.0 / cm1.qtdePedidos)         END AS variacao_percentual     FROM          CrescimentoMarketPlace cm1     JOIN          CrescimentoMarketPlace cm2          ON cm1.`idMarketPlace` = cm2.`idMarketPlace`     WHERE          cm1.ano = 2020 AND cm2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaPorCliente AS (     SELECT          pv.`idCliente`,         AVG(ip.`precoVendido` * ip.`qtdePedida`) AS media_cliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(ip.`precoVendido` * ip.`qtdePedida`) AS media_geral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido` ) SELECT      mc.`idCliente`,     mc.media_cliente FROM      MediaPorCliente mc CROSS JOIN      MediaGeral mg WHERE      mc.media_cliente > mg.media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`), DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankClientes AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS posicao     FROM          VendasAnuais ) SELECT      idCliente,     ano,     valorTotalVendas FROM      RankClientes WHERE      posicao <= 10 ORDER BY      ano, valorTotalVendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasAnoAnterior AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS valor_vendas_anterior     FROM VendasAno ) SELECT      grupo_produto,     ano,     ROUND(         ((valor_vendas - valor_vendas_anterior) / valor_vendas_anterior) * 100,          2     ) AS variacao_percentual FROM VendasAnoAnterior WHERE valor_vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          cm1.`idMarketPlace`,         cm1.`nomeMarketPlace`,         cm1.qtdePedidos AS pedidos_2020,         cm2.qtdePedidos AS pedidos_2021,         CASE              WHEN cm1.qtdePedidos = 0 THEN NULL             ELSE ((cm2.qtdePedidos - cm1.qtdePedidos) * 100.0 / cm1.qtdePedidos)         END AS variacao_percentual     FROM          CrescimentoMarketPlace cm1     JOIN          CrescimentoMarketPlace cm2          ON cm1.`idMarketPlace` = cm2.`idMarketPlace`     WHERE          cm1.ano = 2020 AND cm2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaPorCliente AS (     SELECT          pv.`idCliente`,         AVG(ip.`precoVendido` * ip.`qtdePedida`) AS media_cliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(ip.`precoVendido` * ip.`qtdePedida`) AS media_geral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido` ) SELECT      mc.`idCliente`,     mc.media_cliente FROM      MediaPorCliente mc CROSS JOIN      MediaGeral mg WHERE      mc.media_cliente > mg.media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`), DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankClientes AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS posicao     FROM          VendasAnuais ) SELECT      idCliente,     ano,     valorTotalVendas FROM      RankClientes WHERE      posicao <= 10 ORDER BY      ano, valorTotalVendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasAnoAnterior AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS valor_vendas_anterior     FROM VendasAno ) SELECT      grupo_produto,     ano,     ROUND(         ((valor_vendas - valor_vendas_anterior) / valor_vendas_anterior) * 100,          2     ) AS variacao_percentual FROM VendasAnoAnterior WHERE valor_vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          cm1.`idMarketPlace`,         cm1.`nomeMarketPlace`,         cm1.qtdePedidos AS pedidos_2020,         cm2.qtdePedidos AS pedidos_2021,         CASE              WHEN cm1.qtdePedidos = 0 THEN NULL             ELSE ((cm2.qtdePedidos - cm1.qtdePedidos) * 100.0 / cm1.qtdePedidos)         END AS variacao_percentual     FROM          CrescimentoMarketPlace cm1     JOIN          CrescimentoMarketPlace cm2          ON cm1.`idMarketPlace` = cm2.`idMarketPlace`     WHERE          cm1.ano = 2020 AND cm2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaPorCliente AS (     SELECT          pv.`idCliente`,         AVG(ip.`precoVendido` * ip.`qtdePedida`) AS media_cliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(ip.`precoVendido` * ip.`qtdePedida`) AS media_geral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido` ) SELECT      mc.`idCliente`,     mc.media_cliente FROM      MediaPorCliente mc CROSS JOIN      MediaGeral mg WHERE      mc.media_cliente > mg.media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`), DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankClientes AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS posicao     FROM          VendasAnuais ) SELECT      idCliente,     ano,     valorTotalVendas FROM      RankClientes WHERE      posicao <= 10 ORDER BY      ano, valorTotalVendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasAnoAnterior AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS valor_vendas_anterior     FROM VendasAno ) SELECT      grupo_produto,     ano,     ROUND(         ((valor_vendas - valor_vendas_anterior) / valor_vendas_anterior) * 100,          2     ) AS variacao_percentual FROM VendasAnoAnterior WHERE valor_vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          cm1.`idMarketPlace`,         cm1.`nomeMarketPlace`,         cm1.qtdePedidos AS pedidos_2020,         cm2.qtdePedidos AS pedidos_2021,         CASE              WHEN cm1.qtdePedidos = 0 THEN NULL             ELSE ((cm2.qtdePedidos - cm1.qtdePedidos) * 100.0 / cm1.qtdePedidos)         END AS variacao_percentual     FROM          CrescimentoMarketPlace cm1     JOIN          CrescimentoMarketPlace cm2          ON cm1.`idMarketPlace` = cm2.`idMarketPlace`     WHERE          cm1.ano = 2020 AND cm2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaPorCliente AS (     SELECT          pv.`idCliente`,         AVG(ip.`precoVendido` * ip.`qtdePedida`) AS media_cliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(ip.`precoVendido` * ip.`qtdePedida`) AS media_geral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido` ) SELECT      mc.`idCliente`,     mc.media_cliente FROM      MediaPorCliente mc CROSS JOIN      MediaGeral mg WHERE      mc.media_cliente > mg.media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`), DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankClientes AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS posicao     FROM          VendasAnuais ) SELECT      idCliente,     ano,     valorTotalVendas FROM      RankClientes WHERE      posicao <= 10 ORDER BY      ano, valorTotalVendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasAnoAnterior AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS valor_vendas_anterior     FROM VendasAno ) SELECT      grupo_produto,     ano,     ROUND(         ((valor_vendas - valor_vendas_anterior) / valor_vendas_anterior) * 100,          2     ) AS variacao_percentual FROM VendasAnoAnterior WHERE valor_vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          cm1.`idMarketPlace`,         cm1.`nomeMarketPlace`,         cm1.qtdePedidos AS pedidos_2020,         cm2.qtdePedidos AS pedidos_2021,         CASE              WHEN cm1.qtdePedidos = 0 THEN NULL             ELSE ((cm2.qtdePedidos - cm1.qtdePedidos) * 100.0 / cm1.qtdePedidos)         END AS variacao_percentual     FROM          CrescimentoMarketPlace cm1     JOIN          CrescimentoMarketPlace cm2          ON cm1.`idMarketPlace` = cm2.`idMarketPlace`     WHERE          cm1.ano = 2020 AND cm2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaPorCliente AS (     SELECT          pv.`idCliente`,         AVG(ip.`precoVendido` * ip.`qtdePedida`) AS media_cliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(ip.`precoVendido` * ip.`qtdePedida`) AS media_geral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido` ) SELECT      mc.`idCliente`,     mc.media_cliente FROM      MediaPorCliente mc CROSS JOIN      MediaGeral mg WHERE      mc.media_cliente > mg.media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`), DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankClientes AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS posicao     FROM          VendasAnuais ) SELECT      idCliente,     ano,     valorTotalVendas FROM      RankClientes WHERE      posicao <= 10 ORDER BY      ano, valorTotalVendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasAnoAnterior AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS valor_vendas_anterior     FROM VendasAno ) SELECT      grupo_produto,     ano,     ROUND(         ((valor_vendas - valor_vendas_anterior) / valor_vendas_anterior) * 100,          2     ) AS variacao_percentual FROM VendasAnoAnterior WHERE valor_vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          cm1.`idMarketPlace`,         cm1.`nomeMarketPlace`,         cm1.qtdePedidos AS pedidos_2020,         cm2.qtdePedidos AS pedidos_2021,         CASE              WHEN cm1.qtdePedidos = 0 THEN NULL             ELSE ((cm2.qtdePedidos - cm1.qtdePedidos) * 100.0 / cm1.qtdePedidos)         END AS variacao_percentual     FROM          CrescimentoMarketPlace cm1     JOIN          CrescimentoMarketPlace cm2          ON cm1.`idMarketPlace` = cm2.`idMarketPlace`     WHERE          cm1.ano = 2020 AND cm2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaPorCliente AS (     SELECT          pv.`idCliente`,         AVG(ip.`precoVendido` * ip.`qtdePedida`) AS media_cliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(ip.`precoVendido` * ip.`qtdePedida`) AS media_geral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido` ) SELECT      mc.`idCliente`,     mc.media_cliente FROM      MediaPorCliente mc CROSS JOIN      MediaGeral mg WHERE      mc.media_cliente > mg.media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`), DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankClientes AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS posicao     FROM          VendasAnuais ) SELECT      idCliente,     ano,     valorTotalVendas FROM      RankClientes WHERE      posicao <= 10 ORDER BY      ano, valorTotalVendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasAnoAnterior AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS valor_vendas_anterior     FROM VendasAno ) SELECT      grupo_produto,     ano,     ROUND(         ((valor_vendas - valor_vendas_anterior) / valor_vendas_anterior) * 100,          2     ) AS variacao_percentual FROM VendasAnoAnterior WHERE valor_vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          cm1.`idMarketPlace`,         cm1.`nomeMarketPlace`,         cm1.qtdePedidos AS pedidos_2020,         cm2.qtdePedidos AS pedidos_2021,         CASE              WHEN cm1.qtdePedidos = 0 THEN NULL             ELSE ((cm2.qtdePedidos - cm1.qtdePedidos) * 100.0 / cm1.qtdePedidos)         END AS variacao_percentual     FROM          CrescimentoMarketPlace cm1     JOIN          CrescimentoMarketPlace cm2          ON cm1.`idMarketPlace` = cm2.`idMarketPlace`     WHERE          cm1.ano = 2020 AND cm2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaPorCliente AS (     SELECT          pv.`idCliente`,         AVG(ip.`precoVendido` * ip.`qtdePedida`) AS media_cliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(ip.`precoVendido` * ip.`qtdePedida`) AS media_geral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido` ) SELECT      mc.`idCliente`,     mc.media_cliente FROM      MediaPorCliente mc CROSS JOIN      MediaGeral mg WHERE      mc.media_cliente > mg.media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`), DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankClientes AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS posicao     FROM          VendasAnuais ) SELECT      idCliente,     ano,     valorTotalVendas FROM      RankClientes WHERE      posicao <= 10 ORDER BY      ano, valorTotalVendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasAnoAnterior AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS valor_vendas_anterior     FROM VendasAno ) SELECT      grupo_produto,     ano,     ROUND(         ((valor_vendas - valor_vendas_anterior) / valor_vendas_anterior) * 100,          2     ) AS variacao_percentual FROM VendasAnoAnterior WHERE valor_vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          cm1.`idMarketPlace`,         cm1.`nomeMarketPlace`,         cm1.qtdePedidos AS pedidos_2020,         cm2.qtdePedidos AS pedidos_2021,         CASE              WHEN cm1.qtdePedidos = 0 THEN NULL             ELSE ((cm2.qtdePedidos - cm1.qtdePedidos) * 100.0 / cm1.qtdePedidos)         END AS variacao_percentual     FROM          CrescimentoMarketPlace cm1     JOIN          CrescimentoMarketPlace cm2          ON cm1.`idMarketPlace` = cm2.`idMarketPlace`     WHERE          cm1.ano = 2020 AND cm2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaPorCliente AS (     SELECT          pv.`idCliente`,         AVG(ip.`precoVendido` * ip.`qtdePedida`) AS media_cliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(ip.`precoVendido` * ip.`qtdePedida`) AS media_geral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido` ) SELECT      mc.`idCliente`,     mc.media_cliente FROM      MediaPorCliente mc CROSS JOIN      MediaGeral mg WHERE      mc.media_cliente > mg.media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),      DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankClientes AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS `rank`     FROM VendasAnuais ) SELECT      idCliente,     ano,     valorTotalVendas FROM RankClientes WHERE `rank` <= 10 ORDER BY ano, `rank`;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComAnoAnterior AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_ano_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     CASE          WHEN vendas_ano_anterior IS NOT NULL AND vendas_ano_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_ano_anterior) / vendas_ano_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComAnoAnterior WHERE vendas_ano_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdePedidos AS pedidos_2020,         c2.qtdePedidos AS pedidos_2021,         CASE              WHEN c1.qtdePedidos = 0 THEN NULL             ELSE ROUND(((c2.qtdePedidos - c1.qtdePedidos) * 100.0 / c1.qtdePedidos), 2)         END AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual)"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida) FROM ItensPedidoVenda iv2) AS media_geral FROM      Cliente c JOIN      PedidoVenda pv ON c.idCliente = pv.idCliente JOIN      ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY      c.idCliente, c.nomeCliente HAVING      media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),      DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankClientes AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS `rank`     FROM VendasAnuais ) SELECT      idCliente,     ano,     valorTotalVendas FROM RankClientes WHERE `rank` <= 10 ORDER BY ano, `rank`;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComAnoAnterior AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_ano_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     CASE          WHEN vendas_ano_anterior IS NOT NULL AND vendas_ano_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_ano_anterior) / vendas_ano_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComAnoAnterior WHERE vendas_ano_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdePedidos AS pedidos_2020,         c2.qtdePedidos AS pedidos_2021,         CASE              WHEN c1.qtdePedidos = 0 THEN NULL             ELSE ROUND(((c2.qtdePedidos - c1.qtdePedidos) * 100.0 / c1.qtdePedidos), 2)         END AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual)"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida) FROM ItensPedidoVenda iv2) AS media_geral FROM      Cliente c JOIN      PedidoVenda pv ON c.idCliente = pv.idCliente JOIN      ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY      c.idCliente, c.nomeCliente HAVING      media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),      DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankClientes AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS `rank`     FROM VendasAnuais ) SELECT      idCliente,     ano,     valorTotalVendas FROM RankClientes WHERE `rank` <= 10 ORDER BY ano, `rank`;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComAnoAnterior AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_ano_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     CASE          WHEN vendas_ano_anterior IS NOT NULL AND vendas_ano_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_ano_anterior) / vendas_ano_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComAnoAnterior WHERE vendas_ano_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdePedidos AS pedidos_2020,         c2.qtdePedidos AS pedidos_2021,         CASE              WHEN c1.qtdePedidos = 0 THEN NULL             ELSE ROUND(((c2.qtdePedidos - c1.qtdePedidos) * 100.0 / c1.qtdePedidos), 2)         END AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual)"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida) FROM ItensPedidoVenda iv2) AS media_geral FROM      Cliente c JOIN      PedidoVenda pv ON c.idCliente = pv.idCliente JOIN      ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY      c.idCliente, c.nomeCliente HAVING      media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),      DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankClientes AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS `rank`     FROM VendasAnuais ) SELECT      idCliente,     ano,     valorTotalVendas FROM RankClientes WHERE `rank` <= 10 ORDER BY ano, `rank`;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComAnoAnterior AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_ano_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     CASE          WHEN vendas_ano_anterior IS NOT NULL AND vendas_ano_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_ano_anterior) / vendas_ano_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComAnoAnterior WHERE vendas_ano_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdePedidos AS pedidos_2020,         c2.qtdePedidos AS pedidos_2021,         CASE              WHEN c1.qtdePedidos = 0 THEN NULL             ELSE ROUND(((c2.qtdePedidos - c1.qtdePedidos) * 100.0 / c1.qtdePedidos), 2)         END AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual)"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida) FROM ItensPedidoVenda iv2) AS media_geral FROM      Cliente c JOIN      PedidoVenda pv ON c.idCliente = pv.idCliente JOIN      ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY      c.idCliente, c.nomeCliente HAVING      media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),      DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankClientes AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS `rank`     FROM VendasAnuais ) SELECT      idCliente,     ano,     valorTotalVendas FROM RankClientes WHERE `rank` <= 10 ORDER BY ano, `rank`;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComAnoAnterior AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_ano_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     CASE          WHEN vendas_ano_anterior IS NOT NULL AND vendas_ano_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_ano_anterior) / vendas_ano_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComAnoAnterior WHERE vendas_ano_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdePedidos AS pedidos_2020,         c2.qtdePedidos AS pedidos_2021,         CASE              WHEN c1.qtdePedidos = 0 THEN NULL             ELSE ROUND(((c2.qtdePedidos - c1.qtdePedidos) * 100.0 / c1.qtdePedidos), 2)         END AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual)"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida) FROM ItensPedidoVenda iv2) AS media_geral FROM      Cliente c JOIN      PedidoVenda pv ON c.idCliente = pv.idCliente JOIN      ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY      c.idCliente, c.nomeCliente HAVING      media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),      DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankClientes AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS `rank`     FROM VendasAnuais ) SELECT      idCliente,     ano,     valorTotalVendas FROM RankClientes WHERE `rank` <= 10 ORDER BY ano, `rank`;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComAnoAnterior AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_ano_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     CASE          WHEN vendas_ano_anterior IS NOT NULL AND vendas_ano_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_ano_anterior) / vendas_ano_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComAnoAnterior WHERE vendas_ano_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdePedidos AS pedidos_2020,         c2.qtdePedidos AS pedidos_2021,         CASE              WHEN c1.qtdePedidos = 0 THEN NULL             ELSE ROUND(((c2.qtdePedidos - c1.qtdePedidos) * 100.0 / c1.qtdePedidos), 2)         END AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual)"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida) FROM ItensPedidoVenda iv2) AS media_geral FROM      Cliente c JOIN      PedidoVenda pv ON c.idCliente = pv.idCliente JOIN      ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY      c.idCliente, c.nomeCliente HAVING      media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),      DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankClientes AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS `rank`     FROM VendasAnuais ) SELECT      idCliente,     ano,     valorTotalVendas FROM RankClientes WHERE `rank` <= 10 ORDER BY ano, `rank`;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComAnoAnterior AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_ano_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     CASE          WHEN vendas_ano_anterior IS NOT NULL AND vendas_ano_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_ano_anterior) / vendas_ano_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComAnoAnterior WHERE vendas_ano_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdePedidos AS pedidos_2020,         c2.qtdePedidos AS pedidos_2021,         CASE              WHEN c1.qtdePedidos = 0 THEN NULL             ELSE ROUND(((c2.qtdePedidos - c1.qtdePedidos) * 100.0 / c1.qtdePedidos), 2)         END AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual)"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida) FROM ItensPedidoVenda iv2) AS media_geral FROM      Cliente c JOIN      PedidoVenda pv ON c.idCliente = pv.idCliente JOIN      ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY      c.idCliente, c.nomeCliente HAVING      media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),      DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankClientes AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS `rank`     FROM VendasAnuais ) SELECT      idCliente,     ano,     valorTotalVendas FROM RankClientes WHERE `rank` <= 10 ORDER BY ano, `rank`;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComAnoAnterior AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_ano_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     CASE          WHEN vendas_ano_anterior IS NOT NULL AND vendas_ano_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_ano_anterior) / vendas_ano_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComAnoAnterior WHERE vendas_ano_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdePedidos AS pedidos_2020,         c2.qtdePedidos AS pedidos_2021,         CASE              WHEN c1.qtdePedidos = 0 THEN NULL             ELSE ROUND(((c2.qtdePedidos - c1.qtdePedidos) * 100.0 / c1.qtdePedidos), 2)         END AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual)"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida) FROM ItensPedidoVenda iv2) AS media_geral FROM      Cliente c JOIN      PedidoVenda pv ON c.idCliente = pv.idCliente JOIN      ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY      c.idCliente, c.nomeCliente HAVING      media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),      DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankClientes AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS `rank`     FROM VendasAnuais ) SELECT      idCliente,     ano,     valorTotalVendas FROM RankClientes WHERE `rank` <= 10 ORDER BY ano, `rank`;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComAnoAnterior AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_ano_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     CASE          WHEN vendas_ano_anterior IS NOT NULL AND vendas_ano_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_ano_anterior) / vendas_ano_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComAnoAnterior WHERE vendas_ano_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdePedidos AS pedidos_2020,         c2.qtdePedidos AS pedidos_2021,         CASE              WHEN c1.qtdePedidos = 0 THEN NULL             ELSE ROUND(((c2.qtdePedidos - c1.qtdePedidos) * 100.0 / c1.qtdePedidos), 2)         END AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual)"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida) FROM ItensPedidoVenda iv2) AS media_geral FROM      Cliente c JOIN      PedidoVenda pv ON c.idCliente = pv.idCliente JOIN      ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY      c.idCliente, c.nomeCliente HAVING      media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),      DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankClientes AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS `rank`     FROM VendasAnuais ) SELECT      idCliente,     ano,     valorTotalVendas FROM RankClientes WHERE `rank` <= 10 ORDER BY ano, `rank`;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComAnoAnterior AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_ano_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     CASE          WHEN vendas_ano_anterior IS NOT NULL AND vendas_ano_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_ano_anterior) / vendas_ano_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComAnoAnterior WHERE vendas_ano_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdePedidos AS pedidos_2020,         c2.qtdePedidos AS pedidos_2021,         CASE              WHEN c1.qtdePedidos = 0 THEN NULL             ELSE ROUND(((c2.qtdePedidos - c1.qtdePedidos) * 100.0 / c1.qtdePedidos), 2)         END AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual)"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida) FROM ItensPedidoVenda iv2) AS media_geral FROM      Cliente c JOIN      PedidoVenda pv ON c.idCliente = pv.idCliente JOIN      ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY      c.idCliente, c.nomeCliente HAVING      media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),      DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankClientes AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS `rank`     FROM VendasAnuais ) SELECT      idCliente,     ano,     valorTotalVendas FROM RankClientes WHERE `rank` <= 10 ORDER BY ano, `rank`;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComAnoAnterior AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_ano_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     CASE          WHEN vendas_ano_anterior IS NOT NULL AND vendas_ano_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_ano_anterior) / vendas_ano_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComAnoAnterior WHERE vendas_ano_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdePedidos AS pedidos_2020,         c2.qtdePedidos AS pedidos_2021,         CASE              WHEN c1.qtdePedidos = 0 THEN NULL             ELSE ROUND(((c2.qtdePedidos - c1.qtdePedidos) * 100.0 / c1.qtdePedidos), 2)         END AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual)"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida) FROM ItensPedidoVenda iv2) AS media_geral FROM      Cliente c JOIN      PedidoVenda pv ON c.idCliente = pv.idCliente JOIN      ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY      c.idCliente, c.nomeCliente HAVING      media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),      DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankClientes AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS `rank`     FROM VendasAnuais ) SELECT      idCliente,     ano,     valorTotalVendas FROM RankClientes WHERE `rank` <= 10 ORDER BY ano, `rank`;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComAnoAnterior AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_ano_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     CASE          WHEN vendas_ano_anterior IS NOT NULL AND vendas_ano_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_ano_anterior) / vendas_ano_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComAnoAnterior WHERE vendas_ano_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdePedidos AS pedidos_2020,         c2.qtdePedidos AS pedidos_2021,         CASE              WHEN c1.qtdePedidos = 0 THEN NULL             ELSE ROUND(((c2.qtdePedidos - c1.qtdePedidos) * 100.0 / c1.qtdePedidos), 2)         END AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual)"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida) FROM ItensPedidoVenda iv2) AS media_geral FROM      Cliente c JOIN      PedidoVenda pv ON c.idCliente = pv.idCliente JOIN      ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY      c.idCliente, c.nomeCliente HAVING      media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),      DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankClientes AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS `rank`     FROM VendasAnuais ) SELECT      idCliente,     ano,     valorTotalVendas FROM RankClientes WHERE `rank` <= 10 ORDER BY ano, `rank`;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComAnoAnterior AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_ano_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     CASE          WHEN vendas_ano_anterior IS NOT NULL AND vendas_ano_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_ano_anterior) / vendas_ano_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComAnoAnterior WHERE vendas_ano_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdePedidos AS pedidos_2020,         c2.qtdePedidos AS pedidos_2021,         CASE              WHEN c1.qtdePedidos = 0 THEN NULL             ELSE ROUND(((c2.qtdePedidos - c1.qtdePedidos) * 100.0 / c1.qtdePedidos), 2)         END AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual)"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida) FROM ItensPedidoVenda iv2) AS media_geral FROM      Cliente c JOIN      PedidoVenda pv ON c.idCliente = pv.idCliente JOIN      ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY      c.idCliente, c.nomeCliente HAVING      media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),      DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankClientes AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS `rank`     FROM VendasAnuais ) SELECT      idCliente,     ano,     valorTotalVendas FROM RankClientes WHERE `rank` <= 10 ORDER BY ano, `rank`;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComAnoAnterior AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_ano_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     CASE          WHEN vendas_ano_anterior IS NOT NULL AND vendas_ano_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_ano_anterior) / vendas_ano_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComAnoAnterior WHERE vendas_ano_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdePedidos AS pedidos_2020,         c2.qtdePedidos AS pedidos_2021,         CASE              WHEN c1.qtdePedidos = 0 THEN NULL             ELSE ROUND(((c2.qtdePedidos - c1.qtdePedidos) * 100.0 / c1.qtdePedidos), 2)         END AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual)"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida) FROM ItensPedidoVenda iv2) AS media_geral FROM      Cliente c JOIN      PedidoVenda pv ON c.idCliente = pv.idCliente JOIN      ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY      c.idCliente, c.nomeCliente HAVING      media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),      DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankClientes AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS `rank`     FROM VendasAnuais ) SELECT      idCliente,     ano,     valorTotalVendas FROM RankClientes WHERE `rank` <= 10 ORDER BY ano, `rank`;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComAnoAnterior AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_ano_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     CASE          WHEN vendas_ano_anterior IS NOT NULL AND vendas_ano_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_ano_anterior) / vendas_ano_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComAnoAnterior WHERE vendas_ano_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdePedidos AS pedidos_2020,         c2.qtdePedidos AS pedidos_2021,         CASE              WHEN c1.qtdePedidos = 0 THEN NULL             ELSE ROUND(((c2.qtdePedidos - c1.qtdePedidos) * 100.0 / c1.qtdePedidos), 2)         END AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual)"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida) FROM ItensPedidoVenda iv2) AS media_geral FROM      Cliente c JOIN      PedidoVenda pv ON c.idCliente = pv.idCliente JOIN      ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY      c.idCliente, c.nomeCliente HAVING      media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),      DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankClientes AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS `rank`     FROM VendasAnuais ) SELECT      idCliente,     ano,     valorTotalVendas FROM RankClientes WHERE `rank` <= 10 ORDER BY ano, `rank`;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComAnoAnterior AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_ano_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     CASE          WHEN vendas_ano_anterior IS NOT NULL AND vendas_ano_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_ano_anterior) / vendas_ano_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComAnoAnterior WHERE vendas_ano_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdePedidos AS pedidos_2020,         c2.qtdePedidos AS pedidos_2021,         CASE              WHEN c1.qtdePedidos = 0 THEN NULL             ELSE ROUND(((c2.qtdePedidos - c1.qtdePedidos) * 100.0 / c1.qtdePedidos), 2)         END AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual)"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida) FROM ItensPedidoVenda iv2) AS media_geral FROM      Cliente c JOIN      PedidoVenda pv ON c.idCliente = pv.idCliente JOIN      ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY      c.idCliente, c.nomeCliente HAVING      media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),      DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankClientes AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS `rank`     FROM VendasAnuais ) SELECT      idCliente,     ano,     valorTotalVendas FROM RankClientes WHERE `rank` <= 10 ORDER BY ano, `rank`;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComAnoAnterior AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_ano_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     CASE          WHEN vendas_ano_anterior IS NOT NULL AND vendas_ano_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_ano_anterior) / vendas_ano_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComAnoAnterior WHERE vendas_ano_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdePedidos AS pedidos_2020,         c2.qtdePedidos AS pedidos_2021,         CASE              WHEN c1.qtdePedidos = 0 THEN NULL             ELSE ROUND(((c2.qtdePedidos - c1.qtdePedidos) * 100.0 / c1.qtdePedidos), 2)         END AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual)"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida) FROM ItensPedidoVenda iv2) AS media_geral FROM      Cliente c JOIN      PedidoVenda pv ON c.idCliente = pv.idCliente JOIN      ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY      c.idCliente, c.nomeCliente HAVING      media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),      DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankClientes AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS `rank`     FROM VendasAnuais ) SELECT      idCliente,     ano,     valorTotalVendas FROM RankClientes WHERE `rank` <= 10 ORDER BY ano, `rank`;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComAnoAnterior AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_ano_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     CASE          WHEN vendas_ano_anterior IS NOT NULL AND vendas_ano_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_ano_anterior) / vendas_ano_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComAnoAnterior WHERE vendas_ano_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdePedidos AS pedidos_2020,         c2.qtdePedidos AS pedidos_2021,         CASE              WHEN c1.qtdePedidos = 0 THEN NULL             ELSE ROUND(((c2.qtdePedidos - c1.qtdePedidos) * 100.0 / c1.qtdePedidos), 2)         END AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual)"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida) FROM ItensPedidoVenda iv2) AS media_geral FROM      Cliente c JOIN      PedidoVenda pv ON c.idCliente = pv.idCliente JOIN      ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY      c.idCliente, c.nomeCliente HAVING      media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),      DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankClientes AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS `rank`     FROM VendasAnuais ) SELECT      idCliente,     ano,     valorTotalVendas FROM RankClientes WHERE `rank` <= 10 ORDER BY ano, `rank`;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComAnoAnterior AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_ano_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     CASE          WHEN vendas_ano_anterior IS NOT NULL AND vendas_ano_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_ano_anterior) / vendas_ano_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComAnoAnterior WHERE vendas_ano_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdePedidos AS pedidos_2020,         c2.qtdePedidos AS pedidos_2021,         CASE              WHEN c1.qtdePedidos = 0 THEN NULL             ELSE ROUND(((c2.qtdePedidos - c1.qtdePedidos) * 100.0 / c1.qtdePedidos), 2)         END AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual)"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida) FROM ItensPedidoVenda iv2) AS media_geral FROM      Cliente c JOIN      PedidoVenda pv ON c.idCliente = pv.idCliente JOIN      ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY      c.idCliente, c.nomeCliente HAVING      media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS quantidade_vendida FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      quantidade_vendida DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`qtdePedida` * ipv.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), Variacoes AS (     SELECT          va1.`idCategoria`,         va1.ano AS ano_atual,         va1.total_vendas AS vendas_atual,         va2.total_vendas AS vendas_anterior,         CASE              WHEN va2.total_vendas IS NOT NULL AND va2.total_vendas > 0 THEN                 ((va1.total_vendas - va2.total_vendas) / va2.total_vendas) * 100             ELSE NULL         END AS variacao_percentual     FROM VendasAnuais va1     LEFT JOIN VendasAnuais va2          ON va1.`idCategoria` = va2.`idCategoria`          AND va1.ano = va2.ano + 1 ) SELECT      c.`nomeCategoria`,     v.ano_atual,     v.variacao_percentual FROM Variacoes v JOIN `CategoriaProduto` c ON v.`idCategoria` = c.`idCategoria` ORDER BY c.`nomeCategoria`, v.ano_atual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS quantidade_pedidos,         LAG(COUNT(pv.`idPedido`)) OVER (PARTITION BY mp.`idMarketPlace` ORDER BY YEAR(pv.`dataPedido`)) AS pedidos_ano_anterior     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, YEAR(pv.`dataPedido`) ), VariacaoPercentual AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         ano,         quantidade_pedidos,         pedidos_ano_anterior,         CASE              WHEN pedidos_ano_anterior IS NOT NULL AND pedidos_ano_anterior > 0 THEN                 ROUND(((quantidade_pedidos - pedidos_ano_anterior) * 100.0 / pedidos_ano_anterior), 2)             ELSE NULL         END AS variacao_percentual     FROM          CrescimentoMarketPlace ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      ano = 2021 AND variacao_percentual IS NOT NULL ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING AVG(ip.precoVendido * ip.qtdePedida) > (     SELECT AVG(ip2.precoVendido * ip2.qtdePedida)     FROM ItensPedidoVenda ip2 );"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS quantidade_vendida FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      quantidade_vendida DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`qtdePedida` * ipv.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), Variacoes AS (     SELECT          va1.`idCategoria`,         va1.ano AS ano_atual,         va1.total_vendas AS vendas_atual,         va2.total_vendas AS vendas_anterior,         CASE              WHEN va2.total_vendas IS NOT NULL AND va2.total_vendas > 0 THEN                 ((va1.total_vendas - va2.total_vendas) / va2.total_vendas) * 100             ELSE NULL         END AS variacao_percentual     FROM VendasAnuais va1     LEFT JOIN VendasAnuais va2          ON va1.`idCategoria` = va2.`idCategoria`          AND va1.ano = va2.ano + 1 ) SELECT      c.`nomeCategoria`,     v.ano_atual,     v.variacao_percentual FROM Variacoes v JOIN `CategoriaProduto` c ON v.`idCategoria` = c.`idCategoria` ORDER BY c.`nomeCategoria`, v.ano_atual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS quantidade_pedidos,         LAG(COUNT(pv.`idPedido`)) OVER (PARTITION BY mp.`idMarketPlace` ORDER BY YEAR(pv.`dataPedido`)) AS pedidos_ano_anterior     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, YEAR(pv.`dataPedido`) ), VariacaoPercentual AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         ano,         quantidade_pedidos,         pedidos_ano_anterior,         CASE              WHEN pedidos_ano_anterior IS NOT NULL AND pedidos_ano_anterior > 0 THEN                 ROUND(((quantidade_pedidos - pedidos_ano_anterior) * 100.0 / pedidos_ano_anterior), 2)             ELSE NULL         END AS variacao_percentual     FROM          CrescimentoMarketPlace ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      ano = 2021 AND variacao_percentual IS NOT NULL ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING AVG(ip.precoVendido * ip.qtdePedida) > (     SELECT AVG(ip2.precoVendido * ip2.qtdePedida)     FROM ItensPedidoVenda ip2 );"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS quantidade_vendida FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      quantidade_vendida DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`qtdePedida` * ipv.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), Variacoes AS (     SELECT          va1.`idCategoria`,         va1.ano AS ano_atual,         va1.total_vendas AS vendas_atual,         va2.total_vendas AS vendas_anterior,         CASE              WHEN va2.total_vendas IS NOT NULL AND va2.total_vendas > 0 THEN                 ((va1.total_vendas - va2.total_vendas) / va2.total_vendas) * 100             ELSE NULL         END AS variacao_percentual     FROM VendasAnuais va1     LEFT JOIN VendasAnuais va2          ON va1.`idCategoria` = va2.`idCategoria`          AND va1.ano = va2.ano + 1 ) SELECT      c.`nomeCategoria`,     v.ano_atual,     v.variacao_percentual FROM Variacoes v JOIN `CategoriaProduto` c ON v.`idCategoria` = c.`idCategoria` ORDER BY c.`nomeCategoria`, v.ano_atual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS quantidade_pedidos,         LAG(COUNT(pv.`idPedido`)) OVER (PARTITION BY mp.`idMarketPlace` ORDER BY YEAR(pv.`dataPedido`)) AS pedidos_ano_anterior     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, YEAR(pv.`dataPedido`) ), VariacaoPercentual AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         ano,         quantidade_pedidos,         pedidos_ano_anterior,         CASE              WHEN pedidos_ano_anterior IS NOT NULL AND pedidos_ano_anterior > 0 THEN                 ROUND(((quantidade_pedidos - pedidos_ano_anterior) * 100.0 / pedidos_ano_anterior), 2)             ELSE NULL         END AS variacao_percentual     FROM          CrescimentoMarketPlace ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      ano = 2021 AND variacao_percentual IS NOT NULL ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING AVG(ip.precoVendido * ip.qtdePedida) > (     SELECT AVG(ip2.precoVendido * ip2.qtdePedida)     FROM ItensPedidoVenda ip2 );"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS quantidade_vendida FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      quantidade_vendida DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`qtdePedida` * ipv.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), Variacoes AS (     SELECT          va1.`idCategoria`,         va1.ano AS ano_atual,         va1.total_vendas AS vendas_atual,         va2.total_vendas AS vendas_anterior,         CASE              WHEN va2.total_vendas IS NOT NULL AND va2.total_vendas > 0 THEN                 ((va1.total_vendas - va2.total_vendas) / va2.total_vendas) * 100             ELSE NULL         END AS variacao_percentual     FROM VendasAnuais va1     LEFT JOIN VendasAnuais va2          ON va1.`idCategoria` = va2.`idCategoria`          AND va1.ano = va2.ano + 1 ) SELECT      c.`nomeCategoria`,     v.ano_atual,     v.variacao_percentual FROM Variacoes v JOIN `CategoriaProduto` c ON v.`idCategoria` = c.`idCategoria` ORDER BY c.`nomeCategoria`, v.ano_atual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS quantidade_pedidos,         LAG(COUNT(pv.`idPedido`)) OVER (PARTITION BY mp.`idMarketPlace` ORDER BY YEAR(pv.`dataPedido`)) AS pedidos_ano_anterior     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, YEAR(pv.`dataPedido`) ), VariacaoPercentual AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         ano,         quantidade_pedidos,         pedidos_ano_anterior,         CASE              WHEN pedidos_ano_anterior IS NOT NULL AND pedidos_ano_anterior > 0 THEN                 ROUND(((quantidade_pedidos - pedidos_ano_anterior) * 100.0 / pedidos_ano_anterior), 2)             ELSE NULL         END AS variacao_percentual     FROM          CrescimentoMarketPlace ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      ano = 2021 AND variacao_percentual IS NOT NULL ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING AVG(ip.precoVendido * ip.qtdePedida) > (     SELECT AVG(ip2.precoVendido * ip2.qtdePedida)     FROM ItensPedidoVenda ip2 );"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS quantidade_vendida FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      quantidade_vendida DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`qtdePedida` * ipv.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), Variacoes AS (     SELECT          va1.`idCategoria`,         va1.ano AS ano_atual,         va1.total_vendas AS vendas_atual,         va2.total_vendas AS vendas_anterior,         CASE              WHEN va2.total_vendas IS NOT NULL AND va2.total_vendas > 0 THEN                 ((va1.total_vendas - va2.total_vendas) / va2.total_vendas) * 100             ELSE NULL         END AS variacao_percentual     FROM VendasAnuais va1     LEFT JOIN VendasAnuais va2          ON va1.`idCategoria` = va2.`idCategoria`          AND va1.ano = va2.ano + 1 ) SELECT      c.`nomeCategoria`,     v.ano_atual,     v.variacao_percentual FROM Variacoes v JOIN `CategoriaProduto` c ON v.`idCategoria` = c.`idCategoria` ORDER BY c.`nomeCategoria`, v.ano_atual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS quantidade_pedidos,         LAG(COUNT(pv.`idPedido`)) OVER (PARTITION BY mp.`idMarketPlace` ORDER BY YEAR(pv.`dataPedido`)) AS pedidos_ano_anterior     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, YEAR(pv.`dataPedido`) ), VariacaoPercentual AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         ano,         quantidade_pedidos,         pedidos_ano_anterior,         CASE              WHEN pedidos_ano_anterior IS NOT NULL AND pedidos_ano_anterior > 0 THEN                 ROUND(((quantidade_pedidos - pedidos_ano_anterior) * 100.0 / pedidos_ano_anterior), 2)             ELSE NULL         END AS variacao_percentual     FROM          CrescimentoMarketPlace ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      ano = 2021 AND variacao_percentual IS NOT NULL ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING AVG(ip.precoVendido * ip.qtdePedida) > (     SELECT AVG(ip2.precoVendido * ip2.qtdePedida)     FROM ItensPedidoVenda ip2 );"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS quantidade_vendida FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      quantidade_vendida DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`qtdePedida` * ipv.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), Variacoes AS (     SELECT          va1.`idCategoria`,         va1.ano AS ano_atual,         va1.total_vendas AS vendas_atual,         va2.total_vendas AS vendas_anterior,         CASE              WHEN va2.total_vendas IS NOT NULL AND va2.total_vendas > 0 THEN                 ((va1.total_vendas - va2.total_vendas) / va2.total_vendas) * 100             ELSE NULL         END AS variacao_percentual     FROM VendasAnuais va1     LEFT JOIN VendasAnuais va2          ON va1.`idCategoria` = va2.`idCategoria`          AND va1.ano = va2.ano + 1 ) SELECT      c.`nomeCategoria`,     v.ano_atual,     v.variacao_percentual FROM Variacoes v JOIN `CategoriaProduto` c ON v.`idCategoria` = c.`idCategoria` ORDER BY c.`nomeCategoria`, v.ano_atual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS quantidade_pedidos,         LAG(COUNT(pv.`idPedido`)) OVER (PARTITION BY mp.`idMarketPlace` ORDER BY YEAR(pv.`dataPedido`)) AS pedidos_ano_anterior     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, YEAR(pv.`dataPedido`) ), VariacaoPercentual AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         ano,         quantidade_pedidos,         pedidos_ano_anterior,         CASE              WHEN pedidos_ano_anterior IS NOT NULL AND pedidos_ano_anterior > 0 THEN                 ROUND(((quantidade_pedidos - pedidos_ano_anterior) * 100.0 / pedidos_ano_anterior), 2)             ELSE NULL         END AS variacao_percentual     FROM          CrescimentoMarketPlace ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      ano = 2021 AND variacao_percentual IS NOT NULL ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING AVG(ip.precoVendido * ip.qtdePedida) > (     SELECT AVG(ip2.precoVendido * ip2.qtdePedida)     FROM ItensPedidoVenda ip2 );"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS quantidade_vendida FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      quantidade_vendida DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`qtdePedida` * ipv.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), Variacoes AS (     SELECT          va1.`idCategoria`,         va1.ano AS ano_atual,         va1.total_vendas AS vendas_atual,         va2.total_vendas AS vendas_anterior,         CASE              WHEN va2.total_vendas IS NOT NULL AND va2.total_vendas > 0 THEN                 ((va1.total_vendas - va2.total_vendas) / va2.total_vendas) * 100             ELSE NULL         END AS variacao_percentual     FROM VendasAnuais va1     LEFT JOIN VendasAnuais va2          ON va1.`idCategoria` = va2.`idCategoria`          AND va1.ano = va2.ano + 1 ) SELECT      c.`nomeCategoria`,     v.ano_atual,     v.variacao_percentual FROM Variacoes v JOIN `CategoriaProduto` c ON v.`idCategoria` = c.`idCategoria` ORDER BY c.`nomeCategoria`, v.ano_atual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS quantidade_pedidos,         LAG(COUNT(pv.`idPedido`)) OVER (PARTITION BY mp.`idMarketPlace` ORDER BY YEAR(pv.`dataPedido`)) AS pedidos_ano_anterior     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, YEAR(pv.`dataPedido`) ), VariacaoPercentual AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         ano,         quantidade_pedidos,         pedidos_ano_anterior,         CASE              WHEN pedidos_ano_anterior IS NOT NULL AND pedidos_ano_anterior > 0 THEN                 ROUND(((quantidade_pedidos - pedidos_ano_anterior) * 100.0 / pedidos_ano_anterior), 2)             ELSE NULL         END AS variacao_percentual     FROM          CrescimentoMarketPlace ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      ano = 2021 AND variacao_percentual IS NOT NULL ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING AVG(ip.precoVendido * ip.qtdePedida) > (     SELECT AVG(ip2.precoVendido * ip2.qtdePedida)     FROM ItensPedidoVenda ip2 );"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS quantidade_vendida FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      quantidade_vendida DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`qtdePedida` * ipv.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), Variacoes AS (     SELECT          va1.`idCategoria`,         va1.ano AS ano_atual,         va1.total_vendas AS vendas_atual,         va2.total_vendas AS vendas_anterior,         CASE              WHEN va2.total_vendas IS NOT NULL AND va2.total_vendas > 0 THEN                 ((va1.total_vendas - va2.total_vendas) / va2.total_vendas) * 100             ELSE NULL         END AS variacao_percentual     FROM VendasAnuais va1     LEFT JOIN VendasAnuais va2          ON va1.`idCategoria` = va2.`idCategoria`          AND va1.ano = va2.ano + 1 ) SELECT      c.`nomeCategoria`,     v.ano_atual,     v.variacao_percentual FROM Variacoes v JOIN `CategoriaProduto` c ON v.`idCategoria` = c.`idCategoria` ORDER BY c.`nomeCategoria`, v.ano_atual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS quantidade_pedidos,         LAG(COUNT(pv.`idPedido`)) OVER (PARTITION BY mp.`idMarketPlace` ORDER BY YEAR(pv.`dataPedido`)) AS pedidos_ano_anterior     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, YEAR(pv.`dataPedido`) ), VariacaoPercentual AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         ano,         quantidade_pedidos,         pedidos_ano_anterior,         CASE              WHEN pedidos_ano_anterior IS NOT NULL AND pedidos_ano_anterior > 0 THEN                 ROUND(((quantidade_pedidos - pedidos_ano_anterior) * 100.0 / pedidos_ano_anterior), 2)             ELSE NULL         END AS variacao_percentual     FROM          CrescimentoMarketPlace ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      ano = 2021 AND variacao_percentual IS NOT NULL ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING AVG(ip.precoVendido * ip.qtdePedida) > (     SELECT AVG(ip2.precoVendido * ip2.qtdePedida)     FROM ItensPedidoVenda ip2 );"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS quantidade_vendida FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      quantidade_vendida DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`qtdePedida` * ipv.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), Variacoes AS (     SELECT          va1.`idCategoria`,         va1.ano AS ano_atual,         va1.total_vendas AS vendas_atual,         va2.total_vendas AS vendas_anterior,         CASE              WHEN va2.total_vendas IS NOT NULL AND va2.total_vendas > 0 THEN                 ((va1.total_vendas - va2.total_vendas) / va2.total_vendas) * 100             ELSE NULL         END AS variacao_percentual     FROM VendasAnuais va1     LEFT JOIN VendasAnuais va2          ON va1.`idCategoria` = va2.`idCategoria`          AND va1.ano = va2.ano + 1 ) SELECT      c.`nomeCategoria`,     v.ano_atual,     v.variacao_percentual FROM Variacoes v JOIN `CategoriaProduto` c ON v.`idCategoria` = c.`idCategoria` ORDER BY c.`nomeCategoria`, v.ano_atual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS quantidade_pedidos,         LAG(COUNT(pv.`idPedido`)) OVER (PARTITION BY mp.`idMarketPlace` ORDER BY YEAR(pv.`dataPedido`)) AS pedidos_ano_anterior     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, YEAR(pv.`dataPedido`) ), VariacaoPercentual AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         ano,         quantidade_pedidos,         pedidos_ano_anterior,         CASE              WHEN pedidos_ano_anterior IS NOT NULL AND pedidos_ano_anterior > 0 THEN                 ROUND(((quantidade_pedidos - pedidos_ano_anterior) * 100.0 / pedidos_ano_anterior), 2)             ELSE NULL         END AS variacao_percentual     FROM          CrescimentoMarketPlace ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      ano = 2021 AND variacao_percentual IS NOT NULL ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING AVG(ip.precoVendido * ip.qtdePedida) > (     SELECT AVG(ip2.precoVendido * ip2.qtdePedida)     FROM ItensPedidoVenda ip2 );"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS quantidade_vendida FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      quantidade_vendida DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`qtdePedida` * ipv.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), Variacoes AS (     SELECT          va1.`idCategoria`,         va1.ano AS ano_atual,         va1.total_vendas AS vendas_atual,         va2.total_vendas AS vendas_anterior,         CASE              WHEN va2.total_vendas IS NOT NULL AND va2.total_vendas > 0 THEN                 ((va1.total_vendas - va2.total_vendas) / va2.total_vendas) * 100             ELSE NULL         END AS variacao_percentual     FROM VendasAnuais va1     LEFT JOIN VendasAnuais va2          ON va1.`idCategoria` = va2.`idCategoria`          AND va1.ano = va2.ano + 1 ) SELECT      c.`nomeCategoria`,     v.ano_atual,     v.variacao_percentual FROM Variacoes v JOIN `CategoriaProduto` c ON v.`idCategoria` = c.`idCategoria` ORDER BY c.`nomeCategoria`, v.ano_atual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS quantidade_pedidos,         LAG(COUNT(pv.`idPedido`)) OVER (PARTITION BY mp.`idMarketPlace` ORDER BY YEAR(pv.`dataPedido`)) AS pedidos_ano_anterior     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, YEAR(pv.`dataPedido`) ), VariacaoPercentual AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         ano,         quantidade_pedidos,         pedidos_ano_anterior,         CASE              WHEN pedidos_ano_anterior IS NOT NULL AND pedidos_ano_anterior > 0 THEN                 ROUND(((quantidade_pedidos - pedidos_ano_anterior) * 100.0 / pedidos_ano_anterior), 2)             ELSE NULL         END AS variacao_percentual     FROM          CrescimentoMarketPlace ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      ano = 2021 AND variacao_percentual IS NOT NULL ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING AVG(ip.precoVendido * ip.qtdePedida) > (     SELECT AVG(ip2.precoVendido * ip2.qtdePedida)     FROM ItensPedidoVenda ip2 );"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS quantidade_vendida FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      quantidade_vendida DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`qtdePedida` * ipv.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), Variacoes AS (     SELECT          va1.`idCategoria`,         va1.ano AS ano_atual,         va1.total_vendas AS vendas_atual,         va2.total_vendas AS vendas_anterior,         CASE              WHEN va2.total_vendas IS NOT NULL AND va2.total_vendas > 0 THEN                 ((va1.total_vendas - va2.total_vendas) / va2.total_vendas) * 100             ELSE NULL         END AS variacao_percentual     FROM VendasAnuais va1     LEFT JOIN VendasAnuais va2          ON va1.`idCategoria` = va2.`idCategoria`          AND va1.ano = va2.ano + 1 ) SELECT      c.`nomeCategoria`,     v.ano_atual,     v.variacao_percentual FROM Variacoes v JOIN `CategoriaProduto` c ON v.`idCategoria` = c.`idCategoria` ORDER BY c.`nomeCategoria`, v.ano_atual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS quantidade_pedidos,         LAG(COUNT(pv.`idPedido`)) OVER (PARTITION BY mp.`idMarketPlace` ORDER BY YEAR(pv.`dataPedido`)) AS pedidos_ano_anterior     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, YEAR(pv.`dataPedido`) ), VariacaoPercentual AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         ano,         quantidade_pedidos,         pedidos_ano_anterior,         CASE              WHEN pedidos_ano_anterior IS NOT NULL AND pedidos_ano_anterior > 0 THEN                 ROUND(((quantidade_pedidos - pedidos_ano_anterior) * 100.0 / pedidos_ano_anterior), 2)             ELSE NULL         END AS variacao_percentual     FROM          CrescimentoMarketPlace ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      ano = 2021 AND variacao_percentual IS NOT NULL ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING AVG(ip.precoVendido * ip.qtdePedida) > (     SELECT AVG(ip2.precoVendido * ip2.qtdePedida)     FROM ItensPedidoVenda ip2 );"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS quantidade_vendida FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      quantidade_vendida DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`qtdePedida` * ipv.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), Variacoes AS (     SELECT          va1.`idCategoria`,         va1.ano AS ano_atual,         va1.total_vendas AS vendas_atual,         va2.total_vendas AS vendas_anterior,         CASE              WHEN va2.total_vendas IS NOT NULL AND va2.total_vendas > 0 THEN                 ((va1.total_vendas - va2.total_vendas) / va2.total_vendas) * 100             ELSE NULL         END AS variacao_percentual     FROM VendasAnuais va1     LEFT JOIN VendasAnuais va2          ON va1.`idCategoria` = va2.`idCategoria`          AND va1.ano = va2.ano + 1 ) SELECT      c.`nomeCategoria`,     v.ano_atual,     v.variacao_percentual FROM Variacoes v JOIN `CategoriaProduto` c ON v.`idCategoria` = c.`idCategoria` ORDER BY c.`nomeCategoria`, v.ano_atual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS quantidade_pedidos,         LAG(COUNT(pv.`idPedido`)) OVER (PARTITION BY mp.`idMarketPlace` ORDER BY YEAR(pv.`dataPedido`)) AS pedidos_ano_anterior     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, YEAR(pv.`dataPedido`) ), VariacaoPercentual AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         ano,         quantidade_pedidos,         pedidos_ano_anterior,         CASE              WHEN pedidos_ano_anterior IS NOT NULL AND pedidos_ano_anterior > 0 THEN                 ROUND(((quantidade_pedidos - pedidos_ano_anterior) * 100.0 / pedidos_ano_anterior), 2)             ELSE NULL         END AS variacao_percentual     FROM          CrescimentoMarketPlace ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      ano = 2021 AND variacao_percentual IS NOT NULL ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING AVG(ip.precoVendido * ip.qtdePedida) > (     SELECT AVG(ip2.precoVendido * ip2.qtdePedida)     FROM ItensPedidoVenda ip2 );"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS quantidade_vendida FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      quantidade_vendida DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`qtdePedida` * ipv.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), Variacoes AS (     SELECT          va1.`idCategoria`,         va1.ano AS ano_atual,         va1.total_vendas AS vendas_atual,         va2.total_vendas AS vendas_anterior,         CASE              WHEN va2.total_vendas IS NOT NULL AND va2.total_vendas > 0 THEN                 ((va1.total_vendas - va2.total_vendas) / va2.total_vendas) * 100             ELSE NULL         END AS variacao_percentual     FROM VendasAnuais va1     LEFT JOIN VendasAnuais va2          ON va1.`idCategoria` = va2.`idCategoria`          AND va1.ano = va2.ano + 1 ) SELECT      c.`nomeCategoria`,     v.ano_atual,     v.variacao_percentual FROM Variacoes v JOIN `CategoriaProduto` c ON v.`idCategoria` = c.`idCategoria` ORDER BY c.`nomeCategoria`, v.ano_atual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS quantidade_pedidos,         LAG(COUNT(pv.`idPedido`)) OVER (PARTITION BY mp.`idMarketPlace` ORDER BY YEAR(pv.`dataPedido`)) AS pedidos_ano_anterior     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, YEAR(pv.`dataPedido`) ), VariacaoPercentual AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         ano,         quantidade_pedidos,         pedidos_ano_anterior,         CASE              WHEN pedidos_ano_anterior IS NOT NULL AND pedidos_ano_anterior > 0 THEN                 ROUND(((quantidade_pedidos - pedidos_ano_anterior) * 100.0 / pedidos_ano_anterior), 2)             ELSE NULL         END AS variacao_percentual     FROM          CrescimentoMarketPlace ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      ano = 2021 AND variacao_percentual IS NOT NULL ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING AVG(ip.precoVendido * ip.qtdePedida) > (     SELECT AVG(ip2.precoVendido * ip2.qtdePedida)     FROM ItensPedidoVenda ip2 );"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS quantidade_vendida FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      quantidade_vendida DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`qtdePedida` * ipv.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), Variacoes AS (     SELECT          va1.`idCategoria`,         va1.ano AS ano_atual,         va1.total_vendas AS vendas_atual,         va2.total_vendas AS vendas_anterior,         CASE              WHEN va2.total_vendas IS NOT NULL AND va2.total_vendas > 0 THEN                 ((va1.total_vendas - va2.total_vendas) / va2.total_vendas) * 100             ELSE NULL         END AS variacao_percentual     FROM VendasAnuais va1     LEFT JOIN VendasAnuais va2          ON va1.`idCategoria` = va2.`idCategoria`          AND va1.ano = va2.ano + 1 ) SELECT      c.`nomeCategoria`,     v.ano_atual,     v.variacao_percentual FROM Variacoes v JOIN `CategoriaProduto` c ON v.`idCategoria` = c.`idCategoria` ORDER BY c.`nomeCategoria`, v.ano_atual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS quantidade_pedidos,         LAG(COUNT(pv.`idPedido`)) OVER (PARTITION BY mp.`idMarketPlace` ORDER BY YEAR(pv.`dataPedido`)) AS pedidos_ano_anterior     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, YEAR(pv.`dataPedido`) ), VariacaoPercentual AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         ano,         quantidade_pedidos,         pedidos_ano_anterior,         CASE              WHEN pedidos_ano_anterior IS NOT NULL AND pedidos_ano_anterior > 0 THEN                 ROUND(((quantidade_pedidos - pedidos_ano_anterior) * 100.0 / pedidos_ano_anterior), 2)             ELSE NULL         END AS variacao_percentual     FROM          CrescimentoMarketPlace ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      ano = 2021 AND variacao_percentual IS NOT NULL ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING AVG(ip.precoVendido * ip.qtdePedida) > (     SELECT AVG(ip2.precoVendido * ip2.qtdePedida)     FROM ItensPedidoVenda ip2 );"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS quantidade_vendida FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      quantidade_vendida DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`qtdePedida` * ipv.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), Variacoes AS (     SELECT          va1.`idCategoria`,         va1.ano AS ano_atual,         va1.total_vendas AS vendas_atual,         va2.total_vendas AS vendas_anterior,         CASE              WHEN va2.total_vendas IS NOT NULL AND va2.total_vendas > 0 THEN                 ((va1.total_vendas - va2.total_vendas) / va2.total_vendas) * 100             ELSE NULL         END AS variacao_percentual     FROM VendasAnuais va1     LEFT JOIN VendasAnuais va2          ON va1.`idCategoria` = va2.`idCategoria`          AND va1.ano = va2.ano + 1 ) SELECT      c.`nomeCategoria`,     v.ano_atual,     v.variacao_percentual FROM Variacoes v JOIN `CategoriaProduto` c ON v.`idCategoria` = c.`idCategoria` ORDER BY c.`nomeCategoria`, v.ano_atual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS quantidade_pedidos,         LAG(COUNT(pv.`idPedido`)) OVER (PARTITION BY mp.`idMarketPlace` ORDER BY YEAR(pv.`dataPedido`)) AS pedidos_ano_anterior     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, YEAR(pv.`dataPedido`) ), VariacaoPercentual AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         ano,         quantidade_pedidos,         pedidos_ano_anterior,         CASE              WHEN pedidos_ano_anterior IS NOT NULL AND pedidos_ano_anterior > 0 THEN                 ROUND(((quantidade_pedidos - pedidos_ano_anterior) * 100.0 / pedidos_ano_anterior), 2)             ELSE NULL         END AS variacao_percentual     FROM          CrescimentoMarketPlace ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      ano = 2021 AND variacao_percentual IS NOT NULL ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING AVG(ip.precoVendido * ip.qtdePedida) > (     SELECT AVG(ip2.precoVendido * ip2.qtdePedida)     FROM ItensPedidoVenda ip2 );"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS quantidade_vendida FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      quantidade_vendida DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`qtdePedida` * ipv.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), Variacoes AS (     SELECT          va1.`idCategoria`,         va1.ano AS ano_atual,         va1.total_vendas AS vendas_atual,         va2.total_vendas AS vendas_anterior,         CASE              WHEN va2.total_vendas IS NOT NULL AND va2.total_vendas > 0 THEN                 ((va1.total_vendas - va2.total_vendas) / va2.total_vendas) * 100             ELSE NULL         END AS variacao_percentual     FROM VendasAnuais va1     LEFT JOIN VendasAnuais va2          ON va1.`idCategoria` = va2.`idCategoria`          AND va1.ano = va2.ano + 1 ) SELECT      c.`nomeCategoria`,     v.ano_atual,     v.variacao_percentual FROM Variacoes v JOIN `CategoriaProduto` c ON v.`idCategoria` = c.`idCategoria` ORDER BY c.`nomeCategoria`, v.ano_atual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS quantidade_pedidos,         LAG(COUNT(pv.`idPedido`)) OVER (PARTITION BY mp.`idMarketPlace` ORDER BY YEAR(pv.`dataPedido`)) AS pedidos_ano_anterior     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, YEAR(pv.`dataPedido`) ), VariacaoPercentual AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         ano,         quantidade_pedidos,         pedidos_ano_anterior,         CASE              WHEN pedidos_ano_anterior IS NOT NULL AND pedidos_ano_anterior > 0 THEN                 ROUND(((quantidade_pedidos - pedidos_ano_anterior) * 100.0 / pedidos_ano_anterior), 2)             ELSE NULL         END AS variacao_percentual     FROM          CrescimentoMarketPlace ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      ano = 2021 AND variacao_percentual IS NOT NULL ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING AVG(ip.precoVendido * ip.qtdePedida) > (     SELECT AVG(ip2.precoVendido * ip2.qtdePedida)     FROM ItensPedidoVenda ip2 );"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS quantidade_vendida FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      quantidade_vendida DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`qtdePedida` * ipv.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), Variacoes AS (     SELECT          va1.`idCategoria`,         va1.ano AS ano_atual,         va1.total_vendas AS vendas_atual,         va2.total_vendas AS vendas_anterior,         CASE              WHEN va2.total_vendas IS NOT NULL AND va2.total_vendas > 0 THEN                 ((va1.total_vendas - va2.total_vendas) / va2.total_vendas) * 100             ELSE NULL         END AS variacao_percentual     FROM VendasAnuais va1     LEFT JOIN VendasAnuais va2          ON va1.`idCategoria` = va2.`idCategoria`          AND va1.ano = va2.ano + 1 ) SELECT      c.`nomeCategoria`,     v.ano_atual,     v.variacao_percentual FROM Variacoes v JOIN `CategoriaProduto` c ON v.`idCategoria` = c.`idCategoria` ORDER BY c.`nomeCategoria`, v.ano_atual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS quantidade_pedidos,         LAG(COUNT(pv.`idPedido`)) OVER (PARTITION BY mp.`idMarketPlace` ORDER BY YEAR(pv.`dataPedido`)) AS pedidos_ano_anterior     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, YEAR(pv.`dataPedido`) ), VariacaoPercentual AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         ano,         quantidade_pedidos,         pedidos_ano_anterior,         CASE              WHEN pedidos_ano_anterior IS NOT NULL AND pedidos_ano_anterior > 0 THEN                 ROUND(((quantidade_pedidos - pedidos_ano_anterior) * 100.0 / pedidos_ano_anterior), 2)             ELSE NULL         END AS variacao_percentual     FROM          CrescimentoMarketPlace ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      ano = 2021 AND variacao_percentual IS NOT NULL ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING AVG(ip.precoVendido * ip.qtdePedida) > (     SELECT AVG(ip2.precoVendido * ip2.qtdePedida)     FROM ItensPedidoVenda ip2 );"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS quantidade_vendida FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      quantidade_vendida DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`qtdePedida` * ipv.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), Variacoes AS (     SELECT          va1.`idCategoria`,         va1.ano AS ano_atual,         va1.total_vendas AS vendas_atual,         va2.total_vendas AS vendas_anterior,         CASE              WHEN va2.total_vendas IS NOT NULL AND va2.total_vendas > 0 THEN                 ((va1.total_vendas - va2.total_vendas) / va2.total_vendas) * 100             ELSE NULL         END AS variacao_percentual     FROM VendasAnuais va1     LEFT JOIN VendasAnuais va2          ON va1.`idCategoria` = va2.`idCategoria`          AND va1.ano = va2.ano + 1 ) SELECT      c.`nomeCategoria`,     v.ano_atual,     v.variacao_percentual FROM Variacoes v JOIN `CategoriaProduto` c ON v.`idCategoria` = c.`idCategoria` ORDER BY c.`nomeCategoria`, v.ano_atual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS quantidade_pedidos,         LAG(COUNT(pv.`idPedido`)) OVER (PARTITION BY mp.`idMarketPlace` ORDER BY YEAR(pv.`dataPedido`)) AS pedidos_ano_anterior     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, YEAR(pv.`dataPedido`) ), VariacaoPercentual AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         ano,         quantidade_pedidos,         pedidos_ano_anterior,         CASE              WHEN pedidos_ano_anterior IS NOT NULL AND pedidos_ano_anterior > 0 THEN                 ROUND(((quantidade_pedidos - pedidos_ano_anterior) * 100.0 / pedidos_ano_anterior), 2)             ELSE NULL         END AS variacao_percentual     FROM          CrescimentoMarketPlace ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      ano = 2021 AND variacao_percentual IS NOT NULL ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING AVG(ip.precoVendido * ip.qtdePedida) > (     SELECT AVG(ip2.precoVendido * ip2.qtdePedida)     FROM ItensPedidoVenda ip2 );"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS quantidade_vendida FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      quantidade_vendida DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`qtdePedida` * ipv.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), Variacoes AS (     SELECT          va1.`idCategoria`,         va1.ano AS ano_atual,         va1.total_vendas AS vendas_atual,         va2.total_vendas AS vendas_anterior,         CASE              WHEN va2.total_vendas IS NOT NULL AND va2.total_vendas > 0 THEN                 ((va1.total_vendas - va2.total_vendas) / va2.total_vendas) * 100             ELSE NULL         END AS variacao_percentual     FROM VendasAnuais va1     LEFT JOIN VendasAnuais va2          ON va1.`idCategoria` = va2.`idCategoria`          AND va1.ano = va2.ano + 1 ) SELECT      c.`nomeCategoria`,     v.ano_atual,     v.variacao_percentual FROM Variacoes v JOIN `CategoriaProduto` c ON v.`idCategoria` = c.`idCategoria` ORDER BY c.`nomeCategoria`, v.ano_atual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS quantidade_pedidos,         LAG(COUNT(pv.`idPedido`)) OVER (PARTITION BY mp.`idMarketPlace` ORDER BY YEAR(pv.`dataPedido`)) AS pedidos_ano_anterior     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, YEAR(pv.`dataPedido`) ), VariacaoPercentual AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         ano,         quantidade_pedidos,         pedidos_ano_anterior,         CASE              WHEN pedidos_ano_anterior IS NOT NULL AND pedidos_ano_anterior > 0 THEN                 ROUND(((quantidade_pedidos - pedidos_ano_anterior) * 100.0 / pedidos_ano_anterior), 2)             ELSE NULL         END AS variacao_percentual     FROM          CrescimentoMarketPlace ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      ano = 2021 AND variacao_percentual IS NOT NULL ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING AVG(ip.precoVendido * ip.qtdePedida) > (     SELECT AVG(ip2.precoVendido * ip2.qtdePedida)     FROM ItensPedidoVenda ip2 );"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      Vendedor.nomeVendedor,      COUNT(PedidoVenda.idPedido) AS quantidade_vendas FROM      PedidoVenda JOIN      Vendedor ON PedidoVenda.idVendedor = Vendedor.idVendedor GROUP BY      Vendedor.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.numParcelas,     COUNT(*) AS numeroVendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.numParcelas ORDER BY ano, mes, numParcelas;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.`nomeSegmento`,     MONTH(pv.`dataPedido`) AS mes,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `Cliente` c ON pv.`idCliente` = c.`idCliente` JOIN `SegmentoCliente` sc ON c.`idSegmentoCliente` = sc.`idSegmentoCliente` WHERE YEAR(pv.`dataPedido`) = 2023 GROUP BY sc.`nomeSegmento`, MONTH(pv.`dataPedido`) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valor_total_vendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valor_total_vendas DESC) AS rank_venda     FROM VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valor_total_vendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.rank_venda <= 10 ORDER BY rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_venda     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComparedas AS (     SELECT          ano,         grupo_produto,         valor_venda,         LAG(valor_venda) OVER (PARTITION BY grupo_produto ORDER BY ano) AS valor_venda_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     CASE          WHEN valor_venda_anterior IS NOT NULL AND valor_venda_anterior <> 0 THEN             ROUND(((valor_venda - valor_venda_anterior) / valor_venda_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComparedas WHERE valor_venda_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdePedidos AS pedidos_2020,         c2.qtdePedidos AS pedidos_2021,         CASE              WHEN c1.qtdePedidos = 0 THEN NULL             ELSE ((c2.qtdePedidos - c1.qtdePedidos) * 100.0 / c1.qtdePedidos)         END AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.`nomeVendedor` FROM `Vendedor` v WHERE v.`idVendedor` NOT IN (     SELECT DISTINCT pv.`idVendedor`     FROM `PedidoVenda` pv     JOIN `Cliente` c ON pv.`idCliente` = c.`idCliente`     WHERE c.`estado` = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida)      FROM ItensPedidoVenda iv2      JOIN PedidoVenda pv ON iv2.idPedido = pv.idPedido) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_pedido_cliente > media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      Vendedor.nomeVendedor,      COUNT(PedidoVenda.idPedido) AS quantidade_vendas FROM      PedidoVenda JOIN      Vendedor ON PedidoVenda.idVendedor = Vendedor.idVendedor GROUP BY      Vendedor.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.numParcelas,     COUNT(*) AS numeroVendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.numParcelas ORDER BY ano, mes, numParcelas;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.`nomeSegmento`,     MONTH(pv.`dataPedido`) AS mes,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `Cliente` c ON pv.`idCliente` = c.`idCliente` JOIN `SegmentoCliente` sc ON c.`idSegmentoCliente` = sc.`idSegmentoCliente` WHERE YEAR(pv.`dataPedido`) = 2023 GROUP BY sc.`nomeSegmento`, MONTH(pv.`dataPedido`) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valor_total_vendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valor_total_vendas DESC) AS rank_venda     FROM VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valor_total_vendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.rank_venda <= 10 ORDER BY rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_venda     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComparedas AS (     SELECT          ano,         grupo_produto,         valor_venda,         LAG(valor_venda) OVER (PARTITION BY grupo_produto ORDER BY ano) AS valor_venda_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     CASE          WHEN valor_venda_anterior IS NOT NULL AND valor_venda_anterior <> 0 THEN             ROUND(((valor_venda - valor_venda_anterior) / valor_venda_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComparedas WHERE valor_venda_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdePedidos AS pedidos_2020,         c2.qtdePedidos AS pedidos_2021,         CASE              WHEN c1.qtdePedidos = 0 THEN NULL             ELSE ((c2.qtdePedidos - c1.qtdePedidos) * 100.0 / c1.qtdePedidos)         END AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.`nomeVendedor` FROM `Vendedor` v WHERE v.`idVendedor` NOT IN (     SELECT DISTINCT pv.`idVendedor`     FROM `PedidoVenda` pv     JOIN `Cliente` c ON pv.`idCliente` = c.`idCliente`     WHERE c.`estado` = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida)      FROM ItensPedidoVenda iv2      JOIN PedidoVenda pv ON iv2.idPedido = pv.idPedido) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_pedido_cliente > media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      Vendedor.nomeVendedor,      COUNT(PedidoVenda.idPedido) AS quantidade_vendas FROM      PedidoVenda JOIN      Vendedor ON PedidoVenda.idVendedor = Vendedor.idVendedor GROUP BY      Vendedor.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.numParcelas,     COUNT(*) AS numeroVendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.numParcelas ORDER BY ano, mes, numParcelas;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.`nomeSegmento`,     MONTH(pv.`dataPedido`) AS mes,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `Cliente` c ON pv.`idCliente` = c.`idCliente` JOIN `SegmentoCliente` sc ON c.`idSegmentoCliente` = sc.`idSegmentoCliente` WHERE YEAR(pv.`dataPedido`) = 2023 GROUP BY sc.`nomeSegmento`, MONTH(pv.`dataPedido`) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valor_total_vendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valor_total_vendas DESC) AS rank_venda     FROM VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valor_total_vendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.rank_venda <= 10 ORDER BY rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_venda     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComparedas AS (     SELECT          ano,         grupo_produto,         valor_venda,         LAG(valor_venda) OVER (PARTITION BY grupo_produto ORDER BY ano) AS valor_venda_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     CASE          WHEN valor_venda_anterior IS NOT NULL AND valor_venda_anterior <> 0 THEN             ROUND(((valor_venda - valor_venda_anterior) / valor_venda_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComparedas WHERE valor_venda_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdePedidos AS pedidos_2020,         c2.qtdePedidos AS pedidos_2021,         CASE              WHEN c1.qtdePedidos = 0 THEN NULL             ELSE ((c2.qtdePedidos - c1.qtdePedidos) * 100.0 / c1.qtdePedidos)         END AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.`nomeVendedor` FROM `Vendedor` v WHERE v.`idVendedor` NOT IN (     SELECT DISTINCT pv.`idVendedor`     FROM `PedidoVenda` pv     JOIN `Cliente` c ON pv.`idCliente` = c.`idCliente`     WHERE c.`estado` = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida)      FROM ItensPedidoVenda iv2      JOIN PedidoVenda pv ON iv2.idPedido = pv.idPedido) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_pedido_cliente > media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      Vendedor.nomeVendedor,      COUNT(PedidoVenda.idPedido) AS quantidade_vendas FROM      PedidoVenda JOIN      Vendedor ON PedidoVenda.idVendedor = Vendedor.idVendedor GROUP BY      Vendedor.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.numParcelas,     COUNT(*) AS numeroVendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.numParcelas ORDER BY ano, mes, numParcelas;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.`nomeSegmento`,     MONTH(pv.`dataPedido`) AS mes,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `Cliente` c ON pv.`idCliente` = c.`idCliente` JOIN `SegmentoCliente` sc ON c.`idSegmentoCliente` = sc.`idSegmentoCliente` WHERE YEAR(pv.`dataPedido`) = 2023 GROUP BY sc.`nomeSegmento`, MONTH(pv.`dataPedido`) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valor_total_vendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valor_total_vendas DESC) AS rank_venda     FROM VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valor_total_vendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.rank_venda <= 10 ORDER BY rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_venda     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComparedas AS (     SELECT          ano,         grupo_produto,         valor_venda,         LAG(valor_venda) OVER (PARTITION BY grupo_produto ORDER BY ano) AS valor_venda_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     CASE          WHEN valor_venda_anterior IS NOT NULL AND valor_venda_anterior <> 0 THEN             ROUND(((valor_venda - valor_venda_anterior) / valor_venda_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComparedas WHERE valor_venda_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdePedidos AS pedidos_2020,         c2.qtdePedidos AS pedidos_2021,         CASE              WHEN c1.qtdePedidos = 0 THEN NULL             ELSE ((c2.qtdePedidos - c1.qtdePedidos) * 100.0 / c1.qtdePedidos)         END AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.`nomeVendedor` FROM `Vendedor` v WHERE v.`idVendedor` NOT IN (     SELECT DISTINCT pv.`idVendedor`     FROM `PedidoVenda` pv     JOIN `Cliente` c ON pv.`idCliente` = c.`idCliente`     WHERE c.`estado` = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida)      FROM ItensPedidoVenda iv2      JOIN PedidoVenda pv ON iv2.idPedido = pv.idPedido) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_pedido_cliente > media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      Vendedor.nomeVendedor,      COUNT(PedidoVenda.idPedido) AS quantidade_vendas FROM      PedidoVenda JOIN      Vendedor ON PedidoVenda.idVendedor = Vendedor.idVendedor GROUP BY      Vendedor.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.numParcelas,     COUNT(*) AS numeroVendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.numParcelas ORDER BY ano, mes, numParcelas;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.`nomeSegmento`,     MONTH(pv.`dataPedido`) AS mes,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `Cliente` c ON pv.`idCliente` = c.`idCliente` JOIN `SegmentoCliente` sc ON c.`idSegmentoCliente` = sc.`idSegmentoCliente` WHERE YEAR(pv.`dataPedido`) = 2023 GROUP BY sc.`nomeSegmento`, MONTH(pv.`dataPedido`) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valor_total_vendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valor_total_vendas DESC) AS rank_venda     FROM VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valor_total_vendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.rank_venda <= 10 ORDER BY rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_venda     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComparedas AS (     SELECT          ano,         grupo_produto,         valor_venda,         LAG(valor_venda) OVER (PARTITION BY grupo_produto ORDER BY ano) AS valor_venda_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     CASE          WHEN valor_venda_anterior IS NOT NULL AND valor_venda_anterior <> 0 THEN             ROUND(((valor_venda - valor_venda_anterior) / valor_venda_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComparedas WHERE valor_venda_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdePedidos AS pedidos_2020,         c2.qtdePedidos AS pedidos_2021,         CASE              WHEN c1.qtdePedidos = 0 THEN NULL             ELSE ((c2.qtdePedidos - c1.qtdePedidos) * 100.0 / c1.qtdePedidos)         END AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.`nomeVendedor` FROM `Vendedor` v WHERE v.`idVendedor` NOT IN (     SELECT DISTINCT pv.`idVendedor`     FROM `PedidoVenda` pv     JOIN `Cliente` c ON pv.`idCliente` = c.`idCliente`     WHERE c.`estado` = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida)      FROM ItensPedidoVenda iv2      JOIN PedidoVenda pv ON iv2.idPedido = pv.idPedido) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_pedido_cliente > media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      Vendedor.nomeVendedor,      COUNT(PedidoVenda.idPedido) AS quantidade_vendas FROM      PedidoVenda JOIN      Vendedor ON PedidoVenda.idVendedor = Vendedor.idVendedor GROUP BY      Vendedor.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.numParcelas,     COUNT(*) AS numeroVendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.numParcelas ORDER BY ano, mes, numParcelas;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.`nomeSegmento`,     MONTH(pv.`dataPedido`) AS mes,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `Cliente` c ON pv.`idCliente` = c.`idCliente` JOIN `SegmentoCliente` sc ON c.`idSegmentoCliente` = sc.`idSegmentoCliente` WHERE YEAR(pv.`dataPedido`) = 2023 GROUP BY sc.`nomeSegmento`, MONTH(pv.`dataPedido`) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valor_total_vendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valor_total_vendas DESC) AS rank_venda     FROM VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valor_total_vendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.rank_venda <= 10 ORDER BY rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_venda     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComparedas AS (     SELECT          ano,         grupo_produto,         valor_venda,         LAG(valor_venda) OVER (PARTITION BY grupo_produto ORDER BY ano) AS valor_venda_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     CASE          WHEN valor_venda_anterior IS NOT NULL AND valor_venda_anterior <> 0 THEN             ROUND(((valor_venda - valor_venda_anterior) / valor_venda_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComparedas WHERE valor_venda_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdePedidos AS pedidos_2020,         c2.qtdePedidos AS pedidos_2021,         CASE              WHEN c1.qtdePedidos = 0 THEN NULL             ELSE ((c2.qtdePedidos - c1.qtdePedidos) * 100.0 / c1.qtdePedidos)         END AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.`nomeVendedor` FROM `Vendedor` v WHERE v.`idVendedor` NOT IN (     SELECT DISTINCT pv.`idVendedor`     FROM `PedidoVenda` pv     JOIN `Cliente` c ON pv.`idCliente` = c.`idCliente`     WHERE c.`estado` = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida)      FROM ItensPedidoVenda iv2      JOIN PedidoVenda pv ON iv2.idPedido = pv.idPedido) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_pedido_cliente > media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      Vendedor.nomeVendedor,      COUNT(PedidoVenda.idPedido) AS quantidade_vendas FROM      PedidoVenda JOIN      Vendedor ON PedidoVenda.idVendedor = Vendedor.idVendedor GROUP BY      Vendedor.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.numParcelas,     COUNT(*) AS numeroVendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.numParcelas ORDER BY ano, mes, numParcelas;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.`nomeSegmento`,     MONTH(pv.`dataPedido`) AS mes,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `Cliente` c ON pv.`idCliente` = c.`idCliente` JOIN `SegmentoCliente` sc ON c.`idSegmentoCliente` = sc.`idSegmentoCliente` WHERE YEAR(pv.`dataPedido`) = 2023 GROUP BY sc.`nomeSegmento`, MONTH(pv.`dataPedido`) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valor_total_vendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valor_total_vendas DESC) AS rank_venda     FROM VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valor_total_vendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.rank_venda <= 10 ORDER BY rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_venda     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComparedas AS (     SELECT          ano,         grupo_produto,         valor_venda,         LAG(valor_venda) OVER (PARTITION BY grupo_produto ORDER BY ano) AS valor_venda_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     CASE          WHEN valor_venda_anterior IS NOT NULL AND valor_venda_anterior <> 0 THEN             ROUND(((valor_venda - valor_venda_anterior) / valor_venda_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComparedas WHERE valor_venda_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdePedidos AS pedidos_2020,         c2.qtdePedidos AS pedidos_2021,         CASE              WHEN c1.qtdePedidos = 0 THEN NULL             ELSE ((c2.qtdePedidos - c1.qtdePedidos) * 100.0 / c1.qtdePedidos)         END AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.`nomeVendedor` FROM `Vendedor` v WHERE v.`idVendedor` NOT IN (     SELECT DISTINCT pv.`idVendedor`     FROM `PedidoVenda` pv     JOIN `Cliente` c ON pv.`idCliente` = c.`idCliente`     WHERE c.`estado` = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida)      FROM ItensPedidoVenda iv2      JOIN PedidoVenda pv ON iv2.idPedido = pv.idPedido) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_pedido_cliente > media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      Vendedor.nomeVendedor,      COUNT(PedidoVenda.idPedido) AS quantidade_vendas FROM      PedidoVenda JOIN      Vendedor ON PedidoVenda.idVendedor = Vendedor.idVendedor GROUP BY      Vendedor.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.numParcelas,     COUNT(*) AS numeroVendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.numParcelas ORDER BY ano, mes, numParcelas;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.`nomeSegmento`,     MONTH(pv.`dataPedido`) AS mes,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `Cliente` c ON pv.`idCliente` = c.`idCliente` JOIN `SegmentoCliente` sc ON c.`idSegmentoCliente` = sc.`idSegmentoCliente` WHERE YEAR(pv.`dataPedido`) = 2023 GROUP BY sc.`nomeSegmento`, MONTH(pv.`dataPedido`) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valor_total_vendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valor_total_vendas DESC) AS rank_venda     FROM VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valor_total_vendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.rank_venda <= 10 ORDER BY rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_venda     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComparedas AS (     SELECT          ano,         grupo_produto,         valor_venda,         LAG(valor_venda) OVER (PARTITION BY grupo_produto ORDER BY ano) AS valor_venda_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     CASE          WHEN valor_venda_anterior IS NOT NULL AND valor_venda_anterior <> 0 THEN             ROUND(((valor_venda - valor_venda_anterior) / valor_venda_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComparedas WHERE valor_venda_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdePedidos AS pedidos_2020,         c2.qtdePedidos AS pedidos_2021,         CASE              WHEN c1.qtdePedidos = 0 THEN NULL             ELSE ((c2.qtdePedidos - c1.qtdePedidos) * 100.0 / c1.qtdePedidos)         END AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.`nomeVendedor` FROM `Vendedor` v WHERE v.`idVendedor` NOT IN (     SELECT DISTINCT pv.`idVendedor`     FROM `PedidoVenda` pv     JOIN `Cliente` c ON pv.`idCliente` = c.`idCliente`     WHERE c.`estado` = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida)      FROM ItensPedidoVenda iv2      JOIN PedidoVenda pv ON iv2.idPedido = pv.idPedido) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_pedido_cliente > media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      Vendedor.nomeVendedor,      COUNT(PedidoVenda.idPedido) AS quantidade_vendas FROM      PedidoVenda JOIN      Vendedor ON PedidoVenda.idVendedor = Vendedor.idVendedor GROUP BY      Vendedor.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.numParcelas,     COUNT(*) AS numeroVendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.numParcelas ORDER BY ano, mes, numParcelas;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.`nomeSegmento`,     MONTH(pv.`dataPedido`) AS mes,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `Cliente` c ON pv.`idCliente` = c.`idCliente` JOIN `SegmentoCliente` sc ON c.`idSegmentoCliente` = sc.`idSegmentoCliente` WHERE YEAR(pv.`dataPedido`) = 2023 GROUP BY sc.`nomeSegmento`, MONTH(pv.`dataPedido`) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valor_total_vendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valor_total_vendas DESC) AS rank_venda     FROM VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valor_total_vendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.rank_venda <= 10 ORDER BY rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_venda     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComparedas AS (     SELECT          ano,         grupo_produto,         valor_venda,         LAG(valor_venda) OVER (PARTITION BY grupo_produto ORDER BY ano) AS valor_venda_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     CASE          WHEN valor_venda_anterior IS NOT NULL AND valor_venda_anterior <> 0 THEN             ROUND(((valor_venda - valor_venda_anterior) / valor_venda_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComparedas WHERE valor_venda_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdePedidos AS pedidos_2020,         c2.qtdePedidos AS pedidos_2021,         CASE              WHEN c1.qtdePedidos = 0 THEN NULL             ELSE ((c2.qtdePedidos - c1.qtdePedidos) * 100.0 / c1.qtdePedidos)         END AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.`nomeVendedor` FROM `Vendedor` v WHERE v.`idVendedor` NOT IN (     SELECT DISTINCT pv.`idVendedor`     FROM `PedidoVenda` pv     JOIN `Cliente` c ON pv.`idCliente` = c.`idCliente`     WHERE c.`estado` = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida)      FROM ItensPedidoVenda iv2      JOIN PedidoVenda pv ON iv2.idPedido = pv.idPedido) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_pedido_cliente > media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      Vendedor.nomeVendedor,      COUNT(PedidoVenda.idPedido) AS quantidade_vendas FROM      PedidoVenda JOIN      Vendedor ON PedidoVenda.idVendedor = Vendedor.idVendedor GROUP BY      Vendedor.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.numParcelas,     COUNT(*) AS numeroVendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.numParcelas ORDER BY ano, mes, numParcelas;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.`nomeSegmento`,     MONTH(pv.`dataPedido`) AS mes,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `Cliente` c ON pv.`idCliente` = c.`idCliente` JOIN `SegmentoCliente` sc ON c.`idSegmentoCliente` = sc.`idSegmentoCliente` WHERE YEAR(pv.`dataPedido`) = 2023 GROUP BY sc.`nomeSegmento`, MONTH(pv.`dataPedido`) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valor_total_vendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valor_total_vendas DESC) AS rank_venda     FROM VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valor_total_vendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.rank_venda <= 10 ORDER BY rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_venda     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComparedas AS (     SELECT          ano,         grupo_produto,         valor_venda,         LAG(valor_venda) OVER (PARTITION BY grupo_produto ORDER BY ano) AS valor_venda_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     CASE          WHEN valor_venda_anterior IS NOT NULL AND valor_venda_anterior <> 0 THEN             ROUND(((valor_venda - valor_venda_anterior) / valor_venda_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComparedas WHERE valor_venda_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdePedidos AS pedidos_2020,         c2.qtdePedidos AS pedidos_2021,         CASE              WHEN c1.qtdePedidos = 0 THEN NULL             ELSE ((c2.qtdePedidos - c1.qtdePedidos) * 100.0 / c1.qtdePedidos)         END AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.`nomeVendedor` FROM `Vendedor` v WHERE v.`idVendedor` NOT IN (     SELECT DISTINCT pv.`idVendedor`     FROM `PedidoVenda` pv     JOIN `Cliente` c ON pv.`idCliente` = c.`idCliente`     WHERE c.`estado` = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida)      FROM ItensPedidoVenda iv2      JOIN PedidoVenda pv ON iv2.idPedido = pv.idPedido) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_pedido_cliente > media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      Vendedor.nomeVendedor,      COUNT(PedidoVenda.idPedido) AS quantidade_vendas FROM      PedidoVenda JOIN      Vendedor ON PedidoVenda.idVendedor = Vendedor.idVendedor GROUP BY      Vendedor.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.numParcelas,     COUNT(*) AS numeroVendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.numParcelas ORDER BY ano, mes, numParcelas;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.`nomeSegmento`,     MONTH(pv.`dataPedido`) AS mes,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `Cliente` c ON pv.`idCliente` = c.`idCliente` JOIN `SegmentoCliente` sc ON c.`idSegmentoCliente` = sc.`idSegmentoCliente` WHERE YEAR(pv.`dataPedido`) = 2023 GROUP BY sc.`nomeSegmento`, MONTH(pv.`dataPedido`) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valor_total_vendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valor_total_vendas DESC) AS rank_venda     FROM VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valor_total_vendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.rank_venda <= 10 ORDER BY rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_venda     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComparedas AS (     SELECT          ano,         grupo_produto,         valor_venda,         LAG(valor_venda) OVER (PARTITION BY grupo_produto ORDER BY ano) AS valor_venda_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     CASE          WHEN valor_venda_anterior IS NOT NULL AND valor_venda_anterior <> 0 THEN             ROUND(((valor_venda - valor_venda_anterior) / valor_venda_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComparedas WHERE valor_venda_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdePedidos AS pedidos_2020,         c2.qtdePedidos AS pedidos_2021,         CASE              WHEN c1.qtdePedidos = 0 THEN NULL             ELSE ((c2.qtdePedidos - c1.qtdePedidos) * 100.0 / c1.qtdePedidos)         END AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.`nomeVendedor` FROM `Vendedor` v WHERE v.`idVendedor` NOT IN (     SELECT DISTINCT pv.`idVendedor`     FROM `PedidoVenda` pv     JOIN `Cliente` c ON pv.`idCliente` = c.`idCliente`     WHERE c.`estado` = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida)      FROM ItensPedidoVenda iv2      JOIN PedidoVenda pv ON iv2.idPedido = pv.idPedido) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_pedido_cliente > media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      Vendedor.nomeVendedor,      COUNT(PedidoVenda.idPedido) AS quantidade_vendas FROM      PedidoVenda JOIN      Vendedor ON PedidoVenda.idVendedor = Vendedor.idVendedor GROUP BY      Vendedor.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.numParcelas,     COUNT(*) AS numeroVendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.numParcelas ORDER BY ano, mes, numParcelas;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.`nomeSegmento`,     MONTH(pv.`dataPedido`) AS mes,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `Cliente` c ON pv.`idCliente` = c.`idCliente` JOIN `SegmentoCliente` sc ON c.`idSegmentoCliente` = sc.`idSegmentoCliente` WHERE YEAR(pv.`dataPedido`) = 2023 GROUP BY sc.`nomeSegmento`, MONTH(pv.`dataPedido`) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valor_total_vendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valor_total_vendas DESC) AS rank_venda     FROM VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valor_total_vendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.rank_venda <= 10 ORDER BY rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_venda     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComparedas AS (     SELECT          ano,         grupo_produto,         valor_venda,         LAG(valor_venda) OVER (PARTITION BY grupo_produto ORDER BY ano) AS valor_venda_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     CASE          WHEN valor_venda_anterior IS NOT NULL AND valor_venda_anterior <> 0 THEN             ROUND(((valor_venda - valor_venda_anterior) / valor_venda_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComparedas WHERE valor_venda_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdePedidos AS pedidos_2020,         c2.qtdePedidos AS pedidos_2021,         CASE              WHEN c1.qtdePedidos = 0 THEN NULL             ELSE ((c2.qtdePedidos - c1.qtdePedidos) * 100.0 / c1.qtdePedidos)         END AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.`nomeVendedor` FROM `Vendedor` v WHERE v.`idVendedor` NOT IN (     SELECT DISTINCT pv.`idVendedor`     FROM `PedidoVenda` pv     JOIN `Cliente` c ON pv.`idCliente` = c.`idCliente`     WHERE c.`estado` = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida)      FROM ItensPedidoVenda iv2      JOIN PedidoVenda pv ON iv2.idPedido = pv.idPedido) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_pedido_cliente > media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      Vendedor.nomeVendedor,      COUNT(PedidoVenda.idPedido) AS quantidade_vendas FROM      PedidoVenda JOIN      Vendedor ON PedidoVenda.idVendedor = Vendedor.idVendedor GROUP BY      Vendedor.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.numParcelas,     COUNT(*) AS numeroVendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.numParcelas ORDER BY ano, mes, numParcelas;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.`nomeSegmento`,     MONTH(pv.`dataPedido`) AS mes,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `Cliente` c ON pv.`idCliente` = c.`idCliente` JOIN `SegmentoCliente` sc ON c.`idSegmentoCliente` = sc.`idSegmentoCliente` WHERE YEAR(pv.`dataPedido`) = 2023 GROUP BY sc.`nomeSegmento`, MONTH(pv.`dataPedido`) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valor_total_vendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valor_total_vendas DESC) AS rank_venda     FROM VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valor_total_vendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.rank_venda <= 10 ORDER BY rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_venda     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComparedas AS (     SELECT          ano,         grupo_produto,         valor_venda,         LAG(valor_venda) OVER (PARTITION BY grupo_produto ORDER BY ano) AS valor_venda_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     CASE          WHEN valor_venda_anterior IS NOT NULL AND valor_venda_anterior <> 0 THEN             ROUND(((valor_venda - valor_venda_anterior) / valor_venda_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComparedas WHERE valor_venda_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdePedidos AS pedidos_2020,         c2.qtdePedidos AS pedidos_2021,         CASE              WHEN c1.qtdePedidos = 0 THEN NULL             ELSE ((c2.qtdePedidos - c1.qtdePedidos) * 100.0 / c1.qtdePedidos)         END AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.`nomeVendedor` FROM `Vendedor` v WHERE v.`idVendedor` NOT IN (     SELECT DISTINCT pv.`idVendedor`     FROM `PedidoVenda` pv     JOIN `Cliente` c ON pv.`idCliente` = c.`idCliente`     WHERE c.`estado` = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida)      FROM ItensPedidoVenda iv2      JOIN PedidoVenda pv ON iv2.idPedido = pv.idPedido) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_pedido_cliente > media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      Vendedor.nomeVendedor,      COUNT(PedidoVenda.idPedido) AS quantidade_vendas FROM      PedidoVenda JOIN      Vendedor ON PedidoVenda.idVendedor = Vendedor.idVendedor GROUP BY      Vendedor.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.numParcelas,     COUNT(*) AS numeroVendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.numParcelas ORDER BY ano, mes, numParcelas;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.`nomeSegmento`,     MONTH(pv.`dataPedido`) AS mes,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `Cliente` c ON pv.`idCliente` = c.`idCliente` JOIN `SegmentoCliente` sc ON c.`idSegmentoCliente` = sc.`idSegmentoCliente` WHERE YEAR(pv.`dataPedido`) = 2023 GROUP BY sc.`nomeSegmento`, MONTH(pv.`dataPedido`) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valor_total_vendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valor_total_vendas DESC) AS rank_venda     FROM VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valor_total_vendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.rank_venda <= 10 ORDER BY rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_venda     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComparedas AS (     SELECT          ano,         grupo_produto,         valor_venda,         LAG(valor_venda) OVER (PARTITION BY grupo_produto ORDER BY ano) AS valor_venda_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     CASE          WHEN valor_venda_anterior IS NOT NULL AND valor_venda_anterior <> 0 THEN             ROUND(((valor_venda - valor_venda_anterior) / valor_venda_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComparedas WHERE valor_venda_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdePedidos AS pedidos_2020,         c2.qtdePedidos AS pedidos_2021,         CASE              WHEN c1.qtdePedidos = 0 THEN NULL             ELSE ((c2.qtdePedidos - c1.qtdePedidos) * 100.0 / c1.qtdePedidos)         END AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.`nomeVendedor` FROM `Vendedor` v WHERE v.`idVendedor` NOT IN (     SELECT DISTINCT pv.`idVendedor`     FROM `PedidoVenda` pv     JOIN `Cliente` c ON pv.`idCliente` = c.`idCliente`     WHERE c.`estado` = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida)      FROM ItensPedidoVenda iv2      JOIN PedidoVenda pv ON iv2.idPedido = pv.idPedido) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_pedido_cliente > media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      Vendedor.nomeVendedor,      COUNT(PedidoVenda.idPedido) AS quantidade_vendas FROM      PedidoVenda JOIN      Vendedor ON PedidoVenda.idVendedor = Vendedor.idVendedor GROUP BY      Vendedor.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.numParcelas,     COUNT(*) AS numeroVendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.numParcelas ORDER BY ano, mes, numParcelas;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.`nomeSegmento`,     MONTH(pv.`dataPedido`) AS mes,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `Cliente` c ON pv.`idCliente` = c.`idCliente` JOIN `SegmentoCliente` sc ON c.`idSegmentoCliente` = sc.`idSegmentoCliente` WHERE YEAR(pv.`dataPedido`) = 2023 GROUP BY sc.`nomeSegmento`, MONTH(pv.`dataPedido`) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valor_total_vendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valor_total_vendas DESC) AS rank_venda     FROM VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valor_total_vendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.rank_venda <= 10 ORDER BY rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_venda     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComparedas AS (     SELECT          ano,         grupo_produto,         valor_venda,         LAG(valor_venda) OVER (PARTITION BY grupo_produto ORDER BY ano) AS valor_venda_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     CASE          WHEN valor_venda_anterior IS NOT NULL AND valor_venda_anterior <> 0 THEN             ROUND(((valor_venda - valor_venda_anterior) / valor_venda_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComparedas WHERE valor_venda_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdePedidos AS pedidos_2020,         c2.qtdePedidos AS pedidos_2021,         CASE              WHEN c1.qtdePedidos = 0 THEN NULL             ELSE ((c2.qtdePedidos - c1.qtdePedidos) * 100.0 / c1.qtdePedidos)         END AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.`nomeVendedor` FROM `Vendedor` v WHERE v.`idVendedor` NOT IN (     SELECT DISTINCT pv.`idVendedor`     FROM `PedidoVenda` pv     JOIN `Cliente` c ON pv.`idCliente` = c.`idCliente`     WHERE c.`estado` = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida)      FROM ItensPedidoVenda iv2      JOIN PedidoVenda pv ON iv2.idPedido = pv.idPedido) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_pedido_cliente > media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      Vendedor.nomeVendedor,      COUNT(PedidoVenda.idPedido) AS quantidade_vendas FROM      PedidoVenda JOIN      Vendedor ON PedidoVenda.idVendedor = Vendedor.idVendedor GROUP BY      Vendedor.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.numParcelas,     COUNT(*) AS numeroVendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.numParcelas ORDER BY ano, mes, numParcelas;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.`nomeSegmento`,     MONTH(pv.`dataPedido`) AS mes,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `Cliente` c ON pv.`idCliente` = c.`idCliente` JOIN `SegmentoCliente` sc ON c.`idSegmentoCliente` = sc.`idSegmentoCliente` WHERE YEAR(pv.`dataPedido`) = 2023 GROUP BY sc.`nomeSegmento`, MONTH(pv.`dataPedido`) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valor_total_vendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valor_total_vendas DESC) AS rank_venda     FROM VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valor_total_vendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.rank_venda <= 10 ORDER BY rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_venda     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComparedas AS (     SELECT          ano,         grupo_produto,         valor_venda,         LAG(valor_venda) OVER (PARTITION BY grupo_produto ORDER BY ano) AS valor_venda_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     CASE          WHEN valor_venda_anterior IS NOT NULL AND valor_venda_anterior <> 0 THEN             ROUND(((valor_venda - valor_venda_anterior) / valor_venda_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComparedas WHERE valor_venda_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdePedidos AS pedidos_2020,         c2.qtdePedidos AS pedidos_2021,         CASE              WHEN c1.qtdePedidos = 0 THEN NULL             ELSE ((c2.qtdePedidos - c1.qtdePedidos) * 100.0 / c1.qtdePedidos)         END AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.`nomeVendedor` FROM `Vendedor` v WHERE v.`idVendedor` NOT IN (     SELECT DISTINCT pv.`idVendedor`     FROM `PedidoVenda` pv     JOIN `Cliente` c ON pv.`idCliente` = c.`idCliente`     WHERE c.`estado` = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida)      FROM ItensPedidoVenda iv2      JOIN PedidoVenda pv ON iv2.idPedido = pv.idPedido) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_pedido_cliente > media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      Vendedor.nomeVendedor,      COUNT(PedidoVenda.idPedido) AS quantidade_vendas FROM      PedidoVenda JOIN      Vendedor ON PedidoVenda.idVendedor = Vendedor.idVendedor GROUP BY      Vendedor.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.numParcelas,     COUNT(*) AS numeroVendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.numParcelas ORDER BY ano, mes, numParcelas;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.`nomeSegmento`,     MONTH(pv.`dataPedido`) AS mes,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `Cliente` c ON pv.`idCliente` = c.`idCliente` JOIN `SegmentoCliente` sc ON c.`idSegmentoCliente` = sc.`idSegmentoCliente` WHERE YEAR(pv.`dataPedido`) = 2023 GROUP BY sc.`nomeSegmento`, MONTH(pv.`dataPedido`) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valor_total_vendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valor_total_vendas DESC) AS rank_venda     FROM VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valor_total_vendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.rank_venda <= 10 ORDER BY rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_venda     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComparedas AS (     SELECT          ano,         grupo_produto,         valor_venda,         LAG(valor_venda) OVER (PARTITION BY grupo_produto ORDER BY ano) AS valor_venda_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     CASE          WHEN valor_venda_anterior IS NOT NULL AND valor_venda_anterior <> 0 THEN             ROUND(((valor_venda - valor_venda_anterior) / valor_venda_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComparedas WHERE valor_venda_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdePedidos AS pedidos_2020,         c2.qtdePedidos AS pedidos_2021,         CASE              WHEN c1.qtdePedidos = 0 THEN NULL             ELSE ((c2.qtdePedidos - c1.qtdePedidos) * 100.0 / c1.qtdePedidos)         END AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.`nomeVendedor` FROM `Vendedor` v WHERE v.`idVendedor` NOT IN (     SELECT DISTINCT pv.`idVendedor`     FROM `PedidoVenda` pv     JOIN `Cliente` c ON pv.`idCliente` = c.`idCliente`     WHERE c.`estado` = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida)      FROM ItensPedidoVenda iv2      JOIN PedidoVenda pv ON iv2.idPedido = pv.idPedido) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_pedido_cliente > media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      Vendedor.nomeVendedor,      COUNT(PedidoVenda.idPedido) AS quantidade_vendas FROM      PedidoVenda JOIN      Vendedor ON PedidoVenda.idVendedor = Vendedor.idVendedor GROUP BY      Vendedor.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.numParcelas,     COUNT(*) AS numeroVendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.numParcelas ORDER BY ano, mes, numParcelas;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.`nomeSegmento`,     MONTH(pv.`dataPedido`) AS mes,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `Cliente` c ON pv.`idCliente` = c.`idCliente` JOIN `SegmentoCliente` sc ON c.`idSegmentoCliente` = sc.`idSegmentoCliente` WHERE YEAR(pv.`dataPedido`) = 2023 GROUP BY sc.`nomeSegmento`, MONTH(pv.`dataPedido`) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valor_total_vendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valor_total_vendas DESC) AS rank_venda     FROM VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valor_total_vendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.rank_venda <= 10 ORDER BY rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_venda     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComparedas AS (     SELECT          ano,         grupo_produto,         valor_venda,         LAG(valor_venda) OVER (PARTITION BY grupo_produto ORDER BY ano) AS valor_venda_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     CASE          WHEN valor_venda_anterior IS NOT NULL AND valor_venda_anterior <> 0 THEN             ROUND(((valor_venda - valor_venda_anterior) / valor_venda_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComparedas WHERE valor_venda_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdePedidos AS pedidos_2020,         c2.qtdePedidos AS pedidos_2021,         CASE              WHEN c1.qtdePedidos = 0 THEN NULL             ELSE ((c2.qtdePedidos - c1.qtdePedidos) * 100.0 / c1.qtdePedidos)         END AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.`nomeVendedor` FROM `Vendedor` v WHERE v.`idVendedor` NOT IN (     SELECT DISTINCT pv.`idVendedor`     FROM `PedidoVenda` pv     JOIN `Cliente` c ON pv.`idCliente` = c.`idCliente`     WHERE c.`estado` = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida)      FROM ItensPedidoVenda iv2      JOIN PedidoVenda pv ON iv2.idPedido = pv.idPedido) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_pedido_cliente > media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      Vendedor.nomeVendedor,      COUNT(PedidoVenda.idPedido) AS quantidade_vendas FROM      PedidoVenda JOIN      Vendedor ON PedidoVenda.idVendedor = Vendedor.idVendedor GROUP BY      Vendedor.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.numParcelas,     COUNT(*) AS numeroVendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.numParcelas ORDER BY ano, mes, numParcelas;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.`nomeSegmento`,     MONTH(pv.`dataPedido`) AS mes,     COUNT(*) AS quantidade_vendas FROM `PedidoVenda` pv JOIN `Cliente` c ON pv.`idCliente` = c.`idCliente` JOIN `SegmentoCliente` sc ON c.`idSegmentoCliente` = sc.`idSegmentoCliente` WHERE YEAR(pv.`dataPedido`) = 2023 GROUP BY sc.`nomeSegmento`, MONTH(pv.`dataPedido`) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valor_total_vendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valor_total_vendas DESC) AS rank_venda     FROM VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valor_total_vendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.rank_venda <= 10 ORDER BY rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_venda     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComparedas AS (     SELECT          ano,         grupo_produto,         valor_venda,         LAG(valor_venda) OVER (PARTITION BY grupo_produto ORDER BY ano) AS valor_venda_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     CASE          WHEN valor_venda_anterior IS NOT NULL AND valor_venda_anterior <> 0 THEN             ROUND(((valor_venda - valor_venda_anterior) / valor_venda_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComparedas WHERE valor_venda_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdePedidos AS pedidos_2020,         c2.qtdePedidos AS pedidos_2021,         CASE              WHEN c1.qtdePedidos = 0 THEN NULL             ELSE ((c2.qtdePedidos - c1.qtdePedidos) * 100.0 / c1.qtdePedidos)         END AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual WHERE      variacao_percentual = (SELECT MAX(variacao_percentual) FROM VariacaoPercentual);"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.`nomeVendedor` FROM `Vendedor` v WHERE v.`idVendedor` NOT IN (     SELECT DISTINCT pv.`idVendedor`     FROM `PedidoVenda` pv     JOIN `Cliente` c ON pv.`idCliente` = c.`idCliente`     WHERE c.`estado` = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(iv.precoVendido * iv.qtdePedida) AS media_pedido_cliente,     (SELECT AVG(iv2.precoVendido * iv2.qtdePedida)      FROM ItensPedidoVenda iv2      JOIN PedidoVenda pv ON iv2.idPedido = pv.idPedido) AS media_pedido_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda iv ON pv.idPedido = iv.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_pedido_cliente > media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.dataPedido) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.dataPedido), DAYOFWEEK(pv.dataPedido) ORDER BY      DAYOFWEEK(pv.dataPedido);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valor_total_vendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valor_total_vendas DESC) AS rn     FROM VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valor_total_vendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.rn <= 10 ORDER BY rv.ano, rv.valor_total_vendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ip.`qtdePedida` * ip.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     JOIN `Produto` p ON ip.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), VendasComPivo AS (     SELECT          va1.`idCategoria`,         va1.ano AS ano_atual,         va1.total_vendas AS vendas_atual,         va2.total_vendas AS vendas_anterior     FROM VendasAnuais va1     LEFT JOIN VendasAnuais va2 ON va1.`idCategoria` = va2.`idCategoria` AND va1.ano = va2.ano + 1 ) SELECT      c.`nomeCategoria`,     ROUND(         CASE              WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0              THEN ((vendas_atual - vendas_anterior) / vendas_anterior) * 100              ELSE 0          END, 2     ) AS variacao_percentual FROM VendasComPivo v JOIN `CategoriaProduto` c ON v.`idCategoria` = c.`idCategoria` ORDER BY v.ano_atual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), Variacao AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         MAX(CASE WHEN ano = 2021 THEN qtdePedidos END) AS pedidos_2021,         MAX(CASE WHEN ano = 2020 THEN qtdePedidos END) AS pedidos_2020     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     ROUND(         ((pedidos_2021 - pedidos_2020) * 100.0 / pedidos_2020),          2     ) AS variacao_percentual FROM      Variacao WHERE      pedidos_2020 IS NOT NULL AND pedidos_2021 IS NOT NULL ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaCliente AS (     SELECT          pv.`idCliente`,         AVG(iv.`precoVendido` * iv.`qtdePedida`) AS media_pedido_cliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` iv ON pv.`idPedido` = iv.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(iv.`precoVendido` * iv.`qtdePedida`) AS media_pedido_geral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` iv ON pv.`idPedido` = iv.`idPedido` ) SELECT      mc.`idCliente`,     mc.media_pedido_cliente,     mg.media_pedido_geral FROM      MediaCliente mc CROSS JOIN      MediaGeral mg WHERE      mc.media_pedido_cliente > mg.media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.dataPedido) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.dataPedido), DAYOFWEEK(pv.dataPedido) ORDER BY      DAYOFWEEK(pv.dataPedido);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valor_total_vendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valor_total_vendas DESC) AS rn     FROM VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valor_total_vendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.rn <= 10 ORDER BY rv.ano, rv.valor_total_vendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ip.`qtdePedida` * ip.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     JOIN `Produto` p ON ip.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), VendasComPivo AS (     SELECT          va1.`idCategoria`,         va1.ano AS ano_atual,         va1.total_vendas AS vendas_atual,         va2.total_vendas AS vendas_anterior     FROM VendasAnuais va1     LEFT JOIN VendasAnuais va2 ON va1.`idCategoria` = va2.`idCategoria` AND va1.ano = va2.ano + 1 ) SELECT      c.`nomeCategoria`,     ROUND(         CASE              WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0              THEN ((vendas_atual - vendas_anterior) / vendas_anterior) * 100              ELSE 0          END, 2     ) AS variacao_percentual FROM VendasComPivo v JOIN `CategoriaProduto` c ON v.`idCategoria` = c.`idCategoria` ORDER BY v.ano_atual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), Variacao AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         MAX(CASE WHEN ano = 2021 THEN qtdePedidos END) AS pedidos_2021,         MAX(CASE WHEN ano = 2020 THEN qtdePedidos END) AS pedidos_2020     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     ROUND(         ((pedidos_2021 - pedidos_2020) * 100.0 / pedidos_2020),          2     ) AS variacao_percentual FROM      Variacao WHERE      pedidos_2020 IS NOT NULL AND pedidos_2021 IS NOT NULL ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaCliente AS (     SELECT          pv.`idCliente`,         AVG(iv.`precoVendido` * iv.`qtdePedida`) AS media_pedido_cliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` iv ON pv.`idPedido` = iv.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(iv.`precoVendido` * iv.`qtdePedida`) AS media_pedido_geral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` iv ON pv.`idPedido` = iv.`idPedido` ) SELECT      mc.`idCliente`,     mc.media_pedido_cliente,     mg.media_pedido_geral FROM      MediaCliente mc CROSS JOIN      MediaGeral mg WHERE      mc.media_pedido_cliente > mg.media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.dataPedido) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.dataPedido), DAYOFWEEK(pv.dataPedido) ORDER BY      DAYOFWEEK(pv.dataPedido);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valor_total_vendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valor_total_vendas DESC) AS rn     FROM VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valor_total_vendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.rn <= 10 ORDER BY rv.ano, rv.valor_total_vendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ip.`qtdePedida` * ip.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     JOIN `Produto` p ON ip.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), VendasComPivo AS (     SELECT          va1.`idCategoria`,         va1.ano AS ano_atual,         va1.total_vendas AS vendas_atual,         va2.total_vendas AS vendas_anterior     FROM VendasAnuais va1     LEFT JOIN VendasAnuais va2 ON va1.`idCategoria` = va2.`idCategoria` AND va1.ano = va2.ano + 1 ) SELECT      c.`nomeCategoria`,     ROUND(         CASE              WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0              THEN ((vendas_atual - vendas_anterior) / vendas_anterior) * 100              ELSE 0          END, 2     ) AS variacao_percentual FROM VendasComPivo v JOIN `CategoriaProduto` c ON v.`idCategoria` = c.`idCategoria` ORDER BY v.ano_atual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), Variacao AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         MAX(CASE WHEN ano = 2021 THEN qtdePedidos END) AS pedidos_2021,         MAX(CASE WHEN ano = 2020 THEN qtdePedidos END) AS pedidos_2020     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     ROUND(         ((pedidos_2021 - pedidos_2020) * 100.0 / pedidos_2020),          2     ) AS variacao_percentual FROM      Variacao WHERE      pedidos_2020 IS NOT NULL AND pedidos_2021 IS NOT NULL ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaCliente AS (     SELECT          pv.`idCliente`,         AVG(iv.`precoVendido` * iv.`qtdePedida`) AS media_pedido_cliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` iv ON pv.`idPedido` = iv.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(iv.`precoVendido` * iv.`qtdePedida`) AS media_pedido_geral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` iv ON pv.`idPedido` = iv.`idPedido` ) SELECT      mc.`idCliente`,     mc.media_pedido_cliente,     mg.media_pedido_geral FROM      MediaCliente mc CROSS JOIN      MediaGeral mg WHERE      mc.media_pedido_cliente > mg.media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.dataPedido) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.dataPedido), DAYOFWEEK(pv.dataPedido) ORDER BY      DAYOFWEEK(pv.dataPedido);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valor_total_vendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valor_total_vendas DESC) AS rn     FROM VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valor_total_vendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.rn <= 10 ORDER BY rv.ano, rv.valor_total_vendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ip.`qtdePedida` * ip.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     JOIN `Produto` p ON ip.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), VendasComPivo AS (     SELECT          va1.`idCategoria`,         va1.ano AS ano_atual,         va1.total_vendas AS vendas_atual,         va2.total_vendas AS vendas_anterior     FROM VendasAnuais va1     LEFT JOIN VendasAnuais va2 ON va1.`idCategoria` = va2.`idCategoria` AND va1.ano = va2.ano + 1 ) SELECT      c.`nomeCategoria`,     ROUND(         CASE              WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0              THEN ((vendas_atual - vendas_anterior) / vendas_anterior) * 100              ELSE 0          END, 2     ) AS variacao_percentual FROM VendasComPivo v JOIN `CategoriaProduto` c ON v.`idCategoria` = c.`idCategoria` ORDER BY v.ano_atual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), Variacao AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         MAX(CASE WHEN ano = 2021 THEN qtdePedidos END) AS pedidos_2021,         MAX(CASE WHEN ano = 2020 THEN qtdePedidos END) AS pedidos_2020     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     ROUND(         ((pedidos_2021 - pedidos_2020) * 100.0 / pedidos_2020),          2     ) AS variacao_percentual FROM      Variacao WHERE      pedidos_2020 IS NOT NULL AND pedidos_2021 IS NOT NULL ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaCliente AS (     SELECT          pv.`idCliente`,         AVG(iv.`precoVendido` * iv.`qtdePedida`) AS media_pedido_cliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` iv ON pv.`idPedido` = iv.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(iv.`precoVendido` * iv.`qtdePedida`) AS media_pedido_geral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` iv ON pv.`idPedido` = iv.`idPedido` ) SELECT      mc.`idCliente`,     mc.media_pedido_cliente,     mg.media_pedido_geral FROM      MediaCliente mc CROSS JOIN      MediaGeral mg WHERE      mc.media_pedido_cliente > mg.media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.dataPedido) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.dataPedido), DAYOFWEEK(pv.dataPedido) ORDER BY      DAYOFWEEK(pv.dataPedido);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valor_total_vendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valor_total_vendas DESC) AS rn     FROM VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valor_total_vendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.rn <= 10 ORDER BY rv.ano, rv.valor_total_vendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ip.`qtdePedida` * ip.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     JOIN `Produto` p ON ip.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), VendasComPivo AS (     SELECT          va1.`idCategoria`,         va1.ano AS ano_atual,         va1.total_vendas AS vendas_atual,         va2.total_vendas AS vendas_anterior     FROM VendasAnuais va1     LEFT JOIN VendasAnuais va2 ON va1.`idCategoria` = va2.`idCategoria` AND va1.ano = va2.ano + 1 ) SELECT      c.`nomeCategoria`,     ROUND(         CASE              WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0              THEN ((vendas_atual - vendas_anterior) / vendas_anterior) * 100              ELSE 0          END, 2     ) AS variacao_percentual FROM VendasComPivo v JOIN `CategoriaProduto` c ON v.`idCategoria` = c.`idCategoria` ORDER BY v.ano_atual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), Variacao AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         MAX(CASE WHEN ano = 2021 THEN qtdePedidos END) AS pedidos_2021,         MAX(CASE WHEN ano = 2020 THEN qtdePedidos END) AS pedidos_2020     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     ROUND(         ((pedidos_2021 - pedidos_2020) * 100.0 / pedidos_2020),          2     ) AS variacao_percentual FROM      Variacao WHERE      pedidos_2020 IS NOT NULL AND pedidos_2021 IS NOT NULL ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaCliente AS (     SELECT          pv.`idCliente`,         AVG(iv.`precoVendido` * iv.`qtdePedida`) AS media_pedido_cliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` iv ON pv.`idPedido` = iv.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(iv.`precoVendido` * iv.`qtdePedida`) AS media_pedido_geral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` iv ON pv.`idPedido` = iv.`idPedido` ) SELECT      mc.`idCliente`,     mc.media_pedido_cliente,     mg.media_pedido_geral FROM      MediaCliente mc CROSS JOIN      MediaGeral mg WHERE      mc.media_pedido_cliente > mg.media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.dataPedido) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.dataPedido), DAYOFWEEK(pv.dataPedido) ORDER BY      DAYOFWEEK(pv.dataPedido);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valor_total_vendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valor_total_vendas DESC) AS rn     FROM VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valor_total_vendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.rn <= 10 ORDER BY rv.ano, rv.valor_total_vendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ip.`qtdePedida` * ip.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     JOIN `Produto` p ON ip.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), VendasComPivo AS (     SELECT          va1.`idCategoria`,         va1.ano AS ano_atual,         va1.total_vendas AS vendas_atual,         va2.total_vendas AS vendas_anterior     FROM VendasAnuais va1     LEFT JOIN VendasAnuais va2 ON va1.`idCategoria` = va2.`idCategoria` AND va1.ano = va2.ano + 1 ) SELECT      c.`nomeCategoria`,     ROUND(         CASE              WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0              THEN ((vendas_atual - vendas_anterior) / vendas_anterior) * 100              ELSE 0          END, 2     ) AS variacao_percentual FROM VendasComPivo v JOIN `CategoriaProduto` c ON v.`idCategoria` = c.`idCategoria` ORDER BY v.ano_atual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), Variacao AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         MAX(CASE WHEN ano = 2021 THEN qtdePedidos END) AS pedidos_2021,         MAX(CASE WHEN ano = 2020 THEN qtdePedidos END) AS pedidos_2020     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     ROUND(         ((pedidos_2021 - pedidos_2020) * 100.0 / pedidos_2020),          2     ) AS variacao_percentual FROM      Variacao WHERE      pedidos_2020 IS NOT NULL AND pedidos_2021 IS NOT NULL ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaCliente AS (     SELECT          pv.`idCliente`,         AVG(iv.`precoVendido` * iv.`qtdePedida`) AS media_pedido_cliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` iv ON pv.`idPedido` = iv.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(iv.`precoVendido` * iv.`qtdePedida`) AS media_pedido_geral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` iv ON pv.`idPedido` = iv.`idPedido` ) SELECT      mc.`idCliente`,     mc.media_pedido_cliente,     mg.media_pedido_geral FROM      MediaCliente mc CROSS JOIN      MediaGeral mg WHERE      mc.media_pedido_cliente > mg.media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.dataPedido) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.dataPedido), DAYOFWEEK(pv.dataPedido) ORDER BY      DAYOFWEEK(pv.dataPedido);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valor_total_vendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valor_total_vendas DESC) AS rn     FROM VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valor_total_vendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.rn <= 10 ORDER BY rv.ano, rv.valor_total_vendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ip.`qtdePedida` * ip.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     JOIN `Produto` p ON ip.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), VendasComPivo AS (     SELECT          va1.`idCategoria`,         va1.ano AS ano_atual,         va1.total_vendas AS vendas_atual,         va2.total_vendas AS vendas_anterior     FROM VendasAnuais va1     LEFT JOIN VendasAnuais va2 ON va1.`idCategoria` = va2.`idCategoria` AND va1.ano = va2.ano + 1 ) SELECT      c.`nomeCategoria`,     ROUND(         CASE              WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0              THEN ((vendas_atual - vendas_anterior) / vendas_anterior) * 100              ELSE 0          END, 2     ) AS variacao_percentual FROM VendasComPivo v JOIN `CategoriaProduto` c ON v.`idCategoria` = c.`idCategoria` ORDER BY v.ano_atual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), Variacao AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         MAX(CASE WHEN ano = 2021 THEN qtdePedidos END) AS pedidos_2021,         MAX(CASE WHEN ano = 2020 THEN qtdePedidos END) AS pedidos_2020     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     ROUND(         ((pedidos_2021 - pedidos_2020) * 100.0 / pedidos_2020),          2     ) AS variacao_percentual FROM      Variacao WHERE      pedidos_2020 IS NOT NULL AND pedidos_2021 IS NOT NULL ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaCliente AS (     SELECT          pv.`idCliente`,         AVG(iv.`precoVendido` * iv.`qtdePedida`) AS media_pedido_cliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` iv ON pv.`idPedido` = iv.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(iv.`precoVendido` * iv.`qtdePedida`) AS media_pedido_geral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` iv ON pv.`idPedido` = iv.`idPedido` ) SELECT      mc.`idCliente`,     mc.media_pedido_cliente,     mg.media_pedido_geral FROM      MediaCliente mc CROSS JOIN      MediaGeral mg WHERE      mc.media_pedido_cliente > mg.media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.dataPedido) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.dataPedido), DAYOFWEEK(pv.dataPedido) ORDER BY      DAYOFWEEK(pv.dataPedido);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valor_total_vendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valor_total_vendas DESC) AS rn     FROM VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valor_total_vendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.rn <= 10 ORDER BY rv.ano, rv.valor_total_vendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ip.`qtdePedida` * ip.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     JOIN `Produto` p ON ip.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), VendasComPivo AS (     SELECT          va1.`idCategoria`,         va1.ano AS ano_atual,         va1.total_vendas AS vendas_atual,         va2.total_vendas AS vendas_anterior     FROM VendasAnuais va1     LEFT JOIN VendasAnuais va2 ON va1.`idCategoria` = va2.`idCategoria` AND va1.ano = va2.ano + 1 ) SELECT      c.`nomeCategoria`,     ROUND(         CASE              WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0              THEN ((vendas_atual - vendas_anterior) / vendas_anterior) * 100              ELSE 0          END, 2     ) AS variacao_percentual FROM VendasComPivo v JOIN `CategoriaProduto` c ON v.`idCategoria` = c.`idCategoria` ORDER BY v.ano_atual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), Variacao AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         MAX(CASE WHEN ano = 2021 THEN qtdePedidos END) AS pedidos_2021,         MAX(CASE WHEN ano = 2020 THEN qtdePedidos END) AS pedidos_2020     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     ROUND(         ((pedidos_2021 - pedidos_2020) * 100.0 / pedidos_2020),          2     ) AS variacao_percentual FROM      Variacao WHERE      pedidos_2020 IS NOT NULL AND pedidos_2021 IS NOT NULL ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaCliente AS (     SELECT          pv.`idCliente`,         AVG(iv.`precoVendido` * iv.`qtdePedida`) AS media_pedido_cliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` iv ON pv.`idPedido` = iv.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(iv.`precoVendido` * iv.`qtdePedida`) AS media_pedido_geral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` iv ON pv.`idPedido` = iv.`idPedido` ) SELECT      mc.`idCliente`,     mc.media_pedido_cliente,     mg.media_pedido_geral FROM      MediaCliente mc CROSS JOIN      MediaGeral mg WHERE      mc.media_pedido_cliente > mg.media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.dataPedido) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.dataPedido), DAYOFWEEK(pv.dataPedido) ORDER BY      DAYOFWEEK(pv.dataPedido);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valor_total_vendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valor_total_vendas DESC) AS rn     FROM VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valor_total_vendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.rn <= 10 ORDER BY rv.ano, rv.valor_total_vendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ip.`qtdePedida` * ip.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     JOIN `Produto` p ON ip.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), VendasComPivo AS (     SELECT          va1.`idCategoria`,         va1.ano AS ano_atual,         va1.total_vendas AS vendas_atual,         va2.total_vendas AS vendas_anterior     FROM VendasAnuais va1     LEFT JOIN VendasAnuais va2 ON va1.`idCategoria` = va2.`idCategoria` AND va1.ano = va2.ano + 1 ) SELECT      c.`nomeCategoria`,     ROUND(         CASE              WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0              THEN ((vendas_atual - vendas_anterior) / vendas_anterior) * 100              ELSE 0          END, 2     ) AS variacao_percentual FROM VendasComPivo v JOIN `CategoriaProduto` c ON v.`idCategoria` = c.`idCategoria` ORDER BY v.ano_atual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), Variacao AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         MAX(CASE WHEN ano = 2021 THEN qtdePedidos END) AS pedidos_2021,         MAX(CASE WHEN ano = 2020 THEN qtdePedidos END) AS pedidos_2020     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     ROUND(         ((pedidos_2021 - pedidos_2020) * 100.0 / pedidos_2020),          2     ) AS variacao_percentual FROM      Variacao WHERE      pedidos_2020 IS NOT NULL AND pedidos_2021 IS NOT NULL ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaCliente AS (     SELECT          pv.`idCliente`,         AVG(iv.`precoVendido` * iv.`qtdePedida`) AS media_pedido_cliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` iv ON pv.`idPedido` = iv.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(iv.`precoVendido` * iv.`qtdePedida`) AS media_pedido_geral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` iv ON pv.`idPedido` = iv.`idPedido` ) SELECT      mc.`idCliente`,     mc.media_pedido_cliente,     mg.media_pedido_geral FROM      MediaCliente mc CROSS JOIN      MediaGeral mg WHERE      mc.media_pedido_cliente > mg.media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.dataPedido) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.dataPedido), DAYOFWEEK(pv.dataPedido) ORDER BY      DAYOFWEEK(pv.dataPedido);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valor_total_vendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valor_total_vendas DESC) AS rn     FROM VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valor_total_vendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.rn <= 10 ORDER BY rv.ano, rv.valor_total_vendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ip.`qtdePedida` * ip.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     JOIN `Produto` p ON ip.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), VendasComPivo AS (     SELECT          va1.`idCategoria`,         va1.ano AS ano_atual,         va1.total_vendas AS vendas_atual,         va2.total_vendas AS vendas_anterior     FROM VendasAnuais va1     LEFT JOIN VendasAnuais va2 ON va1.`idCategoria` = va2.`idCategoria` AND va1.ano = va2.ano + 1 ) SELECT      c.`nomeCategoria`,     ROUND(         CASE              WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0              THEN ((vendas_atual - vendas_anterior) / vendas_anterior) * 100              ELSE 0          END, 2     ) AS variacao_percentual FROM VendasComPivo v JOIN `CategoriaProduto` c ON v.`idCategoria` = c.`idCategoria` ORDER BY v.ano_atual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), Variacao AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         MAX(CASE WHEN ano = 2021 THEN qtdePedidos END) AS pedidos_2021,         MAX(CASE WHEN ano = 2020 THEN qtdePedidos END) AS pedidos_2020     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     ROUND(         ((pedidos_2021 - pedidos_2020) * 100.0 / pedidos_2020),          2     ) AS variacao_percentual FROM      Variacao WHERE      pedidos_2020 IS NOT NULL AND pedidos_2021 IS NOT NULL ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaCliente AS (     SELECT          pv.`idCliente`,         AVG(iv.`precoVendido` * iv.`qtdePedida`) AS media_pedido_cliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` iv ON pv.`idPedido` = iv.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(iv.`precoVendido` * iv.`qtdePedida`) AS media_pedido_geral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` iv ON pv.`idPedido` = iv.`idPedido` ) SELECT      mc.`idCliente`,     mc.media_pedido_cliente,     mg.media_pedido_geral FROM      MediaCliente mc CROSS JOIN      MediaGeral mg WHERE      mc.media_pedido_cliente > mg.media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.dataPedido) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.dataPedido), DAYOFWEEK(pv.dataPedido) ORDER BY      DAYOFWEEK(pv.dataPedido);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valor_total_vendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valor_total_vendas DESC) AS rn     FROM VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valor_total_vendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.rn <= 10 ORDER BY rv.ano, rv.valor_total_vendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ip.`qtdePedida` * ip.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     JOIN `Produto` p ON ip.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), VendasComPivo AS (     SELECT          va1.`idCategoria`,         va1.ano AS ano_atual,         va1.total_vendas AS vendas_atual,         va2.total_vendas AS vendas_anterior     FROM VendasAnuais va1     LEFT JOIN VendasAnuais va2 ON va1.`idCategoria` = va2.`idCategoria` AND va1.ano = va2.ano + 1 ) SELECT      c.`nomeCategoria`,     ROUND(         CASE              WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0              THEN ((vendas_atual - vendas_anterior) / vendas_anterior) * 100              ELSE 0          END, 2     ) AS variacao_percentual FROM VendasComPivo v JOIN `CategoriaProduto` c ON v.`idCategoria` = c.`idCategoria` ORDER BY v.ano_atual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), Variacao AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         MAX(CASE WHEN ano = 2021 THEN qtdePedidos END) AS pedidos_2021,         MAX(CASE WHEN ano = 2020 THEN qtdePedidos END) AS pedidos_2020     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     ROUND(         ((pedidos_2021 - pedidos_2020) * 100.0 / pedidos_2020),          2     ) AS variacao_percentual FROM      Variacao WHERE      pedidos_2020 IS NOT NULL AND pedidos_2021 IS NOT NULL ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaCliente AS (     SELECT          pv.`idCliente`,         AVG(iv.`precoVendido` * iv.`qtdePedida`) AS media_pedido_cliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` iv ON pv.`idPedido` = iv.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(iv.`precoVendido` * iv.`qtdePedida`) AS media_pedido_geral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` iv ON pv.`idPedido` = iv.`idPedido` ) SELECT      mc.`idCliente`,     mc.media_pedido_cliente,     mg.media_pedido_geral FROM      MediaCliente mc CROSS JOIN      MediaGeral mg WHERE      mc.media_pedido_cliente > mg.media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.dataPedido) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.dataPedido), DAYOFWEEK(pv.dataPedido) ORDER BY      DAYOFWEEK(pv.dataPedido);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valor_total_vendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valor_total_vendas DESC) AS rn     FROM VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valor_total_vendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.rn <= 10 ORDER BY rv.ano, rv.valor_total_vendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ip.`qtdePedida` * ip.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     JOIN `Produto` p ON ip.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), VendasComPivo AS (     SELECT          va1.`idCategoria`,         va1.ano AS ano_atual,         va1.total_vendas AS vendas_atual,         va2.total_vendas AS vendas_anterior     FROM VendasAnuais va1     LEFT JOIN VendasAnuais va2 ON va1.`idCategoria` = va2.`idCategoria` AND va1.ano = va2.ano + 1 ) SELECT      c.`nomeCategoria`,     ROUND(         CASE              WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0              THEN ((vendas_atual - vendas_anterior) / vendas_anterior) * 100              ELSE 0          END, 2     ) AS variacao_percentual FROM VendasComPivo v JOIN `CategoriaProduto` c ON v.`idCategoria` = c.`idCategoria` ORDER BY v.ano_atual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), Variacao AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         MAX(CASE WHEN ano = 2021 THEN qtdePedidos END) AS pedidos_2021,         MAX(CASE WHEN ano = 2020 THEN qtdePedidos END) AS pedidos_2020     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     ROUND(         ((pedidos_2021 - pedidos_2020) * 100.0 / pedidos_2020),          2     ) AS variacao_percentual FROM      Variacao WHERE      pedidos_2020 IS NOT NULL AND pedidos_2021 IS NOT NULL ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaCliente AS (     SELECT          pv.`idCliente`,         AVG(iv.`precoVendido` * iv.`qtdePedida`) AS media_pedido_cliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` iv ON pv.`idPedido` = iv.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(iv.`precoVendido` * iv.`qtdePedida`) AS media_pedido_geral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` iv ON pv.`idPedido` = iv.`idPedido` ) SELECT      mc.`idCliente`,     mc.media_pedido_cliente,     mg.media_pedido_geral FROM      MediaCliente mc CROSS JOIN      MediaGeral mg WHERE      mc.media_pedido_cliente > mg.media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.dataPedido) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.dataPedido), DAYOFWEEK(pv.dataPedido) ORDER BY      DAYOFWEEK(pv.dataPedido);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valor_total_vendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valor_total_vendas DESC) AS rn     FROM VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valor_total_vendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.rn <= 10 ORDER BY rv.ano, rv.valor_total_vendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ip.`qtdePedida` * ip.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     JOIN `Produto` p ON ip.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), VendasComPivo AS (     SELECT          va1.`idCategoria`,         va1.ano AS ano_atual,         va1.total_vendas AS vendas_atual,         va2.total_vendas AS vendas_anterior     FROM VendasAnuais va1     LEFT JOIN VendasAnuais va2 ON va1.`idCategoria` = va2.`idCategoria` AND va1.ano = va2.ano + 1 ) SELECT      c.`nomeCategoria`,     ROUND(         CASE              WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0              THEN ((vendas_atual - vendas_anterior) / vendas_anterior) * 100              ELSE 0          END, 2     ) AS variacao_percentual FROM VendasComPivo v JOIN `CategoriaProduto` c ON v.`idCategoria` = c.`idCategoria` ORDER BY v.ano_atual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), Variacao AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         MAX(CASE WHEN ano = 2021 THEN qtdePedidos END) AS pedidos_2021,         MAX(CASE WHEN ano = 2020 THEN qtdePedidos END) AS pedidos_2020     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     ROUND(         ((pedidos_2021 - pedidos_2020) * 100.0 / pedidos_2020),          2     ) AS variacao_percentual FROM      Variacao WHERE      pedidos_2020 IS NOT NULL AND pedidos_2021 IS NOT NULL ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaCliente AS (     SELECT          pv.`idCliente`,         AVG(iv.`precoVendido` * iv.`qtdePedida`) AS media_pedido_cliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` iv ON pv.`idPedido` = iv.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(iv.`precoVendido` * iv.`qtdePedida`) AS media_pedido_geral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` iv ON pv.`idPedido` = iv.`idPedido` ) SELECT      mc.`idCliente`,     mc.media_pedido_cliente,     mg.media_pedido_geral FROM      MediaCliente mc CROSS JOIN      MediaGeral mg WHERE      mc.media_pedido_cliente > mg.media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.dataPedido) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.dataPedido), DAYOFWEEK(pv.dataPedido) ORDER BY      DAYOFWEEK(pv.dataPedido);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valor_total_vendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valor_total_vendas DESC) AS rn     FROM VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valor_total_vendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.rn <= 10 ORDER BY rv.ano, rv.valor_total_vendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ip.`qtdePedida` * ip.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     JOIN `Produto` p ON ip.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), VendasComPivo AS (     SELECT          va1.`idCategoria`,         va1.ano AS ano_atual,         va1.total_vendas AS vendas_atual,         va2.total_vendas AS vendas_anterior     FROM VendasAnuais va1     LEFT JOIN VendasAnuais va2 ON va1.`idCategoria` = va2.`idCategoria` AND va1.ano = va2.ano + 1 ) SELECT      c.`nomeCategoria`,     ROUND(         CASE              WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0              THEN ((vendas_atual - vendas_anterior) / vendas_anterior) * 100              ELSE 0          END, 2     ) AS variacao_percentual FROM VendasComPivo v JOIN `CategoriaProduto` c ON v.`idCategoria` = c.`idCategoria` ORDER BY v.ano_atual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), Variacao AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         MAX(CASE WHEN ano = 2021 THEN qtdePedidos END) AS pedidos_2021,         MAX(CASE WHEN ano = 2020 THEN qtdePedidos END) AS pedidos_2020     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     ROUND(         ((pedidos_2021 - pedidos_2020) * 100.0 / pedidos_2020),          2     ) AS variacao_percentual FROM      Variacao WHERE      pedidos_2020 IS NOT NULL AND pedidos_2021 IS NOT NULL ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaCliente AS (     SELECT          pv.`idCliente`,         AVG(iv.`precoVendido` * iv.`qtdePedida`) AS media_pedido_cliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` iv ON pv.`idPedido` = iv.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(iv.`precoVendido` * iv.`qtdePedida`) AS media_pedido_geral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` iv ON pv.`idPedido` = iv.`idPedido` ) SELECT      mc.`idCliente`,     mc.media_pedido_cliente,     mg.media_pedido_geral FROM      MediaCliente mc CROSS JOIN      MediaGeral mg WHERE      mc.media_pedido_cliente > mg.media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.dataPedido) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.dataPedido), DAYOFWEEK(pv.dataPedido) ORDER BY      DAYOFWEEK(pv.dataPedido);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valor_total_vendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valor_total_vendas DESC) AS rn     FROM VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valor_total_vendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.rn <= 10 ORDER BY rv.ano, rv.valor_total_vendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ip.`qtdePedida` * ip.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     JOIN `Produto` p ON ip.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), VendasComPivo AS (     SELECT          va1.`idCategoria`,         va1.ano AS ano_atual,         va1.total_vendas AS vendas_atual,         va2.total_vendas AS vendas_anterior     FROM VendasAnuais va1     LEFT JOIN VendasAnuais va2 ON va1.`idCategoria` = va2.`idCategoria` AND va1.ano = va2.ano + 1 ) SELECT      c.`nomeCategoria`,     ROUND(         CASE              WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0              THEN ((vendas_atual - vendas_anterior) / vendas_anterior) * 100              ELSE 0          END, 2     ) AS variacao_percentual FROM VendasComPivo v JOIN `CategoriaProduto` c ON v.`idCategoria` = c.`idCategoria` ORDER BY v.ano_atual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), Variacao AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         MAX(CASE WHEN ano = 2021 THEN qtdePedidos END) AS pedidos_2021,         MAX(CASE WHEN ano = 2020 THEN qtdePedidos END) AS pedidos_2020     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     ROUND(         ((pedidos_2021 - pedidos_2020) * 100.0 / pedidos_2020),          2     ) AS variacao_percentual FROM      Variacao WHERE      pedidos_2020 IS NOT NULL AND pedidos_2021 IS NOT NULL ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaCliente AS (     SELECT          pv.`idCliente`,         AVG(iv.`precoVendido` * iv.`qtdePedida`) AS media_pedido_cliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` iv ON pv.`idPedido` = iv.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(iv.`precoVendido` * iv.`qtdePedida`) AS media_pedido_geral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` iv ON pv.`idPedido` = iv.`idPedido` ) SELECT      mc.`idCliente`,     mc.media_pedido_cliente,     mg.media_pedido_geral FROM      MediaCliente mc CROSS JOIN      MediaGeral mg WHERE      mc.media_pedido_cliente > mg.media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.dataPedido) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.dataPedido), DAYOFWEEK(pv.dataPedido) ORDER BY      DAYOFWEEK(pv.dataPedido);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valor_total_vendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valor_total_vendas DESC) AS rn     FROM VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valor_total_vendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.rn <= 10 ORDER BY rv.ano, rv.valor_total_vendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ip.`qtdePedida` * ip.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     JOIN `Produto` p ON ip.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), VendasComPivo AS (     SELECT          va1.`idCategoria`,         va1.ano AS ano_atual,         va1.total_vendas AS vendas_atual,         va2.total_vendas AS vendas_anterior     FROM VendasAnuais va1     LEFT JOIN VendasAnuais va2 ON va1.`idCategoria` = va2.`idCategoria` AND va1.ano = va2.ano + 1 ) SELECT      c.`nomeCategoria`,     ROUND(         CASE              WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0              THEN ((vendas_atual - vendas_anterior) / vendas_anterior) * 100              ELSE 0          END, 2     ) AS variacao_percentual FROM VendasComPivo v JOIN `CategoriaProduto` c ON v.`idCategoria` = c.`idCategoria` ORDER BY v.ano_atual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), Variacao AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         MAX(CASE WHEN ano = 2021 THEN qtdePedidos END) AS pedidos_2021,         MAX(CASE WHEN ano = 2020 THEN qtdePedidos END) AS pedidos_2020     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     ROUND(         ((pedidos_2021 - pedidos_2020) * 100.0 / pedidos_2020),          2     ) AS variacao_percentual FROM      Variacao WHERE      pedidos_2020 IS NOT NULL AND pedidos_2021 IS NOT NULL ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaCliente AS (     SELECT          pv.`idCliente`,         AVG(iv.`precoVendido` * iv.`qtdePedida`) AS media_pedido_cliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` iv ON pv.`idPedido` = iv.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(iv.`precoVendido` * iv.`qtdePedida`) AS media_pedido_geral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` iv ON pv.`idPedido` = iv.`idPedido` ) SELECT      mc.`idCliente`,     mc.media_pedido_cliente,     mg.media_pedido_geral FROM      MediaCliente mc CROSS JOIN      MediaGeral mg WHERE      mc.media_pedido_cliente > mg.media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.dataPedido) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.dataPedido), DAYOFWEEK(pv.dataPedido) ORDER BY      DAYOFWEEK(pv.dataPedido);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valor_total_vendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valor_total_vendas DESC) AS rn     FROM VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valor_total_vendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.rn <= 10 ORDER BY rv.ano, rv.valor_total_vendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ip.`qtdePedida` * ip.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     JOIN `Produto` p ON ip.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), VendasComPivo AS (     SELECT          va1.`idCategoria`,         va1.ano AS ano_atual,         va1.total_vendas AS vendas_atual,         va2.total_vendas AS vendas_anterior     FROM VendasAnuais va1     LEFT JOIN VendasAnuais va2 ON va1.`idCategoria` = va2.`idCategoria` AND va1.ano = va2.ano + 1 ) SELECT      c.`nomeCategoria`,     ROUND(         CASE              WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0              THEN ((vendas_atual - vendas_anterior) / vendas_anterior) * 100              ELSE 0          END, 2     ) AS variacao_percentual FROM VendasComPivo v JOIN `CategoriaProduto` c ON v.`idCategoria` = c.`idCategoria` ORDER BY v.ano_atual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), Variacao AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         MAX(CASE WHEN ano = 2021 THEN qtdePedidos END) AS pedidos_2021,         MAX(CASE WHEN ano = 2020 THEN qtdePedidos END) AS pedidos_2020     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     ROUND(         ((pedidos_2021 - pedidos_2020) * 100.0 / pedidos_2020),          2     ) AS variacao_percentual FROM      Variacao WHERE      pedidos_2020 IS NOT NULL AND pedidos_2021 IS NOT NULL ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaCliente AS (     SELECT          pv.`idCliente`,         AVG(iv.`precoVendido` * iv.`qtdePedida`) AS media_pedido_cliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` iv ON pv.`idPedido` = iv.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(iv.`precoVendido` * iv.`qtdePedida`) AS media_pedido_geral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` iv ON pv.`idPedido` = iv.`idPedido` ) SELECT      mc.`idCliente`,     mc.media_pedido_cliente,     mg.media_pedido_geral FROM      MediaCliente mc CROSS JOIN      MediaGeral mg WHERE      mc.media_pedido_cliente > mg.media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.dataPedido) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.dataPedido), DAYOFWEEK(pv.dataPedido) ORDER BY      DAYOFWEEK(pv.dataPedido);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valor_total_vendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valor_total_vendas DESC) AS rn     FROM VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valor_total_vendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.rn <= 10 ORDER BY rv.ano, rv.valor_total_vendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ip.`qtdePedida` * ip.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     JOIN `Produto` p ON ip.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), VendasComPivo AS (     SELECT          va1.`idCategoria`,         va1.ano AS ano_atual,         va1.total_vendas AS vendas_atual,         va2.total_vendas AS vendas_anterior     FROM VendasAnuais va1     LEFT JOIN VendasAnuais va2 ON va1.`idCategoria` = va2.`idCategoria` AND va1.ano = va2.ano + 1 ) SELECT      c.`nomeCategoria`,     ROUND(         CASE              WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0              THEN ((vendas_atual - vendas_anterior) / vendas_anterior) * 100              ELSE 0          END, 2     ) AS variacao_percentual FROM VendasComPivo v JOIN `CategoriaProduto` c ON v.`idCategoria` = c.`idCategoria` ORDER BY v.ano_atual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), Variacao AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         MAX(CASE WHEN ano = 2021 THEN qtdePedidos END) AS pedidos_2021,         MAX(CASE WHEN ano = 2020 THEN qtdePedidos END) AS pedidos_2020     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     ROUND(         ((pedidos_2021 - pedidos_2020) * 100.0 / pedidos_2020),          2     ) AS variacao_percentual FROM      Variacao WHERE      pedidos_2020 IS NOT NULL AND pedidos_2021 IS NOT NULL ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaCliente AS (     SELECT          pv.`idCliente`,         AVG(iv.`precoVendido` * iv.`qtdePedida`) AS media_pedido_cliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` iv ON pv.`idPedido` = iv.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(iv.`precoVendido` * iv.`qtdePedida`) AS media_pedido_geral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` iv ON pv.`idPedido` = iv.`idPedido` ) SELECT      mc.`idCliente`,     mc.media_pedido_cliente,     mg.media_pedido_geral FROM      MediaCliente mc CROSS JOIN      MediaGeral mg WHERE      mc.media_pedido_cliente > mg.media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.dataPedido) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.dataPedido), DAYOFWEEK(pv.dataPedido) ORDER BY      DAYOFWEEK(pv.dataPedido);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,      COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnoCliente AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valor_total_vendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valor_total_vendas DESC) AS rn     FROM VendasAnoCliente ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valor_total_vendas FROM RankVendas rv JOIN `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE rv.rn <= 10 ORDER BY rv.ano, rv.valor_total_vendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          p.`idCategoria`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ip.`qtdePedida` * ip.`precoVendido`) AS total_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     JOIN `Produto` p ON ip.`idProduto` = p.`idProduto`     GROUP BY p.`idCategoria`, YEAR(pv.`dataPedido`) ), VendasComPivo AS (     SELECT          va1.`idCategoria`,         va1.ano AS ano_atual,         va1.total_vendas AS vendas_atual,         va2.total_vendas AS vendas_anterior     FROM VendasAnuais va1     LEFT JOIN VendasAnuais va2 ON va1.`idCategoria` = va2.`idCategoria` AND va1.ano = va2.ano + 1 ) SELECT      c.`nomeCategoria`,     ROUND(         CASE              WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0              THEN ((vendas_atual - vendas_anterior) / vendas_anterior) * 100              ELSE 0          END, 2     ) AS variacao_percentual FROM VendasComPivo v JOIN `CategoriaProduto` c ON v.`idCategoria` = c.`idCategoria` ORDER BY v.ano_atual;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdePedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), Variacao AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         MAX(CASE WHEN ano = 2021 THEN qtdePedidos END) AS pedidos_2021,         MAX(CASE WHEN ano = 2020 THEN qtdePedidos END) AS pedidos_2020     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     ROUND(         ((pedidos_2021 - pedidos_2020) * 100.0 / pedidos_2020),          2     ) AS variacao_percentual FROM      Variacao WHERE      pedidos_2020 IS NOT NULL AND pedidos_2021 IS NOT NULL ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaCliente AS (     SELECT          pv.`idCliente`,         AVG(iv.`precoVendido` * iv.`qtdePedida`) AS media_pedido_cliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` iv ON pv.`idPedido` = iv.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(iv.`precoVendido` * iv.`qtdePedida`) AS media_pedido_geral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` iv ON pv.`idPedido` = iv.`idPedido` ) SELECT      mc.`idCliente`,     mc.media_pedido_cliente,     mg.media_pedido_geral FROM      MediaCliente mc CROSS JOIN      MediaGeral mg WHERE      mc.media_pedido_cliente > mg.media_pedido_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS `rank`     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.`rank` <= 10 ORDER BY      rv.ano, rv.`rank`;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.idCategoria,         YEAR(pv.dataPedido) AS ano,         SUM(ip.qtdePedida * ip.precoVendido) AS totalVendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     GROUP BY p.idCategoria, YEAR(pv.dataPedido) ), VendasAnoAnterior AS (     SELECT          va1.idCategoria,         va1.ano,         va1.totalVendas AS vendasAtual,         LAG(va1.totalVendas) OVER (PARTITION BY va1.idCategoria ORDER BY va1.ano) AS vendasAnterior     FROM VendasAno va1 ) SELECT      c.nomeCategoria,     v.ano,     ROUND(         CASE              WHEN v.vendasAnterior IS NOT NULL AND v.vendasAnterior <> 0              THEN ((v.vendasAtual - v.vendasAnterior) / v.vendasAnterior) * 100             ELSE 0          END, 2     ) AS variacaoPercentual FROM VendasAnoAnterior v JOIN CategoriaProduto c ON v.idCategoria = c.idCategoria WHERE v.vendasAnterior IS NOT NULL ORDER BY c.nomeCategoria, v.ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdPedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), Variacao AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         MAX(CASE WHEN ano = 2021 THEN qtdPedidos ELSE 0 END) AS pedidos_2021,         MAX(CASE WHEN ano = 2020 THEN qtdPedidos ELSE 0 END) AS pedidos_2020     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     ROUND(         ((pedidos_2021 - pedidos_2020) * 100.0 / NULLIF(pedidos_2020, 0)),         2     ) AS variacao_percentual FROM      Variacao WHERE      pedidos_2020 > 0 AND pedidos_2021 > 0 ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaPorCliente AS (     SELECT          pv.`idCliente`,         AVG(ip.`precoVendido` * ip.`qtdePedida`) AS MediaCliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(ip.`precoVendido` * ip.`qtdePedida`) AS MediaGeral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido` ) SELECT      mpc.`idCliente`,     mpc.MediaCliente,     mg.MediaGeral FROM      MediaPorCliente mpc CROSS JOIN      MediaGeral mg WHERE      mpc.MediaCliente > mg.MediaGeral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS `rank`     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.`rank` <= 10 ORDER BY      rv.ano, rv.`rank`;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.idCategoria,         YEAR(pv.dataPedido) AS ano,         SUM(ip.qtdePedida * ip.precoVendido) AS totalVendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     GROUP BY p.idCategoria, YEAR(pv.dataPedido) ), VendasAnoAnterior AS (     SELECT          va1.idCategoria,         va1.ano,         va1.totalVendas AS vendasAtual,         LAG(va1.totalVendas) OVER (PARTITION BY va1.idCategoria ORDER BY va1.ano) AS vendasAnterior     FROM VendasAno va1 ) SELECT      c.nomeCategoria,     v.ano,     ROUND(         CASE              WHEN v.vendasAnterior IS NOT NULL AND v.vendasAnterior <> 0              THEN ((v.vendasAtual - v.vendasAnterior) / v.vendasAnterior) * 100             ELSE 0          END, 2     ) AS variacaoPercentual FROM VendasAnoAnterior v JOIN CategoriaProduto c ON v.idCategoria = c.idCategoria WHERE v.vendasAnterior IS NOT NULL ORDER BY c.nomeCategoria, v.ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdPedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), Variacao AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         MAX(CASE WHEN ano = 2021 THEN qtdPedidos ELSE 0 END) AS pedidos_2021,         MAX(CASE WHEN ano = 2020 THEN qtdPedidos ELSE 0 END) AS pedidos_2020     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     ROUND(         ((pedidos_2021 - pedidos_2020) * 100.0 / NULLIF(pedidos_2020, 0)),         2     ) AS variacao_percentual FROM      Variacao WHERE      pedidos_2020 > 0 AND pedidos_2021 > 0 ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaPorCliente AS (     SELECT          pv.`idCliente`,         AVG(ip.`precoVendido` * ip.`qtdePedida`) AS MediaCliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(ip.`precoVendido` * ip.`qtdePedida`) AS MediaGeral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido` ) SELECT      mpc.`idCliente`,     mpc.MediaCliente,     mg.MediaGeral FROM      MediaPorCliente mpc CROSS JOIN      MediaGeral mg WHERE      mpc.MediaCliente > mg.MediaGeral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS `rank`     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.`rank` <= 10 ORDER BY      rv.ano, rv.`rank`;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.idCategoria,         YEAR(pv.dataPedido) AS ano,         SUM(ip.qtdePedida * ip.precoVendido) AS totalVendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     GROUP BY p.idCategoria, YEAR(pv.dataPedido) ), VendasAnoAnterior AS (     SELECT          va1.idCategoria,         va1.ano,         va1.totalVendas AS vendasAtual,         LAG(va1.totalVendas) OVER (PARTITION BY va1.idCategoria ORDER BY va1.ano) AS vendasAnterior     FROM VendasAno va1 ) SELECT      c.nomeCategoria,     v.ano,     ROUND(         CASE              WHEN v.vendasAnterior IS NOT NULL AND v.vendasAnterior <> 0              THEN ((v.vendasAtual - v.vendasAnterior) / v.vendasAnterior) * 100             ELSE 0          END, 2     ) AS variacaoPercentual FROM VendasAnoAnterior v JOIN CategoriaProduto c ON v.idCategoria = c.idCategoria WHERE v.vendasAnterior IS NOT NULL ORDER BY c.nomeCategoria, v.ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdPedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), Variacao AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         MAX(CASE WHEN ano = 2021 THEN qtdPedidos ELSE 0 END) AS pedidos_2021,         MAX(CASE WHEN ano = 2020 THEN qtdPedidos ELSE 0 END) AS pedidos_2020     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     ROUND(         ((pedidos_2021 - pedidos_2020) * 100.0 / NULLIF(pedidos_2020, 0)),         2     ) AS variacao_percentual FROM      Variacao WHERE      pedidos_2020 > 0 AND pedidos_2021 > 0 ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaPorCliente AS (     SELECT          pv.`idCliente`,         AVG(ip.`precoVendido` * ip.`qtdePedida`) AS MediaCliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(ip.`precoVendido` * ip.`qtdePedida`) AS MediaGeral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido` ) SELECT      mpc.`idCliente`,     mpc.MediaCliente,     mg.MediaGeral FROM      MediaPorCliente mpc CROSS JOIN      MediaGeral mg WHERE      mpc.MediaCliente > mg.MediaGeral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS `rank`     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.`rank` <= 10 ORDER BY      rv.ano, rv.`rank`;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.idCategoria,         YEAR(pv.dataPedido) AS ano,         SUM(ip.qtdePedida * ip.precoVendido) AS totalVendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     GROUP BY p.idCategoria, YEAR(pv.dataPedido) ), VendasAnoAnterior AS (     SELECT          va1.idCategoria,         va1.ano,         va1.totalVendas AS vendasAtual,         LAG(va1.totalVendas) OVER (PARTITION BY va1.idCategoria ORDER BY va1.ano) AS vendasAnterior     FROM VendasAno va1 ) SELECT      c.nomeCategoria,     v.ano,     ROUND(         CASE              WHEN v.vendasAnterior IS NOT NULL AND v.vendasAnterior <> 0              THEN ((v.vendasAtual - v.vendasAnterior) / v.vendasAnterior) * 100             ELSE 0          END, 2     ) AS variacaoPercentual FROM VendasAnoAnterior v JOIN CategoriaProduto c ON v.idCategoria = c.idCategoria WHERE v.vendasAnterior IS NOT NULL ORDER BY c.nomeCategoria, v.ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdPedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), Variacao AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         MAX(CASE WHEN ano = 2021 THEN qtdPedidos ELSE 0 END) AS pedidos_2021,         MAX(CASE WHEN ano = 2020 THEN qtdPedidos ELSE 0 END) AS pedidos_2020     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     ROUND(         ((pedidos_2021 - pedidos_2020) * 100.0 / NULLIF(pedidos_2020, 0)),         2     ) AS variacao_percentual FROM      Variacao WHERE      pedidos_2020 > 0 AND pedidos_2021 > 0 ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaPorCliente AS (     SELECT          pv.`idCliente`,         AVG(ip.`precoVendido` * ip.`qtdePedida`) AS MediaCliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(ip.`precoVendido` * ip.`qtdePedida`) AS MediaGeral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido` ) SELECT      mpc.`idCliente`,     mpc.MediaCliente,     mg.MediaGeral FROM      MediaPorCliente mpc CROSS JOIN      MediaGeral mg WHERE      mpc.MediaCliente > mg.MediaGeral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS `rank`     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.`rank` <= 10 ORDER BY      rv.ano, rv.`rank`;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.idCategoria,         YEAR(pv.dataPedido) AS ano,         SUM(ip.qtdePedida * ip.precoVendido) AS totalVendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     GROUP BY p.idCategoria, YEAR(pv.dataPedido) ), VendasAnoAnterior AS (     SELECT          va1.idCategoria,         va1.ano,         va1.totalVendas AS vendasAtual,         LAG(va1.totalVendas) OVER (PARTITION BY va1.idCategoria ORDER BY va1.ano) AS vendasAnterior     FROM VendasAno va1 ) SELECT      c.nomeCategoria,     v.ano,     ROUND(         CASE              WHEN v.vendasAnterior IS NOT NULL AND v.vendasAnterior <> 0              THEN ((v.vendasAtual - v.vendasAnterior) / v.vendasAnterior) * 100             ELSE 0          END, 2     ) AS variacaoPercentual FROM VendasAnoAnterior v JOIN CategoriaProduto c ON v.idCategoria = c.idCategoria WHERE v.vendasAnterior IS NOT NULL ORDER BY c.nomeCategoria, v.ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdPedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), Variacao AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         MAX(CASE WHEN ano = 2021 THEN qtdPedidos ELSE 0 END) AS pedidos_2021,         MAX(CASE WHEN ano = 2020 THEN qtdPedidos ELSE 0 END) AS pedidos_2020     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     ROUND(         ((pedidos_2021 - pedidos_2020) * 100.0 / NULLIF(pedidos_2020, 0)),         2     ) AS variacao_percentual FROM      Variacao WHERE      pedidos_2020 > 0 AND pedidos_2021 > 0 ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaPorCliente AS (     SELECT          pv.`idCliente`,         AVG(ip.`precoVendido` * ip.`qtdePedida`) AS MediaCliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(ip.`precoVendido` * ip.`qtdePedida`) AS MediaGeral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido` ) SELECT      mpc.`idCliente`,     mpc.MediaCliente,     mg.MediaGeral FROM      MediaPorCliente mpc CROSS JOIN      MediaGeral mg WHERE      mpc.MediaCliente > mg.MediaGeral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS `rank`     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.`rank` <= 10 ORDER BY      rv.ano, rv.`rank`;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.idCategoria,         YEAR(pv.dataPedido) AS ano,         SUM(ip.qtdePedida * ip.precoVendido) AS totalVendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     GROUP BY p.idCategoria, YEAR(pv.dataPedido) ), VendasAnoAnterior AS (     SELECT          va1.idCategoria,         va1.ano,         va1.totalVendas AS vendasAtual,         LAG(va1.totalVendas) OVER (PARTITION BY va1.idCategoria ORDER BY va1.ano) AS vendasAnterior     FROM VendasAno va1 ) SELECT      c.nomeCategoria,     v.ano,     ROUND(         CASE              WHEN v.vendasAnterior IS NOT NULL AND v.vendasAnterior <> 0              THEN ((v.vendasAtual - v.vendasAnterior) / v.vendasAnterior) * 100             ELSE 0          END, 2     ) AS variacaoPercentual FROM VendasAnoAnterior v JOIN CategoriaProduto c ON v.idCategoria = c.idCategoria WHERE v.vendasAnterior IS NOT NULL ORDER BY c.nomeCategoria, v.ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdPedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), Variacao AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         MAX(CASE WHEN ano = 2021 THEN qtdPedidos ELSE 0 END) AS pedidos_2021,         MAX(CASE WHEN ano = 2020 THEN qtdPedidos ELSE 0 END) AS pedidos_2020     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     ROUND(         ((pedidos_2021 - pedidos_2020) * 100.0 / NULLIF(pedidos_2020, 0)),         2     ) AS variacao_percentual FROM      Variacao WHERE      pedidos_2020 > 0 AND pedidos_2021 > 0 ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaPorCliente AS (     SELECT          pv.`idCliente`,         AVG(ip.`precoVendido` * ip.`qtdePedida`) AS MediaCliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(ip.`precoVendido` * ip.`qtdePedida`) AS MediaGeral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido` ) SELECT      mpc.`idCliente`,     mpc.MediaCliente,     mg.MediaGeral FROM      MediaPorCliente mpc CROSS JOIN      MediaGeral mg WHERE      mpc.MediaCliente > mg.MediaGeral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS `rank`     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.`rank` <= 10 ORDER BY      rv.ano, rv.`rank`;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.idCategoria,         YEAR(pv.dataPedido) AS ano,         SUM(ip.qtdePedida * ip.precoVendido) AS totalVendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     GROUP BY p.idCategoria, YEAR(pv.dataPedido) ), VendasAnoAnterior AS (     SELECT          va1.idCategoria,         va1.ano,         va1.totalVendas AS vendasAtual,         LAG(va1.totalVendas) OVER (PARTITION BY va1.idCategoria ORDER BY va1.ano) AS vendasAnterior     FROM VendasAno va1 ) SELECT      c.nomeCategoria,     v.ano,     ROUND(         CASE              WHEN v.vendasAnterior IS NOT NULL AND v.vendasAnterior <> 0              THEN ((v.vendasAtual - v.vendasAnterior) / v.vendasAnterior) * 100             ELSE 0          END, 2     ) AS variacaoPercentual FROM VendasAnoAnterior v JOIN CategoriaProduto c ON v.idCategoria = c.idCategoria WHERE v.vendasAnterior IS NOT NULL ORDER BY c.nomeCategoria, v.ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdPedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), Variacao AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         MAX(CASE WHEN ano = 2021 THEN qtdPedidos ELSE 0 END) AS pedidos_2021,         MAX(CASE WHEN ano = 2020 THEN qtdPedidos ELSE 0 END) AS pedidos_2020     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     ROUND(         ((pedidos_2021 - pedidos_2020) * 100.0 / NULLIF(pedidos_2020, 0)),         2     ) AS variacao_percentual FROM      Variacao WHERE      pedidos_2020 > 0 AND pedidos_2021 > 0 ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaPorCliente AS (     SELECT          pv.`idCliente`,         AVG(ip.`precoVendido` * ip.`qtdePedida`) AS MediaCliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(ip.`precoVendido` * ip.`qtdePedida`) AS MediaGeral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido` ) SELECT      mpc.`idCliente`,     mpc.MediaCliente,     mg.MediaGeral FROM      MediaPorCliente mpc CROSS JOIN      MediaGeral mg WHERE      mpc.MediaCliente > mg.MediaGeral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS `rank`     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.`rank` <= 10 ORDER BY      rv.ano, rv.`rank`;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.idCategoria,         YEAR(pv.dataPedido) AS ano,         SUM(ip.qtdePedida * ip.precoVendido) AS totalVendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     GROUP BY p.idCategoria, YEAR(pv.dataPedido) ), VendasAnoAnterior AS (     SELECT          va1.idCategoria,         va1.ano,         va1.totalVendas AS vendasAtual,         LAG(va1.totalVendas) OVER (PARTITION BY va1.idCategoria ORDER BY va1.ano) AS vendasAnterior     FROM VendasAno va1 ) SELECT      c.nomeCategoria,     v.ano,     ROUND(         CASE              WHEN v.vendasAnterior IS NOT NULL AND v.vendasAnterior <> 0              THEN ((v.vendasAtual - v.vendasAnterior) / v.vendasAnterior) * 100             ELSE 0          END, 2     ) AS variacaoPercentual FROM VendasAnoAnterior v JOIN CategoriaProduto c ON v.idCategoria = c.idCategoria WHERE v.vendasAnterior IS NOT NULL ORDER BY c.nomeCategoria, v.ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdPedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), Variacao AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         MAX(CASE WHEN ano = 2021 THEN qtdPedidos ELSE 0 END) AS pedidos_2021,         MAX(CASE WHEN ano = 2020 THEN qtdPedidos ELSE 0 END) AS pedidos_2020     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     ROUND(         ((pedidos_2021 - pedidos_2020) * 100.0 / NULLIF(pedidos_2020, 0)),         2     ) AS variacao_percentual FROM      Variacao WHERE      pedidos_2020 > 0 AND pedidos_2021 > 0 ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaPorCliente AS (     SELECT          pv.`idCliente`,         AVG(ip.`precoVendido` * ip.`qtdePedida`) AS MediaCliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(ip.`precoVendido` * ip.`qtdePedida`) AS MediaGeral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido` ) SELECT      mpc.`idCliente`,     mpc.MediaCliente,     mg.MediaGeral FROM      MediaPorCliente mpc CROSS JOIN      MediaGeral mg WHERE      mpc.MediaCliente > mg.MediaGeral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS `rank`     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.`rank` <= 10 ORDER BY      rv.ano, rv.`rank`;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.idCategoria,         YEAR(pv.dataPedido) AS ano,         SUM(ip.qtdePedida * ip.precoVendido) AS totalVendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     GROUP BY p.idCategoria, YEAR(pv.dataPedido) ), VendasAnoAnterior AS (     SELECT          va1.idCategoria,         va1.ano,         va1.totalVendas AS vendasAtual,         LAG(va1.totalVendas) OVER (PARTITION BY va1.idCategoria ORDER BY va1.ano) AS vendasAnterior     FROM VendasAno va1 ) SELECT      c.nomeCategoria,     v.ano,     ROUND(         CASE              WHEN v.vendasAnterior IS NOT NULL AND v.vendasAnterior <> 0              THEN ((v.vendasAtual - v.vendasAnterior) / v.vendasAnterior) * 100             ELSE 0          END, 2     ) AS variacaoPercentual FROM VendasAnoAnterior v JOIN CategoriaProduto c ON v.idCategoria = c.idCategoria WHERE v.vendasAnterior IS NOT NULL ORDER BY c.nomeCategoria, v.ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdPedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), Variacao AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         MAX(CASE WHEN ano = 2021 THEN qtdPedidos ELSE 0 END) AS pedidos_2021,         MAX(CASE WHEN ano = 2020 THEN qtdPedidos ELSE 0 END) AS pedidos_2020     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     ROUND(         ((pedidos_2021 - pedidos_2020) * 100.0 / NULLIF(pedidos_2020, 0)),         2     ) AS variacao_percentual FROM      Variacao WHERE      pedidos_2020 > 0 AND pedidos_2021 > 0 ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaPorCliente AS (     SELECT          pv.`idCliente`,         AVG(ip.`precoVendido` * ip.`qtdePedida`) AS MediaCliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(ip.`precoVendido` * ip.`qtdePedida`) AS MediaGeral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido` ) SELECT      mpc.`idCliente`,     mpc.MediaCliente,     mg.MediaGeral FROM      MediaPorCliente mpc CROSS JOIN      MediaGeral mg WHERE      mpc.MediaCliente > mg.MediaGeral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS `rank`     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.`rank` <= 10 ORDER BY      rv.ano, rv.`rank`;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.idCategoria,         YEAR(pv.dataPedido) AS ano,         SUM(ip.qtdePedida * ip.precoVendido) AS totalVendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     GROUP BY p.idCategoria, YEAR(pv.dataPedido) ), VendasAnoAnterior AS (     SELECT          va1.idCategoria,         va1.ano,         va1.totalVendas AS vendasAtual,         LAG(va1.totalVendas) OVER (PARTITION BY va1.idCategoria ORDER BY va1.ano) AS vendasAnterior     FROM VendasAno va1 ) SELECT      c.nomeCategoria,     v.ano,     ROUND(         CASE              WHEN v.vendasAnterior IS NOT NULL AND v.vendasAnterior <> 0              THEN ((v.vendasAtual - v.vendasAnterior) / v.vendasAnterior) * 100             ELSE 0          END, 2     ) AS variacaoPercentual FROM VendasAnoAnterior v JOIN CategoriaProduto c ON v.idCategoria = c.idCategoria WHERE v.vendasAnterior IS NOT NULL ORDER BY c.nomeCategoria, v.ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdPedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), Variacao AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         MAX(CASE WHEN ano = 2021 THEN qtdPedidos ELSE 0 END) AS pedidos_2021,         MAX(CASE WHEN ano = 2020 THEN qtdPedidos ELSE 0 END) AS pedidos_2020     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     ROUND(         ((pedidos_2021 - pedidos_2020) * 100.0 / NULLIF(pedidos_2020, 0)),         2     ) AS variacao_percentual FROM      Variacao WHERE      pedidos_2020 > 0 AND pedidos_2021 > 0 ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaPorCliente AS (     SELECT          pv.`idCliente`,         AVG(ip.`precoVendido` * ip.`qtdePedida`) AS MediaCliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(ip.`precoVendido` * ip.`qtdePedida`) AS MediaGeral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido` ) SELECT      mpc.`idCliente`,     mpc.MediaCliente,     mg.MediaGeral FROM      MediaPorCliente mpc CROSS JOIN      MediaGeral mg WHERE      mpc.MediaCliente > mg.MediaGeral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS `rank`     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.`rank` <= 10 ORDER BY      rv.ano, rv.`rank`;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.idCategoria,         YEAR(pv.dataPedido) AS ano,         SUM(ip.qtdePedida * ip.precoVendido) AS totalVendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     GROUP BY p.idCategoria, YEAR(pv.dataPedido) ), VendasAnoAnterior AS (     SELECT          va1.idCategoria,         va1.ano,         va1.totalVendas AS vendasAtual,         LAG(va1.totalVendas) OVER (PARTITION BY va1.idCategoria ORDER BY va1.ano) AS vendasAnterior     FROM VendasAno va1 ) SELECT      c.nomeCategoria,     v.ano,     ROUND(         CASE              WHEN v.vendasAnterior IS NOT NULL AND v.vendasAnterior <> 0              THEN ((v.vendasAtual - v.vendasAnterior) / v.vendasAnterior) * 100             ELSE 0          END, 2     ) AS variacaoPercentual FROM VendasAnoAnterior v JOIN CategoriaProduto c ON v.idCategoria = c.idCategoria WHERE v.vendasAnterior IS NOT NULL ORDER BY c.nomeCategoria, v.ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdPedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), Variacao AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         MAX(CASE WHEN ano = 2021 THEN qtdPedidos ELSE 0 END) AS pedidos_2021,         MAX(CASE WHEN ano = 2020 THEN qtdPedidos ELSE 0 END) AS pedidos_2020     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     ROUND(         ((pedidos_2021 - pedidos_2020) * 100.0 / NULLIF(pedidos_2020, 0)),         2     ) AS variacao_percentual FROM      Variacao WHERE      pedidos_2020 > 0 AND pedidos_2021 > 0 ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaPorCliente AS (     SELECT          pv.`idCliente`,         AVG(ip.`precoVendido` * ip.`qtdePedida`) AS MediaCliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(ip.`precoVendido` * ip.`qtdePedida`) AS MediaGeral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido` ) SELECT      mpc.`idCliente`,     mpc.MediaCliente,     mg.MediaGeral FROM      MediaPorCliente mpc CROSS JOIN      MediaGeral mg WHERE      mpc.MediaCliente > mg.MediaGeral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS `rank`     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.`rank` <= 10 ORDER BY      rv.ano, rv.`rank`;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.idCategoria,         YEAR(pv.dataPedido) AS ano,         SUM(ip.qtdePedida * ip.precoVendido) AS totalVendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     GROUP BY p.idCategoria, YEAR(pv.dataPedido) ), VendasAnoAnterior AS (     SELECT          va1.idCategoria,         va1.ano,         va1.totalVendas AS vendasAtual,         LAG(va1.totalVendas) OVER (PARTITION BY va1.idCategoria ORDER BY va1.ano) AS vendasAnterior     FROM VendasAno va1 ) SELECT      c.nomeCategoria,     v.ano,     ROUND(         CASE              WHEN v.vendasAnterior IS NOT NULL AND v.vendasAnterior <> 0              THEN ((v.vendasAtual - v.vendasAnterior) / v.vendasAnterior) * 100             ELSE 0          END, 2     ) AS variacaoPercentual FROM VendasAnoAnterior v JOIN CategoriaProduto c ON v.idCategoria = c.idCategoria WHERE v.vendasAnterior IS NOT NULL ORDER BY c.nomeCategoria, v.ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdPedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), Variacao AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         MAX(CASE WHEN ano = 2021 THEN qtdPedidos ELSE 0 END) AS pedidos_2021,         MAX(CASE WHEN ano = 2020 THEN qtdPedidos ELSE 0 END) AS pedidos_2020     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     ROUND(         ((pedidos_2021 - pedidos_2020) * 100.0 / NULLIF(pedidos_2020, 0)),         2     ) AS variacao_percentual FROM      Variacao WHERE      pedidos_2020 > 0 AND pedidos_2021 > 0 ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaPorCliente AS (     SELECT          pv.`idCliente`,         AVG(ip.`precoVendido` * ip.`qtdePedida`) AS MediaCliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(ip.`precoVendido` * ip.`qtdePedida`) AS MediaGeral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido` ) SELECT      mpc.`idCliente`,     mpc.MediaCliente,     mg.MediaGeral FROM      MediaPorCliente mpc CROSS JOIN      MediaGeral mg WHERE      mpc.MediaCliente > mg.MediaGeral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS `rank`     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.`rank` <= 10 ORDER BY      rv.ano, rv.`rank`;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.idCategoria,         YEAR(pv.dataPedido) AS ano,         SUM(ip.qtdePedida * ip.precoVendido) AS totalVendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     GROUP BY p.idCategoria, YEAR(pv.dataPedido) ), VendasAnoAnterior AS (     SELECT          va1.idCategoria,         va1.ano,         va1.totalVendas AS vendasAtual,         LAG(va1.totalVendas) OVER (PARTITION BY va1.idCategoria ORDER BY va1.ano) AS vendasAnterior     FROM VendasAno va1 ) SELECT      c.nomeCategoria,     v.ano,     ROUND(         CASE              WHEN v.vendasAnterior IS NOT NULL AND v.vendasAnterior <> 0              THEN ((v.vendasAtual - v.vendasAnterior) / v.vendasAnterior) * 100             ELSE 0          END, 2     ) AS variacaoPercentual FROM VendasAnoAnterior v JOIN CategoriaProduto c ON v.idCategoria = c.idCategoria WHERE v.vendasAnterior IS NOT NULL ORDER BY c.nomeCategoria, v.ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdPedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), Variacao AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         MAX(CASE WHEN ano = 2021 THEN qtdPedidos ELSE 0 END) AS pedidos_2021,         MAX(CASE WHEN ano = 2020 THEN qtdPedidos ELSE 0 END) AS pedidos_2020     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     ROUND(         ((pedidos_2021 - pedidos_2020) * 100.0 / NULLIF(pedidos_2020, 0)),         2     ) AS variacao_percentual FROM      Variacao WHERE      pedidos_2020 > 0 AND pedidos_2021 > 0 ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaPorCliente AS (     SELECT          pv.`idCliente`,         AVG(ip.`precoVendido` * ip.`qtdePedida`) AS MediaCliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(ip.`precoVendido` * ip.`qtdePedida`) AS MediaGeral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido` ) SELECT      mpc.`idCliente`,     mpc.MediaCliente,     mg.MediaGeral FROM      MediaPorCliente mpc CROSS JOIN      MediaGeral mg WHERE      mpc.MediaCliente > mg.MediaGeral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS `rank`     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.`rank` <= 10 ORDER BY      rv.ano, rv.`rank`;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.idCategoria,         YEAR(pv.dataPedido) AS ano,         SUM(ip.qtdePedida * ip.precoVendido) AS totalVendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     GROUP BY p.idCategoria, YEAR(pv.dataPedido) ), VendasAnoAnterior AS (     SELECT          va1.idCategoria,         va1.ano,         va1.totalVendas AS vendasAtual,         LAG(va1.totalVendas) OVER (PARTITION BY va1.idCategoria ORDER BY va1.ano) AS vendasAnterior     FROM VendasAno va1 ) SELECT      c.nomeCategoria,     v.ano,     ROUND(         CASE              WHEN v.vendasAnterior IS NOT NULL AND v.vendasAnterior <> 0              THEN ((v.vendasAtual - v.vendasAnterior) / v.vendasAnterior) * 100             ELSE 0          END, 2     ) AS variacaoPercentual FROM VendasAnoAnterior v JOIN CategoriaProduto c ON v.idCategoria = c.idCategoria WHERE v.vendasAnterior IS NOT NULL ORDER BY c.nomeCategoria, v.ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdPedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), Variacao AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         MAX(CASE WHEN ano = 2021 THEN qtdPedidos ELSE 0 END) AS pedidos_2021,         MAX(CASE WHEN ano = 2020 THEN qtdPedidos ELSE 0 END) AS pedidos_2020     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     ROUND(         ((pedidos_2021 - pedidos_2020) * 100.0 / NULLIF(pedidos_2020, 0)),         2     ) AS variacao_percentual FROM      Variacao WHERE      pedidos_2020 > 0 AND pedidos_2021 > 0 ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaPorCliente AS (     SELECT          pv.`idCliente`,         AVG(ip.`precoVendido` * ip.`qtdePedida`) AS MediaCliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(ip.`precoVendido` * ip.`qtdePedida`) AS MediaGeral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido` ) SELECT      mpc.`idCliente`,     mpc.MediaCliente,     mg.MediaGeral FROM      MediaPorCliente mpc CROSS JOIN      MediaGeral mg WHERE      mpc.MediaCliente > mg.MediaGeral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS `rank`     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.`rank` <= 10 ORDER BY      rv.ano, rv.`rank`;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.idCategoria,         YEAR(pv.dataPedido) AS ano,         SUM(ip.qtdePedida * ip.precoVendido) AS totalVendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     GROUP BY p.idCategoria, YEAR(pv.dataPedido) ), VendasAnoAnterior AS (     SELECT          va1.idCategoria,         va1.ano,         va1.totalVendas AS vendasAtual,         LAG(va1.totalVendas) OVER (PARTITION BY va1.idCategoria ORDER BY va1.ano) AS vendasAnterior     FROM VendasAno va1 ) SELECT      c.nomeCategoria,     v.ano,     ROUND(         CASE              WHEN v.vendasAnterior IS NOT NULL AND v.vendasAnterior <> 0              THEN ((v.vendasAtual - v.vendasAnterior) / v.vendasAnterior) * 100             ELSE 0          END, 2     ) AS variacaoPercentual FROM VendasAnoAnterior v JOIN CategoriaProduto c ON v.idCategoria = c.idCategoria WHERE v.vendasAnterior IS NOT NULL ORDER BY c.nomeCategoria, v.ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdPedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), Variacao AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         MAX(CASE WHEN ano = 2021 THEN qtdPedidos ELSE 0 END) AS pedidos_2021,         MAX(CASE WHEN ano = 2020 THEN qtdPedidos ELSE 0 END) AS pedidos_2020     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     ROUND(         ((pedidos_2021 - pedidos_2020) * 100.0 / NULLIF(pedidos_2020, 0)),         2     ) AS variacao_percentual FROM      Variacao WHERE      pedidos_2020 > 0 AND pedidos_2021 > 0 ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaPorCliente AS (     SELECT          pv.`idCliente`,         AVG(ip.`precoVendido` * ip.`qtdePedida`) AS MediaCliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(ip.`precoVendido` * ip.`qtdePedida`) AS MediaGeral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido` ) SELECT      mpc.`idCliente`,     mpc.MediaCliente,     mg.MediaGeral FROM      MediaPorCliente mpc CROSS JOIN      MediaGeral mg WHERE      mpc.MediaCliente > mg.MediaGeral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS `rank`     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.`rank` <= 10 ORDER BY      rv.ano, rv.`rank`;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.idCategoria,         YEAR(pv.dataPedido) AS ano,         SUM(ip.qtdePedida * ip.precoVendido) AS totalVendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     GROUP BY p.idCategoria, YEAR(pv.dataPedido) ), VendasAnoAnterior AS (     SELECT          va1.idCategoria,         va1.ano,         va1.totalVendas AS vendasAtual,         LAG(va1.totalVendas) OVER (PARTITION BY va1.idCategoria ORDER BY va1.ano) AS vendasAnterior     FROM VendasAno va1 ) SELECT      c.nomeCategoria,     v.ano,     ROUND(         CASE              WHEN v.vendasAnterior IS NOT NULL AND v.vendasAnterior <> 0              THEN ((v.vendasAtual - v.vendasAnterior) / v.vendasAnterior) * 100             ELSE 0          END, 2     ) AS variacaoPercentual FROM VendasAnoAnterior v JOIN CategoriaProduto c ON v.idCategoria = c.idCategoria WHERE v.vendasAnterior IS NOT NULL ORDER BY c.nomeCategoria, v.ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdPedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), Variacao AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         MAX(CASE WHEN ano = 2021 THEN qtdPedidos ELSE 0 END) AS pedidos_2021,         MAX(CASE WHEN ano = 2020 THEN qtdPedidos ELSE 0 END) AS pedidos_2020     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     ROUND(         ((pedidos_2021 - pedidos_2020) * 100.0 / NULLIF(pedidos_2020, 0)),         2     ) AS variacao_percentual FROM      Variacao WHERE      pedidos_2020 > 0 AND pedidos_2021 > 0 ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaPorCliente AS (     SELECT          pv.`idCliente`,         AVG(ip.`precoVendido` * ip.`qtdePedida`) AS MediaCliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(ip.`precoVendido` * ip.`qtdePedida`) AS MediaGeral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido` ) SELECT      mpc.`idCliente`,     mpc.MediaCliente,     mg.MediaGeral FROM      MediaPorCliente mpc CROSS JOIN      MediaGeral mg WHERE      mpc.MediaCliente > mg.MediaGeral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS `rank`     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.`rank` <= 10 ORDER BY      rv.ano, rv.`rank`;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.idCategoria,         YEAR(pv.dataPedido) AS ano,         SUM(ip.qtdePedida * ip.precoVendido) AS totalVendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     GROUP BY p.idCategoria, YEAR(pv.dataPedido) ), VendasAnoAnterior AS (     SELECT          va1.idCategoria,         va1.ano,         va1.totalVendas AS vendasAtual,         LAG(va1.totalVendas) OVER (PARTITION BY va1.idCategoria ORDER BY va1.ano) AS vendasAnterior     FROM VendasAno va1 ) SELECT      c.nomeCategoria,     v.ano,     ROUND(         CASE              WHEN v.vendasAnterior IS NOT NULL AND v.vendasAnterior <> 0              THEN ((v.vendasAtual - v.vendasAnterior) / v.vendasAnterior) * 100             ELSE 0          END, 2     ) AS variacaoPercentual FROM VendasAnoAnterior v JOIN CategoriaProduto c ON v.idCategoria = c.idCategoria WHERE v.vendasAnterior IS NOT NULL ORDER BY c.nomeCategoria, v.ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdPedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), Variacao AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         MAX(CASE WHEN ano = 2021 THEN qtdPedidos ELSE 0 END) AS pedidos_2021,         MAX(CASE WHEN ano = 2020 THEN qtdPedidos ELSE 0 END) AS pedidos_2020     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     ROUND(         ((pedidos_2021 - pedidos_2020) * 100.0 / NULLIF(pedidos_2020, 0)),         2     ) AS variacao_percentual FROM      Variacao WHERE      pedidos_2020 > 0 AND pedidos_2021 > 0 ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaPorCliente AS (     SELECT          pv.`idCliente`,         AVG(ip.`precoVendido` * ip.`qtdePedida`) AS MediaCliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(ip.`precoVendido` * ip.`qtdePedida`) AS MediaGeral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido` ) SELECT      mpc.`idCliente`,     mpc.MediaCliente,     mg.MediaGeral FROM      MediaPorCliente mpc CROSS JOIN      MediaGeral mg WHERE      mpc.MediaCliente > mg.MediaGeral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS `rank`     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.`rank` <= 10 ORDER BY      rv.ano, rv.`rank`;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.idCategoria,         YEAR(pv.dataPedido) AS ano,         SUM(ip.qtdePedida * ip.precoVendido) AS totalVendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     GROUP BY p.idCategoria, YEAR(pv.dataPedido) ), VendasAnoAnterior AS (     SELECT          va1.idCategoria,         va1.ano,         va1.totalVendas AS vendasAtual,         LAG(va1.totalVendas) OVER (PARTITION BY va1.idCategoria ORDER BY va1.ano) AS vendasAnterior     FROM VendasAno va1 ) SELECT      c.nomeCategoria,     v.ano,     ROUND(         CASE              WHEN v.vendasAnterior IS NOT NULL AND v.vendasAnterior <> 0              THEN ((v.vendasAtual - v.vendasAnterior) / v.vendasAnterior) * 100             ELSE 0          END, 2     ) AS variacaoPercentual FROM VendasAnoAnterior v JOIN CategoriaProduto c ON v.idCategoria = c.idCategoria WHERE v.vendasAnterior IS NOT NULL ORDER BY c.nomeCategoria, v.ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdPedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), Variacao AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         MAX(CASE WHEN ano = 2021 THEN qtdPedidos ELSE 0 END) AS pedidos_2021,         MAX(CASE WHEN ano = 2020 THEN qtdPedidos ELSE 0 END) AS pedidos_2020     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     ROUND(         ((pedidos_2021 - pedidos_2020) * 100.0 / NULLIF(pedidos_2020, 0)),         2     ) AS variacao_percentual FROM      Variacao WHERE      pedidos_2020 > 0 AND pedidos_2021 > 0 ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaPorCliente AS (     SELECT          pv.`idCliente`,         AVG(ip.`precoVendido` * ip.`qtdePedida`) AS MediaCliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(ip.`precoVendido` * ip.`qtdePedida`) AS MediaGeral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido` ) SELECT      mpc.`idCliente`,     mpc.MediaCliente,     mg.MediaGeral FROM      MediaPorCliente mpc CROSS JOIN      MediaGeral mg WHERE      mpc.MediaCliente > mg.MediaGeral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS nome_dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`),     DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidadeVendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS quantidade_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     cp.nomeCategoria AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN ItensPedidoVenda ipv ON pv.idPedido = ipv.idPedido JOIN Produto p ON ipv.idProduto = p.idProduto JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), cp.nomeCategoria ORDER BY ano, mes, grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     fp.nomeFormaPgto,     COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN FormaPagamento fp ON pv.idFormaPgto = fp.idFormaPgto GROUP BY YEAR(pv.dataPedido), MONTH(pv.dataPedido), fp.nomeFormaPgto ORDER BY ano, mes, fp.nomeFormaPgto;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS `rank`     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.`rank` <= 10 ORDER BY      rv.ano, rv.`rank`;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAno AS (     SELECT          p.idCategoria,         YEAR(pv.dataPedido) AS ano,         SUM(ip.qtdePedida * ip.precoVendido) AS totalVendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     GROUP BY p.idCategoria, YEAR(pv.dataPedido) ), VendasAnoAnterior AS (     SELECT          va1.idCategoria,         va1.ano,         va1.totalVendas AS vendasAtual,         LAG(va1.totalVendas) OVER (PARTITION BY va1.idCategoria ORDER BY va1.ano) AS vendasAnterior     FROM VendasAno va1 ) SELECT      c.nomeCategoria,     v.ano,     ROUND(         CASE              WHEN v.vendasAnterior IS NOT NULL AND v.vendasAnterior <> 0              THEN ((v.vendasAtual - v.vendasAnterior) / v.vendasAnterior) * 100             ELSE 0          END, 2     ) AS variacaoPercentual FROM VendasAnoAnterior v JOIN CategoriaProduto c ON v.idCategoria = c.idCategoria WHERE v.vendasAnterior IS NOT NULL ORDER BY c.nomeCategoria, v.ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdPedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), Variacao AS (     SELECT          `idMarketPlace`,         `nomeMarketPlace`,         MAX(CASE WHEN ano = 2021 THEN qtdPedidos ELSE 0 END) AS pedidos_2021,         MAX(CASE WHEN ano = 2020 THEN qtdPedidos ELSE 0 END) AS pedidos_2020     FROM          CrescimentoMarketPlace     GROUP BY          `idMarketPlace`, `nomeMarketPlace` ) SELECT      `nomeMarketPlace`,     ROUND(         ((pedidos_2021 - pedidos_2020) * 100.0 / NULLIF(pedidos_2020, 0)),         2     ) AS variacao_percentual FROM      Variacao WHERE      pedidos_2020 > 0 AND pedidos_2021 > 0 ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "WITH MediaPorCliente AS (     SELECT          pv.`idCliente`,         AVG(ip.`precoVendido` * ip.`qtdePedida`) AS MediaCliente     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido`     GROUP BY          pv.`idCliente` ), MediaGeral AS (     SELECT          AVG(ip.`precoVendido` * ip.`qtdePedida`) AS MediaGeral     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ip ON pv.`idPedido` = ip.`idPedido` ) SELECT      mpc.`idCliente`,     mpc.MediaCliente,     mg.MediaGeral FROM      MediaPorCliente mpc CROSS JOIN      MediaGeral mg WHERE      mpc.MediaCliente > mg.MediaGeral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`) ORDER BY      FIELD(dia_semana, 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday');"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComVariacao AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     valor_vendas,     CASE          WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_anterior) / vendas_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComVariacao WHERE vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdPedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdPedidos AS pedidos_2020,         c2.qtdPedidos AS pedidos_2021,         ROUND(             ((c2.qtdPedidos - c1.qtdPedidos) * 100.0 / c1.qtdPedidos),              2         ) AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida) FROM ItensPedidoVenda ip2) AS media_geral FROM      Cliente c JOIN      PedidoVenda pv ON c.idCliente = pv.idCliente JOIN      ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY      c.idCliente, c.nomeCliente HAVING      media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`) ORDER BY      FIELD(dia_semana, 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday');"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComVariacao AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     valor_vendas,     CASE          WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_anterior) / vendas_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComVariacao WHERE vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdPedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdPedidos AS pedidos_2020,         c2.qtdPedidos AS pedidos_2021,         ROUND(             ((c2.qtdPedidos - c1.qtdPedidos) * 100.0 / c1.qtdPedidos),              2         ) AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida) FROM ItensPedidoVenda ip2) AS media_geral FROM      Cliente c JOIN      PedidoVenda pv ON c.idCliente = pv.idCliente JOIN      ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY      c.idCliente, c.nomeCliente HAVING      media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`) ORDER BY      FIELD(dia_semana, 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday');"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComVariacao AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     valor_vendas,     CASE          WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_anterior) / vendas_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComVariacao WHERE vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdPedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdPedidos AS pedidos_2020,         c2.qtdPedidos AS pedidos_2021,         ROUND(             ((c2.qtdPedidos - c1.qtdPedidos) * 100.0 / c1.qtdPedidos),              2         ) AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida) FROM ItensPedidoVenda ip2) AS media_geral FROM      Cliente c JOIN      PedidoVenda pv ON c.idCliente = pv.idCliente JOIN      ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY      c.idCliente, c.nomeCliente HAVING      media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`) ORDER BY      FIELD(dia_semana, 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday');"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComVariacao AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     valor_vendas,     CASE          WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_anterior) / vendas_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComVariacao WHERE vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdPedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdPedidos AS pedidos_2020,         c2.qtdPedidos AS pedidos_2021,         ROUND(             ((c2.qtdPedidos - c1.qtdPedidos) * 100.0 / c1.qtdPedidos),              2         ) AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida) FROM ItensPedidoVenda ip2) AS media_geral FROM      Cliente c JOIN      PedidoVenda pv ON c.idCliente = pv.idCliente JOIN      ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY      c.idCliente, c.nomeCliente HAVING      media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`) ORDER BY      FIELD(dia_semana, 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday');"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComVariacao AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     valor_vendas,     CASE          WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_anterior) / vendas_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComVariacao WHERE vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdPedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdPedidos AS pedidos_2020,         c2.qtdPedidos AS pedidos_2021,         ROUND(             ((c2.qtdPedidos - c1.qtdPedidos) * 100.0 / c1.qtdPedidos),              2         ) AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida) FROM ItensPedidoVenda ip2) AS media_geral FROM      Cliente c JOIN      PedidoVenda pv ON c.idCliente = pv.idCliente JOIN      ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY      c.idCliente, c.nomeCliente HAVING      media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`) ORDER BY      FIELD(dia_semana, 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday');"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComVariacao AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     valor_vendas,     CASE          WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_anterior) / vendas_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComVariacao WHERE vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdPedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdPedidos AS pedidos_2020,         c2.qtdPedidos AS pedidos_2021,         ROUND(             ((c2.qtdPedidos - c1.qtdPedidos) * 100.0 / c1.qtdPedidos),              2         ) AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida) FROM ItensPedidoVenda ip2) AS media_geral FROM      Cliente c JOIN      PedidoVenda pv ON c.idCliente = pv.idCliente JOIN      ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY      c.idCliente, c.nomeCliente HAVING      media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`) ORDER BY      FIELD(dia_semana, 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday');"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComVariacao AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     valor_vendas,     CASE          WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_anterior) / vendas_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComVariacao WHERE vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdPedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdPedidos AS pedidos_2020,         c2.qtdPedidos AS pedidos_2021,         ROUND(             ((c2.qtdPedidos - c1.qtdPedidos) * 100.0 / c1.qtdPedidos),              2         ) AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida) FROM ItensPedidoVenda ip2) AS media_geral FROM      Cliente c JOIN      PedidoVenda pv ON c.idCliente = pv.idCliente JOIN      ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY      c.idCliente, c.nomeCliente HAVING      media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`) ORDER BY      FIELD(dia_semana, 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday');"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComVariacao AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     valor_vendas,     CASE          WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_anterior) / vendas_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComVariacao WHERE vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdPedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdPedidos AS pedidos_2020,         c2.qtdPedidos AS pedidos_2021,         ROUND(             ((c2.qtdPedidos - c1.qtdPedidos) * 100.0 / c1.qtdPedidos),              2         ) AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida) FROM ItensPedidoVenda ip2) AS media_geral FROM      Cliente c JOIN      PedidoVenda pv ON c.idCliente = pv.idCliente JOIN      ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY      c.idCliente, c.nomeCliente HAVING      media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`) ORDER BY      FIELD(dia_semana, 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday');"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComVariacao AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     valor_vendas,     CASE          WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_anterior) / vendas_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComVariacao WHERE vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdPedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdPedidos AS pedidos_2020,         c2.qtdPedidos AS pedidos_2021,         ROUND(             ((c2.qtdPedidos - c1.qtdPedidos) * 100.0 / c1.qtdPedidos),              2         ) AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida) FROM ItensPedidoVenda ip2) AS media_geral FROM      Cliente c JOIN      PedidoVenda pv ON c.idCliente = pv.idCliente JOIN      ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY      c.idCliente, c.nomeCliente HAVING      media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`) ORDER BY      FIELD(dia_semana, 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday');"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComVariacao AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     valor_vendas,     CASE          WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_anterior) / vendas_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComVariacao WHERE vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdPedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdPedidos AS pedidos_2020,         c2.qtdPedidos AS pedidos_2021,         ROUND(             ((c2.qtdPedidos - c1.qtdPedidos) * 100.0 / c1.qtdPedidos),              2         ) AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida) FROM ItensPedidoVenda ip2) AS media_geral FROM      Cliente c JOIN      PedidoVenda pv ON c.idCliente = pv.idCliente JOIN      ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY      c.idCliente, c.nomeCliente HAVING      media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`) ORDER BY      FIELD(dia_semana, 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday');"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComVariacao AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     valor_vendas,     CASE          WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_anterior) / vendas_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComVariacao WHERE vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdPedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdPedidos AS pedidos_2020,         c2.qtdPedidos AS pedidos_2021,         ROUND(             ((c2.qtdPedidos - c1.qtdPedidos) * 100.0 / c1.qtdPedidos),              2         ) AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida) FROM ItensPedidoVenda ip2) AS media_geral FROM      Cliente c JOIN      PedidoVenda pv ON c.idCliente = pv.idCliente JOIN      ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY      c.idCliente, c.nomeCliente HAVING      media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`) ORDER BY      FIELD(dia_semana, 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday');"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComVariacao AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     valor_vendas,     CASE          WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_anterior) / vendas_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComVariacao WHERE vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdPedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdPedidos AS pedidos_2020,         c2.qtdPedidos AS pedidos_2021,         ROUND(             ((c2.qtdPedidos - c1.qtdPedidos) * 100.0 / c1.qtdPedidos),              2         ) AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida) FROM ItensPedidoVenda ip2) AS media_geral FROM      Cliente c JOIN      PedidoVenda pv ON c.idCliente = pv.idCliente JOIN      ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY      c.idCliente, c.nomeCliente HAVING      media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`) ORDER BY      FIELD(dia_semana, 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday');"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComVariacao AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     valor_vendas,     CASE          WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_anterior) / vendas_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComVariacao WHERE vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdPedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdPedidos AS pedidos_2020,         c2.qtdPedidos AS pedidos_2021,         ROUND(             ((c2.qtdPedidos - c1.qtdPedidos) * 100.0 / c1.qtdPedidos),              2         ) AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida) FROM ItensPedidoVenda ip2) AS media_geral FROM      Cliente c JOIN      PedidoVenda pv ON c.idCliente = pv.idCliente JOIN      ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY      c.idCliente, c.nomeCliente HAVING      media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`) ORDER BY      FIELD(dia_semana, 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday');"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComVariacao AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     valor_vendas,     CASE          WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_anterior) / vendas_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComVariacao WHERE vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdPedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdPedidos AS pedidos_2020,         c2.qtdPedidos AS pedidos_2021,         ROUND(             ((c2.qtdPedidos - c1.qtdPedidos) * 100.0 / c1.qtdPedidos),              2         ) AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida) FROM ItensPedidoVenda ip2) AS media_geral FROM      Cliente c JOIN      PedidoVenda pv ON c.idCliente = pv.idCliente JOIN      ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY      c.idCliente, c.nomeCliente HAVING      media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`) ORDER BY      FIELD(dia_semana, 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday');"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComVariacao AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     valor_vendas,     CASE          WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_anterior) / vendas_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComVariacao WHERE vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdPedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdPedidos AS pedidos_2020,         c2.qtdPedidos AS pedidos_2021,         ROUND(             ((c2.qtdPedidos - c1.qtdPedidos) * 100.0 / c1.qtdPedidos),              2         ) AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida) FROM ItensPedidoVenda ip2) AS media_geral FROM      Cliente c JOIN      PedidoVenda pv ON c.idCliente = pv.idCliente JOIN      ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY      c.idCliente, c.nomeCliente HAVING      media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`) ORDER BY      FIELD(dia_semana, 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday');"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComVariacao AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     valor_vendas,     CASE          WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_anterior) / vendas_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComVariacao WHERE vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdPedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdPedidos AS pedidos_2020,         c2.qtdPedidos AS pedidos_2021,         ROUND(             ((c2.qtdPedidos - c1.qtdPedidos) * 100.0 / c1.qtdPedidos),              2         ) AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida) FROM ItensPedidoVenda ip2) AS media_geral FROM      Cliente c JOIN      PedidoVenda pv ON c.idCliente = pv.idCliente JOIN      ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY      c.idCliente, c.nomeCliente HAVING      media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`) ORDER BY      FIELD(dia_semana, 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday');"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComVariacao AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     valor_vendas,     CASE          WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_anterior) / vendas_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComVariacao WHERE vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdPedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdPedidos AS pedidos_2020,         c2.qtdPedidos AS pedidos_2021,         ROUND(             ((c2.qtdPedidos - c1.qtdPedidos) * 100.0 / c1.qtdPedidos),              2         ) AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida) FROM ItensPedidoVenda ip2) AS media_geral FROM      Cliente c JOIN      PedidoVenda pv ON c.idCliente = pv.idCliente JOIN      ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY      c.idCliente, c.nomeCliente HAVING      media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`) ORDER BY      FIELD(dia_semana, 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday');"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComVariacao AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     valor_vendas,     CASE          WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_anterior) / vendas_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComVariacao WHERE vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdPedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdPedidos AS pedidos_2020,         c2.qtdPedidos AS pedidos_2021,         ROUND(             ((c2.qtdPedidos - c1.qtdPedidos) * 100.0 / c1.qtdPedidos),              2         ) AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida) FROM ItensPedidoVenda ip2) AS media_geral FROM      Cliente c JOIN      PedidoVenda pv ON c.idCliente = pv.idCliente JOIN      ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY      c.idCliente, c.nomeCliente HAVING      media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS dia_semana,     COUNT(*) AS quantidade_vendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`) ORDER BY      FIELD(dia_semana, 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday');"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(*) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano,     mes,     forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS numeroVendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano,     mes,     fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rank_venda     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rank_venda <= 10 ORDER BY      rv.ano, rv.rank_venda;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.`dataPedido`) AS ano,         cp.`nomeCategoria` AS grupo_produto,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valor_vendas     FROM `PedidoVenda` pv     JOIN `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     JOIN `Produto` p ON ipv.`idProduto` = p.`idProduto`     JOIN `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria`     GROUP BY YEAR(pv.`dataPedido`), cp.`nomeCategoria` ), VendasComVariacao AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     valor_vendas,     CASE          WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_anterior) / vendas_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasComVariacao WHERE vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS qtdPedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.qtdPedidos AS pedidos_2020,         c2.qtdPedidos AS pedidos_2021,         ROUND(             ((c2.qtdPedidos - c1.qtdPedidos) * 100.0 / c1.qtdPedidos),              2         ) AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' );"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida) FROM ItensPedidoVenda ip2) AS media_geral FROM      Cliente c JOIN      PedidoVenda pv ON c.idCliente = pv.idCliente JOIN      ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY      c.idCliente, c.nomeCliente HAVING      media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`), DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano, mes, fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rn     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rn <= 10 ORDER BY      rv.ano, rv.valorTotalVendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.dataPedido) AS ano,         cp.nomeCategoria AS grupo_produto,         SUM(ip.qtdePedida * ip.precoVendido) AS valor_vendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria     GROUP BY YEAR(pv.dataPedido), cp.nomeCategoria ), VendasCompletas AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     valor_vendas,     CASE          WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_anterior) / vendas_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasCompletas WHERE vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS quantidade_pedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.quantidade_pedidos AS pedidos_2020,         c2.quantidade_pedidos AS pedidos_2021,         ROUND(             ((c2.quantidade_pedidos - c1.quantidade_pedidos) * 100.0) / c1.quantidade_pedidos,              2         ) AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`), DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano, mes, fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rn     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rn <= 10 ORDER BY      rv.ano, rv.valorTotalVendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.dataPedido) AS ano,         cp.nomeCategoria AS grupo_produto,         SUM(ip.qtdePedida * ip.precoVendido) AS valor_vendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria     GROUP BY YEAR(pv.dataPedido), cp.nomeCategoria ), VendasCompletas AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     valor_vendas,     CASE          WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_anterior) / vendas_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasCompletas WHERE vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS quantidade_pedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.quantidade_pedidos AS pedidos_2020,         c2.quantidade_pedidos AS pedidos_2021,         ROUND(             ((c2.quantidade_pedidos - c1.quantidade_pedidos) * 100.0) / c1.quantidade_pedidos,              2         ) AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`), DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano, mes, fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rn     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rn <= 10 ORDER BY      rv.ano, rv.valorTotalVendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.dataPedido) AS ano,         cp.nomeCategoria AS grupo_produto,         SUM(ip.qtdePedida * ip.precoVendido) AS valor_vendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria     GROUP BY YEAR(pv.dataPedido), cp.nomeCategoria ), VendasCompletas AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     valor_vendas,     CASE          WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_anterior) / vendas_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasCompletas WHERE vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS quantidade_pedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.quantidade_pedidos AS pedidos_2020,         c2.quantidade_pedidos AS pedidos_2021,         ROUND(             ((c2.quantidade_pedidos - c1.quantidade_pedidos) * 100.0) / c1.quantidade_pedidos,              2         ) AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`), DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano, mes, fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rn     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rn <= 10 ORDER BY      rv.ano, rv.valorTotalVendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.dataPedido) AS ano,         cp.nomeCategoria AS grupo_produto,         SUM(ip.qtdePedida * ip.precoVendido) AS valor_vendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria     GROUP BY YEAR(pv.dataPedido), cp.nomeCategoria ), VendasCompletas AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     valor_vendas,     CASE          WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_anterior) / vendas_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasCompletas WHERE vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS quantidade_pedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.quantidade_pedidos AS pedidos_2020,         c2.quantidade_pedidos AS pedidos_2021,         ROUND(             ((c2.quantidade_pedidos - c1.quantidade_pedidos) * 100.0) / c1.quantidade_pedidos,              2         ) AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`), DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano, mes, fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rn     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rn <= 10 ORDER BY      rv.ano, rv.valorTotalVendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.dataPedido) AS ano,         cp.nomeCategoria AS grupo_produto,         SUM(ip.qtdePedida * ip.precoVendido) AS valor_vendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria     GROUP BY YEAR(pv.dataPedido), cp.nomeCategoria ), VendasCompletas AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     valor_vendas,     CASE          WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_anterior) / vendas_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasCompletas WHERE vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS quantidade_pedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.quantidade_pedidos AS pedidos_2020,         c2.quantidade_pedidos AS pedidos_2021,         ROUND(             ((c2.quantidade_pedidos - c1.quantidade_pedidos) * 100.0) / c1.quantidade_pedidos,              2         ) AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`), DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano, mes, fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rn     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rn <= 10 ORDER BY      rv.ano, rv.valorTotalVendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.dataPedido) AS ano,         cp.nomeCategoria AS grupo_produto,         SUM(ip.qtdePedida * ip.precoVendido) AS valor_vendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria     GROUP BY YEAR(pv.dataPedido), cp.nomeCategoria ), VendasCompletas AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     valor_vendas,     CASE          WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_anterior) / vendas_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasCompletas WHERE vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS quantidade_pedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.quantidade_pedidos AS pedidos_2020,         c2.quantidade_pedidos AS pedidos_2021,         ROUND(             ((c2.quantidade_pedidos - c1.quantidade_pedidos) * 100.0) / c1.quantidade_pedidos,              2         ) AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`), DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano, mes, fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rn     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rn <= 10 ORDER BY      rv.ano, rv.valorTotalVendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.dataPedido) AS ano,         cp.nomeCategoria AS grupo_produto,         SUM(ip.qtdePedida * ip.precoVendido) AS valor_vendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria     GROUP BY YEAR(pv.dataPedido), cp.nomeCategoria ), VendasCompletas AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     valor_vendas,     CASE          WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_anterior) / vendas_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasCompletas WHERE vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS quantidade_pedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.quantidade_pedidos AS pedidos_2020,         c2.quantidade_pedidos AS pedidos_2021,         ROUND(             ((c2.quantidade_pedidos - c1.quantidade_pedidos) * 100.0) / c1.quantidade_pedidos,              2         ) AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`), DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano, mes, fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rn     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rn <= 10 ORDER BY      rv.ano, rv.valorTotalVendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.dataPedido) AS ano,         cp.nomeCategoria AS grupo_produto,         SUM(ip.qtdePedida * ip.precoVendido) AS valor_vendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria     GROUP BY YEAR(pv.dataPedido), cp.nomeCategoria ), VendasCompletas AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     valor_vendas,     CASE          WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_anterior) / vendas_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasCompletas WHERE vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS quantidade_pedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.quantidade_pedidos AS pedidos_2020,         c2.quantidade_pedidos AS pedidos_2021,         ROUND(             ((c2.quantidade_pedidos - c1.quantidade_pedidos) * 100.0) / c1.quantidade_pedidos,              2         ) AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`), DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano, mes, fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rn     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rn <= 10 ORDER BY      rv.ano, rv.valorTotalVendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.dataPedido) AS ano,         cp.nomeCategoria AS grupo_produto,         SUM(ip.qtdePedida * ip.precoVendido) AS valor_vendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria     GROUP BY YEAR(pv.dataPedido), cp.nomeCategoria ), VendasCompletas AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     valor_vendas,     CASE          WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_anterior) / vendas_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasCompletas WHERE vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS quantidade_pedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.quantidade_pedidos AS pedidos_2020,         c2.quantidade_pedidos AS pedidos_2021,         ROUND(             ((c2.quantidade_pedidos - c1.quantidade_pedidos) * 100.0) / c1.quantidade_pedidos,              2         ) AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`), DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano, mes, fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rn     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rn <= 10 ORDER BY      rv.ano, rv.valorTotalVendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.dataPedido) AS ano,         cp.nomeCategoria AS grupo_produto,         SUM(ip.qtdePedida * ip.precoVendido) AS valor_vendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria     GROUP BY YEAR(pv.dataPedido), cp.nomeCategoria ), VendasCompletas AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     valor_vendas,     CASE          WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_anterior) / vendas_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasCompletas WHERE vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS quantidade_pedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.quantidade_pedidos AS pedidos_2020,         c2.quantidade_pedidos AS pedidos_2021,         ROUND(             ((c2.quantidade_pedidos - c1.quantidade_pedidos) * 100.0) / c1.quantidade_pedidos,              2         ) AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`), DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano, mes, fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rn     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rn <= 10 ORDER BY      rv.ano, rv.valorTotalVendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.dataPedido) AS ano,         cp.nomeCategoria AS grupo_produto,         SUM(ip.qtdePedida * ip.precoVendido) AS valor_vendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria     GROUP BY YEAR(pv.dataPedido), cp.nomeCategoria ), VendasCompletas AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     valor_vendas,     CASE          WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_anterior) / vendas_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasCompletas WHERE vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS quantidade_pedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.quantidade_pedidos AS pedidos_2020,         c2.quantidade_pedidos AS pedidos_2021,         ROUND(             ((c2.quantidade_pedidos - c1.quantidade_pedidos) * 100.0) / c1.quantidade_pedidos,              2         ) AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`), DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano, mes, fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rn     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rn <= 10 ORDER BY      rv.ano, rv.valorTotalVendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.dataPedido) AS ano,         cp.nomeCategoria AS grupo_produto,         SUM(ip.qtdePedida * ip.precoVendido) AS valor_vendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria     GROUP BY YEAR(pv.dataPedido), cp.nomeCategoria ), VendasCompletas AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     valor_vendas,     CASE          WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_anterior) / vendas_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasCompletas WHERE vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS quantidade_pedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.quantidade_pedidos AS pedidos_2020,         c2.quantidade_pedidos AS pedidos_2021,         ROUND(             ((c2.quantidade_pedidos - c1.quantidade_pedidos) * 100.0) / c1.quantidade_pedidos,              2         ) AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`), DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano, mes, fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rn     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rn <= 10 ORDER BY      rv.ano, rv.valorTotalVendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.dataPedido) AS ano,         cp.nomeCategoria AS grupo_produto,         SUM(ip.qtdePedida * ip.precoVendido) AS valor_vendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria     GROUP BY YEAR(pv.dataPedido), cp.nomeCategoria ), VendasCompletas AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     valor_vendas,     CASE          WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_anterior) / vendas_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasCompletas WHERE vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS quantidade_pedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.quantidade_pedidos AS pedidos_2020,         c2.quantidade_pedidos AS pedidos_2021,         ROUND(             ((c2.quantidade_pedidos - c1.quantidade_pedidos) * 100.0) / c1.quantidade_pedidos,              2         ) AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`), DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano, mes, fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rn     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rn <= 10 ORDER BY      rv.ano, rv.valorTotalVendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.dataPedido) AS ano,         cp.nomeCategoria AS grupo_produto,         SUM(ip.qtdePedida * ip.precoVendido) AS valor_vendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria     GROUP BY YEAR(pv.dataPedido), cp.nomeCategoria ), VendasCompletas AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     valor_vendas,     CASE          WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_anterior) / vendas_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasCompletas WHERE vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS quantidade_pedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.quantidade_pedidos AS pedidos_2020,         c2.quantidade_pedidos AS pedidos_2021,         ROUND(             ((c2.quantidade_pedidos - c1.quantidade_pedidos) * 100.0) / c1.quantidade_pedidos,              2         ) AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`), DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano, mes, fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rn     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rn <= 10 ORDER BY      rv.ano, rv.valorTotalVendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.dataPedido) AS ano,         cp.nomeCategoria AS grupo_produto,         SUM(ip.qtdePedida * ip.precoVendido) AS valor_vendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria     GROUP BY YEAR(pv.dataPedido), cp.nomeCategoria ), VendasCompletas AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     valor_vendas,     CASE          WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_anterior) / vendas_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasCompletas WHERE vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS quantidade_pedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.quantidade_pedidos AS pedidos_2020,         c2.quantidade_pedidos AS pedidos_2021,         ROUND(             ((c2.quantidade_pedidos - c1.quantidade_pedidos) * 100.0) / c1.quantidade_pedidos,              2         ) AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`), DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano, mes, fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rn     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rn <= 10 ORDER BY      rv.ano, rv.valorTotalVendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.dataPedido) AS ano,         cp.nomeCategoria AS grupo_produto,         SUM(ip.qtdePedida * ip.precoVendido) AS valor_vendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria     GROUP BY YEAR(pv.dataPedido), cp.nomeCategoria ), VendasCompletas AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     valor_vendas,     CASE          WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_anterior) / vendas_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasCompletas WHERE vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS quantidade_pedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.quantidade_pedidos AS pedidos_2020,         c2.quantidade_pedidos AS pedidos_2021,         ROUND(             ((c2.quantidade_pedidos - c1.quantidade_pedidos) * 100.0) / c1.quantidade_pedidos,              2         ) AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`), DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano, mes, fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rn     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rn <= 10 ORDER BY      rv.ano, rv.valorTotalVendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.dataPedido) AS ano,         cp.nomeCategoria AS grupo_produto,         SUM(ip.qtdePedida * ip.precoVendido) AS valor_vendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria     GROUP BY YEAR(pv.dataPedido), cp.nomeCategoria ), VendasCompletas AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     valor_vendas,     CASE          WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_anterior) / vendas_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasCompletas WHERE vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS quantidade_pedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.quantidade_pedidos AS pedidos_2020,         c2.quantidade_pedidos AS pedidos_2021,         ROUND(             ((c2.quantidade_pedidos - c1.quantidade_pedidos) * 100.0) / c1.quantidade_pedidos,              2         ) AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`), DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano, mes, fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rn     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rn <= 10 ORDER BY      rv.ano, rv.valorTotalVendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.dataPedido) AS ano,         cp.nomeCategoria AS grupo_produto,         SUM(ip.qtdePedida * ip.precoVendido) AS valor_vendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria     GROUP BY YEAR(pv.dataPedido), cp.nomeCategoria ), VendasCompletas AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     valor_vendas,     CASE          WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_anterior) / vendas_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasCompletas WHERE vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS quantidade_pedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.quantidade_pedidos AS pedidos_2020,         c2.quantidade_pedidos AS pedidos_2021,         ROUND(             ((c2.quantidade_pedidos - c1.quantidade_pedidos) * 100.0) / c1.quantidade_pedidos,              2         ) AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_cliente > media_geral;"
        }
    ],
    [
        {
            "question": "Quantas vendas foram registradas em cada dia da semana? Deve conter os nomes dos dias, não apenas números.",
            "answer": "SELECT      DAYNAME(pv.`dataPedido`) AS diaSemana,     COUNT(*) AS quantidadeVendas FROM      PedidoVenda pv GROUP BY      DAYNAME(pv.`dataPedido`), DAYOFWEEK(pv.`dataPedido`) ORDER BY      DAYOFWEEK(pv.`dataPedido`);"
        },
        {
            "question": "Quantas vendas foram feitas em cada hora do dia?",
            "answer": "SELECT      HOUR(`dataPedido`) AS hora_do_dia,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` GROUP BY      HOUR(`dataPedido`) ORDER BY      hora_do_dia;"
        },
        {
            "question": "Qual foi o faturamento total de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento_total FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` GROUP BY      YEAR(pv.`dataPedido`) ORDER BY      ano;"
        },
        {
            "question": "Quantas vendas foram feitas por canal de venda?",
            "answer": "SELECT cv.nomeCanalVenda, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN CanalVenda cv ON pv.idCanalVenda = cv.idCanalVenda GROUP BY cv.nomeCanalVenda;"
        },
        {
            "question": "Quantas vendas foram feitas por marketplace?",
            "answer": "SELECT COUNT(*) AS total_vendas FROM PedidoVenda WHERE idMarketPlace IS NOT NULL;"
        },
        {
            "question": "Quantas vendas foram feitas por vendedor? Agrupe através de seu nome",
            "answer": "SELECT      V.nomeVendedor,      COUNT(PV.idPedido) AS quantidadeVendas FROM      PedidoVenda PV JOIN      Vendedor V ON PV.idVendedor = V.idVendedor GROUP BY      V.nomeVendedor;"
        },
        {
            "question": "Quantas vendas foram realizadas em cada estado?",
            "answer": "SELECT c.estado, COUNT(pv.idPedido) AS quantidade_vendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente GROUP BY c.estado;"
        },
        {
            "question": "Qual foi o faturamento mensal 2023?",
            "answer": "SELECT      DATE_FORMAT(pv.`dataPedido`, '%Y-%m') AS mes_ano,     SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS faturamento FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` WHERE      YEAR(pv.`dataPedido`) = 2023 GROUP BY      mes_ano ORDER BY      mes_ano;"
        },
        {
            "question": "Quantas vendas foram realizadas por grupo de produtos a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     cp.`nomeCategoria` AS grupo_produto,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido` JOIN      `Produto` p ON ipv.`idProduto` = p.`idProduto` JOIN      `CategoriaProduto` cp ON p.`idCategoria` = cp.`idCategoria` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     cp.`nomeCategoria` ORDER BY      ano,     mes,     grupo_produto;"
        },
        {
            "question": "Quantos produtos foram vendidos por produto individual (Top 10)?",
            "answer": "SELECT      p.idProduto,     p.descricao,     SUM(ip.qtdePedida) AS total_vendido FROM      Produto p JOIN      ItensPedidoVenda ip ON p.idProduto = ip.idProduto GROUP BY      p.idProduto, p.descricao ORDER BY      total_vendido DESC LIMIT 10;"
        },
        {
            "question": "Quantas vendas foram realizadas por forma de recebimento a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`nomeFormaPgto` AS forma_pagamento,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`nomeFormaPgto` ORDER BY      ano, mes, forma_pagamento;"
        },
        {
            "question": "Quantas vendas foram realizadas múmero de parcelas a cada mês de cada ano?",
            "answer": "SELECT      YEAR(pv.`dataPedido`) AS ano,     MONTH(pv.`dataPedido`) AS mes,     fp.`numParcelas`,     COUNT(*) AS quantidade_vendas FROM      `PedidoVenda` pv JOIN      `FormaPagamento` fp ON pv.`idFormaPgto` = fp.`idFormaPgto` GROUP BY      YEAR(pv.`dataPedido`),     MONTH(pv.`dataPedido`),     fp.`numParcelas` ORDER BY      ano, mes, fp.`numParcelas`;"
        },
        {
            "question": "Quantas vendas foram realizadas por segmento de clientes mensalmente em 2023?",
            "answer": "SELECT      sc.nomeSegmento,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS quantidadeVendas FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2023 GROUP BY sc.nomeSegmento, MONTH(pv.dataPedido) ORDER BY mes;"
        },
        {
            "question": "Quais foram os 10 clientes com maior valor total de vendas em cada ano?",
            "answer": "WITH VendasAnuais AS (     SELECT          pv.`idCliente`,         YEAR(pv.`dataPedido`) AS ano,         SUM(ipv.`precoVendido` * ipv.`qtdePedida`) AS valorTotalVendas     FROM          `PedidoVenda` pv     JOIN          `ItensPedidoVenda` ipv ON pv.`idPedido` = ipv.`idPedido`     GROUP BY          pv.`idCliente`, ano ), RankVendas AS (     SELECT          idCliente,         ano,         valorTotalVendas,         ROW_NUMBER() OVER (PARTITION BY ano ORDER BY valorTotalVendas DESC) AS rn     FROM          VendasAnuais ) SELECT      c.`nomeCliente`,     rv.ano,     rv.valorTotalVendas FROM      RankVendas rv JOIN      `Cliente` c ON rv.`idCliente` = c.`idCliente` WHERE      rv.rn <= 10 ORDER BY      rv.ano, rv.valorTotalVendas DESC;"
        },
        {
            "question": "Qual a variação percentual das vendas de cada grupo de produtos entre anos consecutivos?",
            "answer": "WITH VendasAnuais AS (     SELECT          YEAR(pv.dataPedido) AS ano,         cp.nomeCategoria AS grupo_produto,         SUM(ip.qtdePedida * ip.precoVendido) AS valor_vendas     FROM PedidoVenda pv     JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido     JOIN Produto p ON ip.idProduto = p.idProduto     JOIN CategoriaProduto cp ON p.idCategoria = cp.idCategoria     GROUP BY YEAR(pv.dataPedido), cp.nomeCategoria ), VendasCompletas AS (     SELECT          ano,         grupo_produto,         valor_vendas,         LAG(valor_vendas) OVER (PARTITION BY grupo_produto ORDER BY ano) AS vendas_anterior     FROM VendasAnuais ) SELECT      grupo_produto,     ano,     valor_vendas,     CASE          WHEN vendas_anterior IS NOT NULL AND vendas_anterior <> 0 THEN             ROUND(((valor_vendas - vendas_anterior) / vendas_anterior) * 100, 2)         ELSE NULL     END AS variacao_percentual FROM VendasCompletas WHERE vendas_anterior IS NOT NULL ORDER BY grupo_produto, ano;"
        },
        {
            "question": "Qual foi a participação percentual de cada segmento de clientes nas vendas totais de cada mês de 2017?",
            "answer": "SELECT      sc.nomeSegmento,     YEAR(pv.dataPedido) AS ano,     MONTH(pv.dataPedido) AS mes,     COUNT(*) AS qtdeVendas,     (COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY YEAR(pv.dataPedido), MONTH(pv.dataPedido))) AS participacaoPercentual FROM PedidoVenda pv JOIN Cliente c ON pv.idCliente = c.idCliente JOIN SegmentoCliente sc ON c.idSegmentoCliente = sc.idSegmentoCliente WHERE YEAR(pv.dataPedido) = 2017 GROUP BY sc.nomeSegmento, YEAR(pv.dataPedido), MONTH(pv.dataPedido) ORDER BY ano, mes, participacaoPercentual DESC;"
        },
        {
            "question": "Qual o marketplace que mais cresceu em 2021 em relação ao ano anterior? Retorne também a variação percentual",
            "answer": "WITH CrescimentoMarketPlace AS (     SELECT          mp.`idMarketPlace`,         mp.`nomeMarketPlace`,         YEAR(pv.`dataPedido`) AS ano,         COUNT(pv.`idPedido`) AS quantidade_pedidos     FROM          `PedidoVenda` pv     JOIN          `MarketPlace` mp ON pv.`idMarketPlace` = mp.`idMarketPlace`     WHERE          YEAR(pv.`dataPedido`) IN (2020, 2021)     GROUP BY          mp.`idMarketPlace`, mp.`nomeMarketPlace`, ano ), VariacaoPercentual AS (     SELECT          c1.`idMarketPlace`,         c1.`nomeMarketPlace`,         c1.quantidade_pedidos AS pedidos_2020,         c2.quantidade_pedidos AS pedidos_2021,         ROUND(             ((c2.quantidade_pedidos - c1.quantidade_pedidos) * 100.0) / c1.quantidade_pedidos,              2         ) AS variacao_percentual     FROM          CrescimentoMarketPlace c1     JOIN          CrescimentoMarketPlace c2          ON c1.`idMarketPlace` = c2.`idMarketPlace`     WHERE          c1.ano = 2020 AND c2.ano = 2021 ) SELECT      `nomeMarketPlace`,     variacao_percentual FROM      VariacaoPercentual ORDER BY      variacao_percentual DESC LIMIT 1;"
        },
        {
            "question": "Quais os nomes dos vendedores que nunca venderam em RJ?",
            "answer": "SELECT DISTINCT v.nomeVendedor FROM Vendedor v WHERE v.idVendedor NOT IN (     SELECT DISTINCT pv.idVendedor     FROM PedidoVenda pv     JOIN Cliente c ON pv.idCliente = c.idCliente     WHERE c.estado = 'RJ' )"
        },
        {
            "question": "Qual o valor médio por pedido de cada cliente comparado ao valor médio por pedido geral? Selecione apenas aqueles que possuem média superior",
            "answer": "SELECT      c.idCliente,     c.nomeCliente,     AVG(ip.precoVendido * ip.qtdePedida) AS media_cliente,     (SELECT AVG(ip2.precoVendido * ip2.qtdePedida)      FROM ItensPedidoVenda ip2) AS media_geral FROM Cliente c JOIN PedidoVenda pv ON c.idCliente = pv.idCliente JOIN ItensPedidoVenda ip ON pv.idPedido = ip.idPedido GROUP BY c.idCliente, c.nomeCliente HAVING media_cliente > media_geral;"
        }
    ]
]